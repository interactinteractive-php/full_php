/*! jquery-tabletree 0.3.0 */
!function(a){var b={initTree:function(b){var c=a.extend({},this.tabletree.defaults,b);return this.each(function(){var b=a(this);b.tabletree("setTreeContainer",a(this)),b.tabletree("setSettings",c),c.getRootNodes.apply(this,[a(this)]).tabletree("initNode",c),b.tabletree("getRootNodes").tabletree("render")})},initNode:function(b){return this.each(function(){var c=a(this);c.tabletree("setTreeContainer",b.gettabletreeContainer.apply(this)),c.tabletree("getChildNodes").tabletree("initNode",b),c.tabletree("initExpander").tabletree("initIndent").tabletree("initEvents").tabletree("initState").tabletree("initChangeEvent").tabletree("initSettingsEvents")})},initChangeEvent:function(){var b=a(this);return b.on("change",function(){var b=a(this);b.tabletree("render"),b.tabletree("getSetting","saveState")&&b.tabletree("saveState")}),b},initEvents:function(){var b=a(this);return b.on("collapse",function(){var b=a(this);b.removeClass("tabletree-expanded"),b.addClass("tabletree-collapsed")}),b.on("expand",function(){var b=a(this);b.removeClass("tabletree-collapsed"),b.addClass("tabletree-expanded")}),b},initSettingsEvents:function(){var b=a(this);return b.on("change",function(){var b=a(this);"function"==typeof b.tabletree("getSetting","onChange")&&b.tabletree("getSetting","onChange").apply(b)}),b.on("collapse",function(){var b=a(this);"function"==typeof b.tabletree("getSetting","onCollapse")&&b.tabletree("getSetting","onCollapse").apply(b)}),b.on("expand",function(){var b=a(this);"function"==typeof b.tabletree("getSetting","onExpand")&&b.tabletree("getSetting","onExpand").apply(b)}),b},initExpander:function(){var b=a(this),c=b.find("td").get(b.tabletree("getSetting","treeColumn")),d=b.tabletree("getSetting","expanderTemplate"),e=b.tabletree("getSetting","getExpander").apply(this);return e&&e.remove(),a(d).prependTo(c).click(function(){a(a(this).closest("tr")).tabletree("toggle")}),b},initIndent:function(){var b=a(this);b.find(".tabletree-indent").remove();for(var c=b.tabletree("getSetting","indentTemplate"),d=b.find(".tabletree-expander"),e=b.tabletree("getDepth"),f=0;e>f;f++)a(c).insertBefore(d);return b},initState:function(){var b=a(this);return b.tabletree(b.tabletree("getSetting","saveState")&&!b.tabletree("isFirstInit")?"restoreState":"expanded"===b.tabletree("getSetting","initialState")?"expand":"collapse"),b},isFirstInit:function(){var b=a(this).tabletree("getTreeContainer");return void 0===b.data("first_init")&&b.data("first_init",void 0===a.cookie(b.tabletree("getSetting","saveStateName"))),b.data("first_init")},saveState:function(){var b=a(this);if("cookie"===b.tabletree("getSetting","saveStateMethod")){var c=a.cookie(b.tabletree("getSetting","saveStateName"))||"",d=""===c?[]:c.split(","),e=b.tabletree("getNodeId");b.tabletree("isExpanded")?-1===a.inArray(e,d)&&d.push(e):b.tabletree("isCollapsed")&&-1!==a.inArray(e,d)&&d.splice(a.inArray(e,d),1),a.cookie(b.tabletree("getSetting","saveStateName"),d.join(","))}return b},restoreState:function(){var b=a(this);if("cookie"===b.tabletree("getSetting","saveStateMethod")){var c=a.cookie(b.tabletree("getSetting","saveStateName")).split(",");b.tabletree(-1!==a.inArray(b.tabletree("getNodeId"),c)?"expand":"collapse")}return b},getSetting:function(b){return a(this).tabletree("getTreeContainer")?a(this).tabletree("getTreeContainer").data("settings")[b]:null},setSettings:function(b){a(this).tabletree("getTreeContainer").data("settings",b)},getTreeContainer:function(){return a(this).data("tabletree")},setTreeContainer:function(b){return a(this).data("tabletree",b)},getRootNodes:function(){return a(this).tabletree("getSetting","getRootNodes").apply(this,[a(this).tabletree("getTreeContainer")])},getAllNodes:function(){return a(this).tabletree("getSetting","getAllNodes").apply(this,[a(this).tabletree("getTreeContainer")])},isNode:function(){return null!==a(this).tabletree("getNodeId")},getNodeId:function(){return null===a(this).tabletree("getSetting","getNodeId")?null:a(this).tabletree("getSetting","getNodeId").apply(this)},getParentNodeId:function(){return a(this).tabletree("getSetting","getParentNodeId").apply(this)},getParentNode:function(){return null===a(this).tabletree("getParentNodeId")?null:a(this).tabletree("getSetting","getNodeById").apply(this,[a(this).tabletree("getParentNodeId"),a(this).tabletree("getTreeContainer")])},getChildNodes:function(){return a(this).tabletree("getSetting","getChildNodes").apply(this,[a(this).tabletree("getNodeId"),a(this).tabletree("getTreeContainer")])},getDepth:function(){return null===a(this).tabletree("getParentNode")?0:a(this).tabletree("getParentNode").tabletree("getDepth")+1},isRoot:function(){return 0===a(this).tabletree("getDepth")},isLeaf:function(){return 0===a(this).tabletree("getChildNodes").length},isLast:function(){if(a(this).tabletree("isNode")){var b=a(this).tabletree("getParentNode");if(null===b){if(a(this).tabletree("getNodeId")===a(this).tabletree("getRootNodes").last().tabletree("getNodeId"))return!0}else if(a(this).tabletree("getNodeId")===b.tabletree("getChildNodes").last().tabletree("getNodeId"))return!0}return!1},isFirst:function(){if(a(this).tabletree("isNode")){var b=a(this).tabletree("getParentNode");if(null===b){if(a(this).tabletree("getNodeId")===a(this).tabletree("getRootNodes").first().tabletree("getNodeId"))return!0}else if(a(this).tabletree("getNodeId")===b.tabletree("getChildNodes").first().tabletree("getNodeId"))return!0}return!1},isExpanded:function(){return a(this).hasClass("tabletree-expanded")},isCollapsed:function(){return a(this).hasClass("tabletree-collapsed")},isOneOfParentsCollapsed:function(){var b=a(this);return b.tabletree("isRoot")?!1:b.tabletree("getParentNode").tabletree("isCollapsed")?!0:b.tabletree("getParentNode").tabletree("isOneOfParentsCollapsed")},expand:function(){return this.tabletree("isLeaf")||this.tabletree("isExpanded")?this:(this.trigger("expand"),this.trigger("change"),this)},expandAll:function(){var b=a(this);return b.tabletree("getRootNodes").tabletree("expandRecursive"),b},expandRecursive:function(){return a(this).each(function(){var b=a(this);b.tabletree("expand"),b.tabletree("isLeaf")||b.tabletree("getChildNodes").tabletree("expandRecursive")})},collapse:function(){return a(this).each(function(){var b=a(this);b.tabletree("isLeaf")||b.tabletree("isCollapsed")||(b.trigger("collapse"),b.trigger("change"))})},collapseAll:function(){var b=a(this);return b.tabletree("getRootNodes").tabletree("collapseRecursive"),b},collapseRecursive:function(){return a(this).each(function(){var b=a(this);b.tabletree("collapse"),b.tabletree("isLeaf")||b.tabletree("getChildNodes").tabletree("collapseRecursive")})},toggle:function(){var b=a(this);return b.tabletree(b.tabletree("isExpanded")?"collapse":"expand"),b},render:function(){return a(this).each(function(){var b=a(this);b.tabletree("isOneOfParentsCollapsed")?b.hide():b.show(),b.tabletree("isLeaf")||(b.tabletree("renderExpander"),b.tabletree("getChildNodes").tabletree("render"))})},renderExpander:function(){return a(this).each(function(){var b=a(this),c=b.tabletree("getSetting","getExpander").apply(this);c?b.tabletree("isCollapsed")?(c.removeClass(b.tabletree("getSetting","expanderExpandedClass")),c.addClass(b.tabletree("getSetting","expanderCollapsedClass"))):(c.removeClass(b.tabletree("getSetting","expanderCollapsedClass")),c.addClass(b.tabletree("getSetting","expanderExpandedClass"))):(b.tabletree("initExpander"),b.tabletree("renderExpander"))})}};a.fn.tabletree=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method with name "+c+" does not exists for jQuery.tabletree"):b.initTree.apply(this,arguments)},a.fn.tabletree.defaults={initialState:"expanded",saveState:!1,saveStateMethod:"cookie",saveStateName:"tree-grid-state",expanderTemplate:'<span class="tabletree-expander"></span>',indentTemplate:'<span class="tabletree-indent"></span>',expanderExpandedClass:"tabletree-expander-expanded",expanderCollapsedClass:"tabletree-expander-collapsed",treeColumn:0,getExpander:function(){return a(this).find(".tabletree-expander")},getNodeId:function(){var b=/tabletree-([A-Za-z0-9_-]+)/;return b.test(a(this).attr("class"))?b.exec(a(this).attr("class"))[1]:null},getParentNodeId:function(){var b=/tabletree-parent-([A-Za-z0-9_-]+)/;return b.test(a(this).attr("class"))?b.exec(a(this).attr("class"))[1]:null},getNodeById:function(a,b){var c="tabletree-"+a;return b.find("tr."+c)},getChildNodes:function(a,b){var c="tabletree-parent-"+a;return b.find("tr."+c)},gettabletreeContainer:function(){return a(this).closest("table")},getRootNodes:function(b){var c=a.grep(b.find("tr"),function(b){var c=a(b).attr("class"),d=/tabletree-([A-Za-z0-9_-]+)/,e=/tabletree-parent-([A-Za-z0-9_-]+)/;return d.test(c)&&!e.test(c)});return a(c)},getAllNodes:function(b){var c=a.grep(b.find("tr"),function(b){var c=a(b).attr("class"),d=/tabletree-([A-Za-z0-9_-]+)/;return d.test(c)});return a(c)},onCollapse:null,onExpand:null,onChange:null}}(jQuery);

$.extend($.fn.tabletree.defaults, {expanderExpandedClass: 'glyphicon glyphicon-chevron-down', expanderCollapsedClass: 'glyphicon glyphicon-chevron-right'});
