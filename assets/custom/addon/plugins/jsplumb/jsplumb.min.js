/*jsBezier-0.6*/
!function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(n){return 0==n?0:n>0?1:-1});var n={subtract:function(n,r){return{x:n.x-r.x,y:n.y-r.y}},dotProduct:function(n,r){return n.x*r.x+n.y*r.y},square:function(n){return Math.sqrt(n.x*n.x+n.y*n.y)},scale:function(n,r){return{x:n.x*r,y:n.y*r}}},r=64,t=Math.pow(2,-r-1),o=function(r,t){for(var o=[],u=a(r,t),i=t.length-1,c=2*i-1,f=e(u,c,o,0),v=n.subtract(r,t[0]),x=n.square(v),s=0,y=0;f>y;y++){v=n.subtract(r,l(t,i,o[y],null,null));var h=n.square(v);x>h&&(x=h,s=o[y])}return v=n.subtract(r,t[i]),h=n.square(v),x>h&&(x=h,s=1),{location:s,distance:x}},u=function(n,r){var t=o(n,r);return{point:l(r,r.length-1,t.location,null,null),location:t.location}},a=function(r,t){for(var o=t.length-1,u=2*o-1,a=[],e=[],i=[],c=[],f=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],l=0;o>=l;l++)a[l]=n.subtract(t[l],r);for(var l=0;o-1>=l;l++)e[l]=n.subtract(t[l+1],t[l]),e[l]=n.scale(e[l],3);for(var v=0;o-1>=v;v++)for(var x=0;o>=x;x++)i[v]||(i[v]=[]),i[v][x]=n.dotProduct(e[v],a[x]);for(l=0;u>=l;l++)c[l]||(c[l]=[]),c[l].y=0,c[l].x=parseFloat(l)/u;for(var s=o,y=o-1,h=0;s+y>=h;h++){var p=Math.max(0,h-y),M=Math.min(h,s);for(l=p;M>=l;l++)j=h-l,c[l+j].y+=i[j][l]*f[j][l]}return c},e=function(n,t,o,u){var a,v,x=[],s=[],y=[],h=[];switch(i(n,t)){case 0:return 0;case 1:if(u>=r)return o[0]=(n[0].x+n[t].x)/2,1;if(c(n,t))return o[0]=f(n,t),1}l(n,t,.5,x,s),a=e(x,t,y,u+1),v=e(s,t,h,u+1);for(var p=0;a>p;p++)o[p]=y[p];for(var p=0;v>p;p++)o[p+a]=h[p];return a+v},i=function(n,r){var t,o,u=0;t=o=Math.sgn(n[0].y);for(var a=1;r>=a;a++)t=Math.sgn(n[a].y),t!=o&&u++,o=t;return u},c=function(n,r){var o,u,a,e,i,c,f,l,v,x,s,y,h,p,M,g;c=n[0].y-n[r].y,f=n[r].x-n[0].x,l=n[0].x*n[r].y-n[r].x*n[0].y;for(var w=max_distance_below=0,d=1;r>d;d++){var m=c*n[d].x+f*n[d].y+l;m>w?w=m:m<max_distance_below&&(max_distance_below=m)}return s=0,y=1,h=0,p=c,M=f,g=l-w,v=s*M-p*y,x=1/v,u=(y*g-M*h)*x,p=c,M=f,g=l-max_distance_below,v=s*M-p*y,x=1/v,a=(y*g-M*h)*x,e=Math.min(u,a),i=Math.max(u,a),o=i-e,t>o?1:0},f=function(n,r){var t=1,o=0,u=n[r].x-n[0].x,a=n[r].y-n[0].y,e=n[0].x-0,i=n[0].y-0,c=u*o-a*t,f=1/c,l=(u*i-a*e)*f;return 0+t*l},l=function(n,r,t,o,u){for(var a=[[]],e=0;r>=e;e++)a[0][e]=n[e];for(var i=1;r>=i;i++)for(var e=0;r-i>=e;e++)a[i]||(a[i]=[]),a[i][e]||(a[i][e]={}),a[i][e].x=(1-t)*a[i-1][e].x+t*a[i-1][e+1].x,a[i][e].y=(1-t)*a[i-1][e].y+t*a[i-1][e+1].y;if(null!=o)for(e=0;r>=e;e++)o[e]=a[e][0];if(null!=u)for(e=0;r>=e;e++)u[e]=a[r-e][e];return a[r][0]},v={},x=function(n){var r=v[n];if(!r){r=[];var t=function(){return function(r){return Math.pow(r,n)}},o=function(){return function(r){return Math.pow(1-r,n)}},u=function(n){return function(r){return n}},a=function(){return function(n){return n}},e=function(){return function(n){return 1-n}},i=function(n){return function(r){for(var t=1,o=0;o<n.length;o++)t*=n[o](r);return t}};r.push(new t);for(var c=1;n>c;c++){for(var f=[new u(n)],l=0;n-c>l;l++)f.push(new a);for(var l=0;c>l;l++)f.push(new e);r.push(new i(f))}r.push(new o),v[n]=r}return r},s=function(n,r){for(var t=x(n.length-1),o=0,u=0,a=0;a<n.length;a++)o+=n[a].x*t[a](r),u+=n[a].y*t[a](r);return{x:o,y:u}},y=function(n,r){return Math.sqrt(Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2))},h=function(n){return n[0].x==n[1].x&&n[0].y==n[1].y},p=function(n,r,t){if(h(n))return{point:n[0],location:r};for(var o=s(n,r),u=0,a=r,e=t>0?1:-1,i=null;u<Math.abs(t);)a+=.005*e,i=s(n,a),u+=y(i,o),o=i;return{point:i,location:a}},M=function(n){if(h(n))return 0;for(var r=s(n,0),t=0,o=0,u=1,a=null;1>o;)o+=.005*u,a=s(n,o),t+=y(a,r),r=a;return t},g=function(n,r,t){return p(n,r,t).point},w=function(n,r,t){return p(n,r,t).location},d=function(n,r){var t=s(n,r),o=s(n.slice(0,n.length-1),r),u=o.y-t.y,a=o.x-t.x;return 0==u?1/0:Math.atan(u/a)},m=function(n,r,t){var o=p(n,r,t);return o.location>1&&(o.location=1),o.location<0&&(o.location=0),d(n,o.location)},b=function(n,r,t,o){o=null==o?0:o;var u=p(n,r,o),a=d(n,u.location),e=Math.atan(-1/a),i=t/2*Math.sin(e),c=t/2*Math.cos(e);return[{x:u.point.x+c,y:u.point.y+i},{x:u.point.x-c,y:u.point.y-i}]};window.jsBezier={distanceFromCurve:o,gradientAtPoint:d,gradientAtPointAlongCurveFrom:m,nearestPointOnCurve:u,pointOnCurve:s,pointAlongCurveFrom:g,perpendicularToCurveAt:b,locationAlongCurveFrom:w,getLength:M}}();
/*jsPlumbGeom v0.1*/
(function(){"use strict";var t,n=this;t="undefined"!=typeof exports?exports:n.jsPlumbGeom={};var r=function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=function(t,n,a){return t=r(t)?t:[t.x,t.y],n=r(n)?n:[n.x,n.y],a(t,n)},u=t.gradient=function(t,n){return a(t,n,function(t,n){return n[0]==t[0]?n[1]>t[1]?1/0:-(1/0):n[1]==t[1]?n[0]>t[0]?0:-0:(n[1]-t[1])/(n[0]-t[0])})},e=(t.normal=function(t,n){return-1/u(t,n)},t.lineLength=function(t,n){return a(t,n,function(t,n){return Math.sqrt(Math.pow(n[1]-t[1],2)+Math.pow(n[0]-t[0],2))})},t.quadrant=function(t,n){return a(t,n,function(t,n){return n[0]>t[0]?n[1]>t[1]?2:1:n[0]==t[0]?n[1]>t[1]?2:1:n[1]>t[1]?3:4})}),o=(t.theta=function(t,n){return a(t,n,function(t,n){var r=u(t,n),a=Math.atan(r),o=e(t,n);return(4==o||3==o)&&(a+=Math.PI),0>a&&(a+=2*Math.PI),a})},t.intersects=function(t,n){var r=t.x,a=t.x+t.w,u=t.y,e=t.y+t.h,o=n.x,i=n.x+n.w,c=n.y,h=n.y+n.h;return o>=r&&a>=o&&c>=u&&e>=c||i>=r&&a>=i&&c>=u&&e>=c||o>=r&&a>=o&&h>=u&&e>=h||i>=r&&a>=o&&h>=u&&e>=h||r>=o&&i>=r&&u>=c&&h>=u||a>=o&&i>=a&&u>=c&&h>=u||r>=o&&i>=r&&e>=c&&h>=e||a>=o&&i>=r&&e>=c&&h>=e},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),i=[null,[-1,-1],[-1,1],[1,1],[1,-1]];t.pointOnLine=function(t,n,r){var a=u(t,n),c=e(t,n),h=r>0?o[c]:i[c],f=Math.atan(a),s=Math.abs(r*Math.sin(f))*h[1],y=Math.abs(r*Math.cos(f))*h[0];return{x:t.x+y,y:t.y+s}},t.perpendicularLineTo=function(t,n,r){var a=u(t,n),e=Math.atan(-1/a),o=r/2*Math.sin(e),i=r/2*Math.cos(e);return[{x:n.x+i,y:n.y+o},{x:n.x-i,y:n.y-o}]}}).call(this);
/*
 * jsPlumb
 * 
 * Title:jsPlumb 1.5.5
 * 
 * Provides a way to visually connect elements on an HTML page, using either SVG, Canvas
 * elements, or VML.  
 * 
 * This file contains the base functionality for DOM type adapters. 
 *
 * Copyright (c) 2010 - 2013 Simon Porritt (http://jsplumb.org)
 * 
 * http://jsplumb.org
 * http://github.com/sporritt/jsplumb
 * http://code.google.com/p/jsplumb
 * 
 * Dual licensed under the MIT and GPL2 licenses.
 */
!function(){var e=!!document.createElement("canvas").getContext,t=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),n=function(){if(void 0===n.vml){var e=document.body.appendChild(document.createElement("div"));e.innerHTML='<v:shape id="vml_flag1" adj="1" />';var t=e.firstChild;null!=t&&null!=t.style?(t.style.behavior="url(#default#VML)",n.vml=t?"object"==typeof t.adj:!0):n.vml=!1,e.parentNode.removeChild(e)}return n.vml},r=function(e){var t={},n=[],r={},i={},o={};this.register=function(l){var d=jsPlumb.CurrentLibrary,f=d.getElementObject(l),a=e.getId(l),s=d.getOffset(f);t[a]||(t[a]=l,n.push(l),r[a]={});var u=function(t,n){if(t)for(var l=0;l<t.childNodes.length;l++)if(3!=t.childNodes[l].nodeType&&8!=t.childNodes[l].nodeType){var f=d.getElementObject(t.childNodes[l]),c=e.getId(t.childNodes[l],null,!0);if(c&&i[c]&&i[c]>0){var v=d.getOffset(f);r[a][c]={id:c,offset:{left:v.left-s.left,top:v.top-s.top}},o[c]=a}u(t.childNodes[l])}};u(l)},this.updateOffsets=function(t){var n=jsPlumb.CurrentLibrary,i=n.getElementObject(t),l=n.getDOMElement(i),d=e.getId(l),f=r[d],a=n.getOffset(i);if(f)for(var s in f){var u=n.getElementObject(s),c=n.getOffset(u);r[d][s]={id:s,offset:{left:c.left-a.left,top:c.top-a.top}},o[s]=d}},this.endpointAdded=function(n){var l=jsPlumb.CurrentLibrary,d=document.body,f=e.getId(n),a=l.getElementObject(n),s=jsPlumb.CurrentLibrary.getOffset(a),u=n.parentNode;for(i[f]=i[f]?i[f]+1:1;null!=u&&u!=d;){var c=e.getId(u,null,!0);if(c&&t[c]){var v=l.getElementObject(u),g=l.getOffset(v);null==r[c][f]&&(r[c][f]={id:f,offset:{left:s.left-g.left,top:s.top-g.top}},o[f]=c);break}u=u.parentNode}},this.endpointDeleted=function(e){if(i[e.elementId]&&(i[e.elementId]--,i[e.elementId]<=0))for(var t in r)r[t]&&(delete r[t][e.elementId],delete o[e.elementId])},this.changeId=function(e,t){r[t]=r[e],r[e]={},o[t]=o[e],o[e]=null},this.getElementsForDraggable=function(e){return r[e]},this.elementRemoved=function(e){var t=o[e];t&&(delete r[t][e],delete o[e])},this.reset=function(){t={},n=[],r={},i={}},this.dragEnded=function(t){var n=e.getId(t),r=o[n];r&&this.updateOffsets(r)},this.setParent=function(e,t,n,i){var l=o[t];if(l){r[i]||(r[i]={}),r[i][t]=r[l][t],delete r[l][t];var d=jsPlumb.CurrentLibrary.getOffset(n),f=jsPlumb.CurrentLibrary.getOffset(e);r[i][t].offset={left:f.left-d.left,top:f.top-d.top},o[t]=i}}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}),window.jsPlumbAdapter={headless:!1,getAttribute:function(e,t){return e.getAttribute(t)},setAttribute:function(e,t,n){e.setAttribute(t,n)},appendToRoot:function(e){document.body.appendChild(e)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(r){return{canvas:e,svg:t,vml:n()}[r]},getDragManager:function(e){return new r(e)},setRenderMode:function(e){var t;if(e){e=e.toLowerCase();var n=this.isRenderModeAvailable("canvas"),r=this.isRenderModeAvailable("svg"),i=this.isRenderModeAvailable("vml");"svg"===e?r?t="svg":n?t="canvas":i&&(t="vml"):"canvas"===e&&n?t="canvas":i&&(t="vml")}return t}}}();
/*
 * jsPlumb
 * 
 * Title:jsPlumb 1.5.5
 * 
 * Provides a way to visually connect elements on an HTML page, using either SVG or VML.  
 * 
 * This file contains the util functions
 *
 * Copyright (c) 2010 - 2013 Simon Porritt (http://jsplumb.org)
 * 
 * http://jsplumb.org
 * http://github.com/sporritt/jsplumb
 * http://code.google.com/p/jsplumb
 * 
 * Dual licensed under the MIT and GPL2 licenses.
 */
!function(){var t=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=function(t){return"[object Number]"===Object.prototype.toString.call(t)},e=function(t){return"string"==typeof t},r=function(t){return"boolean"==typeof t},i=function(t){return null==t},o=function(t){return null==t?!1:"[object Object]"===Object.prototype.toString.call(t)},u=function(t){return"[object Date]"===Object.prototype.toString.call(t)},l=function(t){return"[object Function]"===Object.prototype.toString.call(t)},f=function(t){for(var n in t)if(t.hasOwnProperty(n))return!1;return!0};jsPlumbUtil={isArray:t,isString:e,isBoolean:r,isNull:i,isObject:o,isDate:u,isFunction:l,isEmpty:f,isNumber:n,clone:function(n){if(e(n))return""+n;if(r(n))return!!n;if(u(n))return new Date(n.getTime());if(l(n))return n;if(t(n)){for(var i=[],f=0;f<n.length;f++)i.push(this.clone(n[f]));return i}if(o(n)){var c={};for(var a in n)c[a]=this.clone(n[a]);return c}return n},merge:function(n,i){var u=this.clone(n);for(var l in i)if(null==u[l]||e(i[l])||r(i[l]))u[l]=i[l];else if(t(i[l])){var f=[];t(u[l])&&f.push.apply(f,u[l]),f.push.apply(f,i[l]),u[l]=f}else if(o(i[l])){o(u[l])||(u[l]={});for(var c in i[l])u[l][c]=i[l][c]}return u},copyValues:function(t,n,e){for(var r=0;r<t.length;r++)e[t[r]]=n[t[r]]},functionChain:function(t,n,e){for(var r=0;r<e.length;r++){var i=e[r][0][e[r][1]].apply(e[r][0],e[r][2]);if(i===n)return i}return t},populate:function(n,r){var i=function(t){var n=t.match(/(\${.*?})/g);if(null!=n)for(var e=0;e<n.length;e++){var i=r[n[e].substring(2,n[e].length-1)];null!=i&&(t=t.replace(n[e],i))}return t},u=function(n){if(null!=n){if(e(n))return i(n);if(t(n)){for(var r=[],l=0;l<n.length;l++)r.push(u(n[l]));return r}if(o(n)){var f={};for(var c in n)f[c]=u(n[c]);return f}return n}};return u(n)},convertStyle:function(t,n){if("transparent"===t)return t;var e=t,r=function(t){return 1==t.length?"0"+t:t},i=function(t){return r(Number(t).toString(16))},o=/(rgb[a]?\()(.*)(\))/;if(t.match(o)){var u=t.match(o)[2].split(",");e="#"+i(u[0])+i(u[1])+i(u[2]),n||4!=u.length||(e+=i(u[3]))}return e},findWithFunction:function(t,n){if(t)for(var e=0;e<t.length;e++)if(n(t[e]))return e;return-1},clampToGrid:function(t,n,e,r,i){var o=function(t,n){var e=t%n,r=Math.floor(t/n),i=e>=n/2?1:0;return(r+i)*n};return[r||null==e?t:o(t,e[0]),i||null==e?n:o(n,e[1])]},indexOf:function(t,n){return jsPlumbUtil.findWithFunction(t,function(t){return t==n})},removeWithFunction:function(t,n){var e=jsPlumbUtil.findWithFunction(t,n);return e>-1&&t.splice(e,1),-1!=e},remove:function(t,n){var e=jsPlumbUtil.indexOf(t,n);return e>-1&&t.splice(e,1),-1!=e},addWithFunction:function(t,n,e){-1==jsPlumbUtil.findWithFunction(t,e)&&t.push(n)},addToList:function(t,n,e,r){var i=t[n];return null==i&&(i=[],t[n]=i),i[r?"unshift":"push"](e),i},extend:function(n,e,r,i){r=r||{},i=i||{},e=t(e)?e:[e];for(var o=0;o<e.length;o++)for(var u in e[o].prototype)e[o].prototype.hasOwnProperty(u)&&(n.prototype[u]=e[o].prototype[u]);var l=function(t){return function(){for(var n=0;n<e.length;n++)e[n].prototype[t]&&e[n].prototype[t].apply(this,arguments);return r[t].apply(this,arguments)}};for(var f in r)n.prototype[f]=l(f);return n},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=16*Math.random()|0,e="x"==t?n:3&n|8;return e.toString(16)})},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&"undefined"!=typeof console)try{var t=arguments[arguments.length-1];console.log(t)}catch(n){}},group:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.group(t)},groupEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.groupEnd(t)},time:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.time(t)},timeEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.timeEnd(t)},removeElement:function(t){null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t)},removeElements:function(t){for(var n=0;n<t.length;n++)jsPlumbUtil.removeElement(t[n])},sizeElement:function(t,n,e,r,i){t&&(t.style.height=i+"px",t.height=i,t.style.width=r+"px",t.width=r,t.style.left=n+"px",t.style.top=e+"px")},wrap:function(t,n,e){return t=t||function(){},n=n||function(){},function(){var r=null;try{r=n.apply(this,arguments)}catch(i){jsPlumbUtil.log("jsPlumb function failed : "+i)}if(null==e||r!==e)try{r=t.apply(this,arguments)}catch(i){jsPlumbUtil.log("wrapped function failed : "+i)}return r}}},jsPlumbUtil.EventGenerator=function(){var t={},n=!1,e=["ready"];this.bind=function(n,e,r){return jsPlumbUtil.addToList(t,n,e,r),this},this.fire=function(r,i,o){if(!n&&t[r]){var u=t[r].length,l=0,f=!1,c=null;if(!this.shouldFireEvent||this.shouldFireEvent(r,i,o))for(;!f&&u>l&&c!==!1;){if(-1!=jsPlumbUtil.findWithFunction(e,function(t){return t===r}))t[r][l](i,o);else try{c=t[r][l](i,o)}catch(a){jsPlumbUtil.log("jsPlumb: fire failed for event "+r+" : "+a)}l++,(null==t||null==t[r])&&(f=!0)}}return this},this.unbind=function(n){return n?delete t[n]:t={},this},this.getListener=function(n){return t[n]},this.setSuspendEvents=function(t){n=t},this.isSuspendEvents=function(){return n},this.cleanupListeners=function(){for(var n in t)t[n].splice(0),delete t[n]}},jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}},Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var n=Array.prototype.slice.call(arguments,1),e=this,r=function(){},i=function(){return e.apply(this instanceof r&&t?this:t,n.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i})}();
/**
 * @module jsPlumb
 * @description Provides a way to visually connect elements on an HTML page, using either SVG, Canvas
 * elements, or VML.   
 * 
 * - [Demo Site](http://jsplumb.org)
 * - [GitHub](http://github.com/sporritt/jsplumb)
 * 
 * Dual licensed under the MIT and GPL2 licenses.
 *
 * Copyright (c) 2010 - 2013 Simon Porritt (simon.porritt@gmail.com)
 */
 !function(){var e=jsPlumbUtil,t=function(e,t){_.CurrentLibrary.addClass(r(e),t)},n=function(e,t){_.CurrentLibrary.removeClass(r(e),t)},r=function(e){return _.CurrentLibrary.getElementObject(e)},i=function(e){return _.CurrentLibrary.getDOMElement(e)},s=function(e,t){var n=_.CurrentLibrary.getOffset(r(e));if(null!=t){var i=t.getZoom();return{left:n.left/i,top:n.top/i}}return n},o=function(e){return _.CurrentLibrary.getSize(r(e))},a=function(){return""+(new Date).getTime()},l=function(e){if(e._jsPlumb.paintStyle&&e._jsPlumb.hoverPaintStyle){var t={};_.extend(t,e._jsPlumb.paintStyle),_.extend(t,e._jsPlumb.hoverPaintStyle),delete e._jsPlumb.hoverPaintStyle,t.gradient&&e._jsPlumb.paintStyle.fillStyle&&delete t.gradient,e._jsPlumb.hoverPaintStyle=t}},u=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],c={mouseout:"mouseexit"},d=function(e,t,n,r){var i=e.getAttachedElements();if(i)for(var s=0,o=i.length;o>s;s++)r&&r==i[s]||i[s].setHover(t,!0,n)},h=function(e){return null==e?null:e.split(" ")},f=function(t,n,r){if(t.getDefaultType){for(var i=t.getTypeDescriptor(),s=e.merge({},t.getDefaultType()),o=0,a=t._jsPlumb.types.length;a>o;o++)s=e.merge(s,t._jsPlumb.instance.getType(t._jsPlumb.types[o],i));n&&(s=e.populate(s,n)),t.applyType(s,r),r||t.repaint()}},p=window.jsPlumbUIComponent=function(t){jsPlumbUtil.EventGenerator.apply(this,arguments);var n=this,r=arguments,i=n.idPrefix,s=i+(new Date).getTime(),o=_.CurrentLibrary;if(this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass||_.Defaults.HoverClass,types:[]},this.getId=function(){return s},t.events)for(var a in t.events)n.bind(a,t.events[a]);this.clone=function(){var e={};return this.constructor.apply(e,r),e}.bind(this),this.isDetachAllowed=function(t){var n=!0;if(this._jsPlumb.beforeDetach)try{n=this._jsPlumb.beforeDetach(t)}catch(r){e.log("jsPlumb: beforeDetach callback failed",r)}return n},this.isDropAllowed=function(t,n,r,i,s){var o=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:n,scope:r,connection:i,dropEndpoint:s});if(this._jsPlumb.beforeDrop)try{o=this._jsPlumb.beforeDrop({sourceId:t,targetId:n,scope:r,connection:i,dropEndpoint:s})}catch(a){e.log("jsPlumb: beforeDrop callback failed",a)}return o};var l=[],d=function(e,t,n){l.push([e,t,n]),e.bind(t,n)},h=[],f=function(e,t,n){var r=c[n]||n,i=function(e){t.fire(r,t,e)};h.push([e,n,i]),o.bind(e,n,i)},p=function(e,t,n){c[t]||t;o.unbind(e,t,n)};this.bindListeners=function(e,t,n){d(e,"click",function(e,n){t.fire("click",t,n)}),d(e,"dblclick",function(e,n){t.fire("dblclick",t,n)}),d(e,"contextmenu",function(e,n){t.fire("contextmenu",t,n)}),d(e,"mouseenter",function(e,r){t.isHover()||(n(!0),t.fire("mouseenter",t,r))}),d(e,"mouseexit",function(e,r){t.isHover()&&(n(!1),t.fire("mouseexit",t,r))}),d(e,"mousedown",function(e,n){t.fire("mousedown",t,n)}),d(e,"mouseup",function(e,n){t.fire("mouseup",t,n)})},this.unbindListeners=function(){for(var e=0;e<l.length;e++){var t=l[e];t[0].unbind(t[1],t[2])}l=null},this.attachListeners=function(e,t){for(var n=0,r=u.length;r>n;n++)f(e,t,u[n])},this.detachListeners=function(){for(var e=0;e<h.length;e++)p(h[e][0],h[e][1],h[e][2]);h=null},this.reattachListenersForElement=function(e){if(arguments.length>1){for(var t=0,n=u.length;n>t;t++)p(e,u[t]);for(t=1,n=arguments.length;n>t;t++)this.attachListeners(e,arguments[t])}}};jsPlumbUtil.extend(p,jsPlumbUtil.EventGenerator,{getParameter:function(e){return this._jsPlumb.parameters[e]},setParameter:function(e,t){this._jsPlumb.parameters[e]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(e){this._jsPlumb.parameters=e},addClass:function(e){null!=this.canvas&&t(this.canvas,e)},removeClass:function(e){null!=this.canvas&&n(this.canvas,e)},setType:function(e,t,n){this._jsPlumb.types=h(e)||[],f(this,t,n)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(e,t){f(this,e,t)},hasType:function(e){return-1!=jsPlumbUtil.indexOf(this._jsPlumb.types,e)},addType:function(e,t,n){var r=h(e),i=!1;if(null!=r){for(var s=0,o=r.length;o>s;s++)this.hasType(r[s])||(this._jsPlumb.types.push(r[s]),i=!0);i&&f(this,t,n)}},removeType:function(t,n){var r=h(t),i=!1,s=function(t){var n=e.indexOf(this._jsPlumb.types,t);return-1!=n?(this._jsPlumb.types.splice(n,1),!0):!1}.bind(this);if(null!=r){for(var o=0,a=r.length;a>o;o++)i=s(r[o])||i;i&&f(this,null,n)}},toggleType:function(e,t,n){var r=h(e);if(null!=r){for(var i=0,s=r.length;s>i;i++){var o=jsPlumbUtil.indexOf(this._jsPlumb.types,r[i]);-1!=o?this._jsPlumb.types.splice(o,1):this._jsPlumb.types.push(r[i])}f(this,t,n)}},applyType:function(e,t){if(this.setPaintStyle(e.paintStyle,t),this.setHoverPaintStyle(e.hoverPaintStyle,t),e.parameters)for(var n in e.parameters)this.setParameter(n,e.parameters[n])},setPaintStyle:function(e,t){this._jsPlumb.paintStyle=e,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,l(this),t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(e,t){this._jsPlumb.hoverPaintStyle=e,l(this),t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},cleanup:function(){this.unbindListeners(),this.detachListeners()},destroy:function(){this.cleanupListeners(),this.clone=null,this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(e,t,n){var r=_.CurrentLibrary;!this._jsPlumb||this._jsPlumb.instance.currentlyDragging||this._jsPlumb.instance.isHoverSuspended()||(this._jsPlumb.hover=e,null!=this.canvas&&null!=this._jsPlumb.instance.hoverClass&&r[e?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.hoverClass),null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=e?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(n=n||a(),this.repaint({timestamp:n,recalc:!1}))),this.getAttachedElements&&!t&&d(this,e,a(),this))}});var g="__label",v=function(e,t){for(var n=-1,r=0,i=e._jsPlumb.overlays.length;i>r;r++)if(t===e._jsPlumb.overlays[r].id){n=r;break}return n},m=function(e,t){var n={cssClass:t.cssClass,labelStyle:e.labelStyle,id:g,component:e,_jsPlumb:e._jsPlumb.instance},r=_.extend(n,t);return new(_.Overlays[e._jsPlumb.instance.getRenderMode()].Label)(r)},b=function(t,n){var r=null;if(e.isArray(n)){var i=n[0],s=_.extend({component:t,_jsPlumb:t._jsPlumb.instance},n[1]);3==n.length&&_.extend(s,n[2]),r=new(_.Overlays[t._jsPlumb.instance.getRenderMode()][i])(s)}else r=n.constructor==String?new(_.Overlays[t._jsPlumb.instance.getRenderMode()][n])({component:t,_jsPlumb:t._jsPlumb.instance}):n;t._jsPlumb.overlays.push(r)},y=function(e,t){var n=e.defaultOverlayKeys||[],r=t.overlays,i=function(t){return e._jsPlumb.instance.Defaults[t]||_.Defaults[t]||[]};r||(r=[]);for(var s=0,o=n.length;o>s;s++)r.unshift.apply(r,i(n[s]));return r},P=window.OverlayCapableJsPlumbUIComponent=function(e){p.apply(this,arguments),this._jsPlumb.overlays=[];var t=y(this,e);if(t)for(var n=0,r=t.length;r>n;n++)b(this,t[n]);if(e.label){var i=e.labelLocation||this.defaultLabelLocation||.5,s=e.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle||_.Defaults.LabelStyle;this._jsPlumb.overlays.push(m(this,{label:e.label,location:i,labelStyle:s}))}};jsPlumbUtil.extend(P,p,{applyType:function(e,t){if(this.removeAllOverlays(t),e.overlays)for(var n=0,r=e.overlays.length;r>n;n++)this.addOverlay(e.overlays[n],!0)},setHover:function(e,t,n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var r=0,i=this._jsPlumb.overlays.length;i>r;r++)this._jsPlumb.overlays[r][e?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(e,t){b(this,e),t||this.repaint()},getOverlay:function(e){var t=v(this,e);return t>=0?this._jsPlumb.overlays[t]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(e){var t=this.getOverlay(e);t&&t.hide()},hideOverlays:function(){for(var e=0,t=this._jsPlumb.overlays.length;t>e;e++)this._jsPlumb.overlays[e].hide()},showOverlay:function(e){var t=this.getOverlay(e);t&&t.show()},showOverlays:function(){for(var e=0,t=this._jsPlumb.overlays.length;t>e;e++)this._jsPlumb.overlays[e].show()},removeAllOverlays:function(e){for(var t=0,n=this._jsPlumb.overlays.length;n>t;t++)this._jsPlumb.overlays[t].cleanup&&this._jsPlumb.overlays[t].cleanup();this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length),this._jsPlumb.overlayPositions=null,e||this.repaint()},removeOverlay:function(e){var t=v(this,e);if(-1!=t){var n=this._jsPlumb.overlays[t];n.cleanup&&n.cleanup(),this._jsPlumb.overlays.splice(t,1),this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[e]}},removeOverlays:function(){for(var e=0,t=arguments.length;t>e;e++)this.removeOverlay(arguments[e])},getLabel:function(){var e=this.getOverlay(g);return null!=e?e.getLabel():null},getLabelOverlay:function(){return this.getOverlay(g)},setLabel:function(e){var t=this.getOverlay(g);if(t)e.constructor==String||e.constructor==Function?t.setLabel(e):(e.label&&t.setLabel(e.label),e.location&&t.setLocation(e.location));else{var n=e.constructor==String||e.constructor==Function?{label:e}:e;t=m(this,n),this._jsPlumb.overlays.push(t)}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(){for(var e=0;e<this._jsPlumb.overlays.length;e++)this._jsPlumb.overlays[e].cleanup(),this._jsPlumb.overlays[e].destroy();this._jsPlumb.overlays.splice(0),this._jsPlumb.overlayPositions=null},setVisible:function(e){this[e?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(e,t){this._jsPlumb.overlayPositions=this._jsPlumb.overlayPositions||{},this._jsPlumb.overlayPositions[e.id]=t},getAbsoluteOverlayPosition:function(e){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[e.id]:null}});var j=0,D=function(){var e=j+1;return j++,e},E=window.jsPlumbInstance=function(l){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},l&&_.extend(this.Defaults,l),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},jsPlumbUtil.EventGenerator.apply(this);var u=this,c=D(),d=u.bind,h={},f=1,g=function(e){var t=i(e);return{el:t,id:jsPlumbUtil.isString(e)&&null==t?e:te(t)}};this.getInstanceIndex=function(){return c},this.setZoom=function(e,t){f=e,t&&u.repaintEverything()},this.getZoom=function(){return f};for(var v in this.Defaults)h[v]=this.Defaults[v];this.bind=function(e,t){"ready"===e&&b?t():d.apply(u,[e,t])},u.importDefaults=function(e){for(var t in e)u.Defaults[t]=e[t];return u},u.restoreDefaults=function(){return u.Defaults=_.extend({},h),u};var m=null,b=!1,y=[],P={},j={},E={},C={},S={},A={},I=!1,w=[],O=!1,L=null,T=this.Defaults.Scope,x=null,k=1,M=function(){return""+k++},U=function(e,t){u.Defaults.Container?_.CurrentLibrary.appendElement(e,u.Defaults.Container):t?_.CurrentLibrary.appendElement(e,t):jsPlumbAdapter.appendToRoot(e)},H=function(e){return e._nodes?e._nodes:e},F=function(e,t,n,r){if(!jsPlumbAdapter.headless&&!O){var i=te(e),s=u.dragManager.getElementsForDraggable(i);null==n&&(n=a());var o=$({elId:i,offset:t,recalc:!1,timestamp:n});if(s)for(var l in s)$({elId:s[l].id,offset:{left:o.o.left+s[l].offset.left,top:o.o.top+s[l].offset.top},recalc:!1,timestamp:n});if(u.anchorManager.redraw(i,t,n,null,r),s)for(var c in s)u.anchorManager.redraw(s[c].id,t,n,s[c].offset,r,!0)}},R=function(t,n){var i,s,o=null;if(e.isArray(t)){o=[];for(var a=0,l=t.length;l>a;a++)i=r(t[a]),s=u.getAttribute(i,"id"),o.push(n(i,s))}else i=r(t),s=u.getAttribute(i,"id"),o=n(i,s);return o},N=function(e){return j[e]},V=function(r,i,s){if(!jsPlumbAdapter.headless){var o=null==i?!1:i,a=_.CurrentLibrary;if(o&&a.isDragSupported(r)&&!a.isAlreadyDraggable(r)){var l=s||u.Defaults.DragOptions||_.Defaults.DragOptions;l=_.extend({},l);var c=a.dragEvents.drag,d=a.dragEvents.stop,h=a.dragEvents.start;l[h]=e.wrap(l[h],function(){u.setHoverSuspended(!0),u.select({source:r}).addClass(u.elementDraggingClass+" "+u.sourceElementDraggingClass,!0),u.select({target:r}).addClass(u.elementDraggingClass+" "+u.targetElementDraggingClass,!0),u.setConnectionBeingDragged(!0)}),l[c]=e.wrap(l[c],function(){var e=a.getUIPosition(arguments,u.getZoom());F(r,e,null,!0),t(r,"jsPlumb_dragged")}),l[d]=e.wrap(l[d],function(){var e=a.getUIPosition(arguments,u.getZoom());F(r,e),n(r,"jsPlumb_dragged"),u.setHoverSuspended(!1),u.select({source:r}).removeClass(u.elementDraggingClass+" "+u.sourceElementDraggingClass,!0),u.select({target:r}).removeClass(u.elementDraggingClass+" "+u.targetElementDraggingClass,!0),u.setConnectionBeingDragged(!1),u.dragManager.dragEnded(r)});var f=te(r);A[f]=!0;var p=A[f];l.disabled=null==p?!1:!p,a.initDraggable(r,l,!1,u),u.dragManager.register(r)}}},B=function(t,n){var r=_.extend({},t);if(n&&_.extend(r,n),r.source&&(r.source.endpoint?r.sourceEndpoint=r.source:r.source=i(r.source)),r.target&&(r.target.endpoint?r.targetEndpoint=r.target:r.target=i(r.target)),t.uuids&&(r.sourceEndpoint=N(t.uuids[0]),r.targetEndpoint=N(t.uuids[1])),r.sourceEndpoint&&r.sourceEndpoint.isFull())return void e.log(u,"could not add connection; source endpoint is full");if(r.targetEndpoint&&r.targetEndpoint.isFull())return void e.log(u,"could not add connection; target endpoint is full");if(!r.type&&r.sourceEndpoint&&(r.type=r.sourceEndpoint.connectionType),r.sourceEndpoint&&r.sourceEndpoint.connectorOverlays){r.overlays=r.overlays||[];for(var s=0,o=r.sourceEndpoint.connectorOverlays.length;o>s;s++)r.overlays.push(r.sourceEndpoint.connectorOverlays[s])}!r["pointer-events"]&&r.sourceEndpoint&&r.sourceEndpoint.connectorPointerEvents&&(r["pointer-events"]=r.sourceEndpoint.connectorPointerEvents);var a,l,c,d;if(r.target&&!r.target.endpoint&&!r.targetEndpoint&&!r.newConnection&&(a=te(r.target),l=ye[a],c=Pe[a],l)){if(!Oe[a])return;l.isTarget=!0,d=null!=c?c:u.addEndpoint(r.target,l),je[a]&&(Pe[a]=d),r.targetEndpoint=d,d._doNotDeleteOnDetach=!1,d._deleteOnDetach=!0}if(r.source&&!r.source.endpoint&&!r.sourceEndpoint&&!r.newConnection&&(a=te(r.source),l=_e[a],c=Ce[a],l)){if(!Ae[a])return;d=null!=c?c:u.addEndpoint(r.source,l),Se[a]&&(Ce[a]=d),r.sourceEndpoint=d,d._doNotDeleteOnDetach=!1,d._deleteOnDetach=!0}return r},W=function(e){var t=u.Defaults.ConnectionType||u.getDefaultConnectionType(),n=u.Defaults.EndpointType||_.Endpoint,r=_.CurrentLibrary.getParent;e.container?e.parent=e.container:e.sourceEndpoint?e.parent=e.sourceEndpoint.parent:e.source.constructor==n?e.parent=e.source.parent:e.parent=r(e.source),e._jsPlumb=u,e.newConnection=W,e.newEndpoint=q,e.endpointsByUUID=j,e.endpointsByElement=P,e.finaliseConnection=z;var i=new t(e);return i.id="con_"+M(),Z("click","click",i),Z("dblclick","dblclick",i),Z("contextmenu","contextmenu",i),i.isDetachable()&&(i.endpoints[0].initDraggable(),i.endpoints[1].initDraggable()),i},z=function(e,t,n,r){if(t=t||{},e.suspendedEndpoint||y.push(e),(null==e.suspendedEndpoint||r)&&u.anchorManager.newConnection(e),F(e.source),!t.doNotFireConnectionEvent&&t.fireEvent!==!1){var i={connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]};u.fire("connection",i,n)}},Z=function(e,t,n){n.bind(e,function(e,r){u.fire(t,n,r)})},G=function(e){if(e.container)return e.container;var t=_.CurrentLibrary.getTagName(e.source),n=_.CurrentLibrary.getParent(e.source);return t&&"td"===t.toLowerCase()?_.CurrentLibrary.getParent(n):n},q=function(e){var t=u.Defaults.EndpointType||_.Endpoint,n=_.extend({},e);n.parent=G(n),n._jsPlumb=u,n.newConnection=W,n.newEndpoint=q,n.endpointsByUUID=j,n.endpointsByElement=P,n.finaliseConnection=z,n.fireDetachEvent=ne,n.fireMoveEvent=re,n.floatingConnections=S,n.getParentFromParams=G,n.elementId=te(n.source);var r=new t(n);return r.id="ep_"+M(),Z("click","endpointClick",r),Z("dblclick","endpointDblClick",r),Z("contextmenu","contextmenu",r),jsPlumbAdapter.headless||u.dragManager.endpointAdded(n.source),r},X=function(e,t,n){var r=P[e];if(r&&r.length)for(var i=0,s=r.length;s>i;i++){for(var o=0,a=r[i].connections.length;a>o;o++){var l=t(r[i].connections[o]);if(l)return}n&&n(r[i])}},Y=function(e,t){return R(e,function(e,n){A[n]=t,_.CurrentLibrary.isDragSupported(e)&&_.CurrentLibrary.setDraggable(e,t)})},J=function(e,t,n){t="block"===t;var r=null;n&&(r=t?function(e){e.setVisible(!0,!0,!0)}:function(e){e.setVisible(!1,!0,!0)});var i=g(e);X(i.id,function(e){if(t&&n){var r=e.sourceId===i.id?1:0;e.endpoints[r].isVisible()&&e.setVisible(!0)}else e.setVisible(t)},r)},K=function(e){return R(e,function(e,t){var n=null==A[t]?!1:A[t];return n=!n,A[t]=n,_.CurrentLibrary.setDraggable(e,n),n})},Q=function(e,t){var n=null;t&&(n=function(e){var t=e.isVisible();e.setVisible(!t)}),X(e,function(e){var t=e.isVisible();e.setVisible(!t)},n)},$=function(e){var t,n=e.timestamp,i=e.recalc,a=e.offset,l=e.elId;return O&&!n&&(n=L),!i&&n&&n===C[l]?{o:e.offset||E[l],s:w[l]}:(i||!a?(t=r(l),null!=t&&(w[l]=o(t),E[l]=s(t,u),C[l]=n)):(E[l]=a,null==w[l]&&(t=r(l),null!=t&&(w[l]=o(t))),C[l]=n),E[l]&&!E[l].right&&(E[l].right=E[l].left+w[l][0],E[l].bottom=E[l].top+w[l][1],E[l].width=w[l][0],E[l].height=w[l][1],E[l].centerx=E[l].left+E[l].width/2,E[l].centery=E[l].top+E[l].height/2),{o:E[l],s:w[l]})},ee=function(e){var t=E[e];return t?{o:t,s:w[e]}:$({elId:e})},te=function(e,t,n){if(jsPlumbUtil.isString(e))return e;if(null==e)return null;var r=jsPlumbAdapter.getAttribute(e,"id");return r&&"undefined"!==r||(2==arguments.length&&void 0!==arguments[1]?r=t:(1==arguments.length||3==arguments.length&&!arguments[2])&&(r="jsPlumb_"+c+"_"+M()),n||jsPlumbAdapter.setAttribute(e,"id",r)),r};this.setConnectionBeingDragged=function(e){I=e},this.isConnectionBeingDragged=function(){return I},this.connectorClass="_jsPlumb_connector",this.hoverClass="_jsPlumb_hover",this.endpointClass="_jsPlumb_endpoint",this.endpointConnectedClass="_jsPlumb_endpoint_connected",this.endpointFullClass="_jsPlumb_endpoint_full",this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed",this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden",this.overlayClass="_jsPlumb_overlay",this.draggingClass="_jsPlumb_dragging",this.elementDraggingClass="_jsPlumb_element_dragging",this.sourceElementDraggingClass="_jsPlumb_source_element_dragging",this.targetElementDraggingClass="_jsPlumb_target_element_dragging",this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor",this.hoverSourceClass="_jsPlumb_source_hover",this.hoverTargetClass="_jsPlumb_target_hover",this.dragSelectClass="_jsPlumb_drag_select",this.Anchors={},this.Connectors={canvas:{},svg:{},vml:{}},this.Endpoints={canvas:{},svg:{},vml:{}},this.Overlays={canvas:{},svg:{},vml:{}},this.ConnectorRenderers={},this.SVG="svg",this.CANVAS="canvas",this.VML="vml",this.addEndpoint=function(t,n,r){r=r||{};var s=_.extend({},r);_.extend(s,n),s.endpoint=s.endpoint||u.Defaults.Endpoint||_.Defaults.Endpoint,s.paintStyle=s.paintStyle||u.Defaults.EndpointStyle||_.Defaults.EndpointStyle,t=H(t);for(var o=[],a=e.isArray(t)||null!=t.length&&!e.isString(t)?t:[t],l=0,c=a.length;c>l;l++){var d=i(a[l]),h=te(d);s.source=d,$({elId:h,timestamp:L});var f=q(s);s.parentAnchor&&(f.parentAnchor=s.parentAnchor),e.addToList(P,h,f);var p=E[h],g=w[h],v=f.anchor.compute({xy:[p.left,p.top],wh:g,element:f,timestamp:L}),m={anchorLoc:v,timestamp:L};O&&(m.recalc=!1),O||f.paint(m),o.push(f),f._doNotDeleteOnDetach=!0}return 1==o.length?o[0]:o},this.addEndpoints=function(t,n,r){for(var i=[],s=0,o=n.length;o>s;s++){var a=u.addEndpoint(t,n[s],r);e.isArray(a)?Array.prototype.push.apply(i,a):i.push(a)}return i},this.animate=function(t,n,i){i=i||{};var s=r(t),o=te(t),a=_.CurrentLibrary.dragEvents.step,l=_.CurrentLibrary.dragEvents.complete;i[a]=e.wrap(i[a],function(){u.repaint(o)}),i[l]=e.wrap(i[l],function(){u.repaint(o)}),_.CurrentLibrary.animate(s,n,i)},this.checkCondition=function(t,n){var r=u.getListener(t),i=!0;if(r&&r.length>0)try{for(var s=0,o=r.length;o>s;s++)i=i&&r[s](n)}catch(a){e.log(u,"cannot check condition ["+t+"]"+a)}return i},this.checkASyncCondition=function(t,n,r,i){var s=u.getListener(t);if(s&&s.length>0)try{s[0](n,r,i)}catch(o){e.log(u,"cannot asynchronously check condition ["+t+"]"+o)}},this.connect=function(e,t){var n,r=B(e,t);return r&&(n=W(r),z(n,r)),n},this.deleteEndpoint=function(e,t){var n=u.setSuspendDrawing(!0),r="string"==typeof e?j[e]:e;return r&&u.deleteObject({endpoint:r}),n||u.setSuspendDrawing(!1,t),u},this.deleteEveryEndpoint=function(){var e=u.setSuspendDrawing(!0);for(var t in P){var n=P[t];if(n&&n.length)for(var r=0,i=n.length;i>r;r++)u.deleteEndpoint(n[r],!0)}return P={},j={},u.anchorManager.reset(),u.dragManager.reset(),e||u.setSuspendDrawing(!1),u};var ne=function(e,t,n){var r=u.Defaults.ConnectionType||u.getDefaultConnectionType(),i=e.constructor==r,s=i?{connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]}:e;t&&u.fire("connectionDetached",s,n),u.anchorManager.connectionDetached(s)},re=function(e,t){u.fire("connectionMoved",e,t)};this.unregisterEndpoint=function(e){e._jsPlumb.uuid&&(j[e._jsPlumb.uuid]=null),u.anchorManager.deleteEndpoint(e);for(var t in P){var n=P[t];if(n){for(var r=[],i=0,s=n.length;s>i;i++)n[i]!=e&&r.push(n[i]);P[t]=r}P[t].length<1&&delete P[t]}},this.detach=function(){if(0!==arguments.length){var e=u.Defaults.ConnectionType||u.getDefaultConnectionType(),t=arguments[0].constructor==e,n=2==arguments.length&&t?arguments[1]||{}:arguments[0],r=n.fireEvent!==!1,s=n.forceDetach,o=t?arguments[0]:n.connection;if(o)(s||jsPlumbUtil.functionChain(!0,!1,[[o.endpoints[0],"isDetachAllowed",[o]],[o.endpoints[1],"isDetachAllowed",[o]],[o,"isDetachAllowed",[o]],[u,"checkCondition",["beforeDetach",o]]]))&&o.endpoints[0].detach(o,!1,!0,r);else{var a=_.extend({},n);if(a.uuids)N(a.uuids[0]).detachFrom(N(a.uuids[1]),r);else if(a.sourceEndpoint&&a.targetEndpoint)a.sourceEndpoint.detachFrom(a.targetEndpoint);else{var l=te(i(a.source)),c=te(i(a.target));X(l,function(e){(e.sourceId==l&&e.targetId==c||e.targetId==l&&e.sourceId==c)&&u.checkCondition("beforeDetach",e)&&e.endpoints[0].detach(e,!1,!0,r)})}}}},this.detachAllConnections=function(e,t){t=t||{},e=i(e);var n=te(e),r=P[n];if(r&&r.length)for(var s=0,o=r.length;o>s;s++)r[s].detachAll(t.fireEvent!==!1);return u},this.detachEveryConnection=function(e){return e=e||{},u.doWhileSuspended(function(){for(var t in P){var n=P[t];if(n&&n.length)for(var r=0,i=n.length;i>r;r++)n[r].detachAll(e.fireEvent!==!1)}y.splice(0)}),u},this.deleteObject=function(e){var t={endpoints:{},connections:{},endpointCount:0,connectionCount:0},n=e.fireEvent!==!1,r=e.deleteAttachedObjects!==!1,i=function(e){if(null!=e&&null==t.connections[e.id]&&(null!=e._jsPlumb&&e.setHover(!1),t.connections[e.id]=e,t.connectionCount++,r))for(var n=0;n<e.endpoints.length;n++)e.endpoints[n]._deleteOnDetach&&s(e.endpoints[n])},s=function(e){if(null!=e&&null==t.endpoints[e.id]&&(null!=e._jsPlumb&&e.setHover(!1),t.endpoints[e.id]=e,t.endpointCount++,r))for(var n=0;n<e.connections.length;n++){var s=e.connections[n];i(s)}};e.connection?i(e.connection):s(e.endpoint);for(var o in t.connections){var a=t.connections[o];a.endpoints[0].detachFromConnection(a),a.endpoints[1].detachFromConnection(a),jsPlumbUtil.removeWithFunction(y,function(e){return a.id==e.id}),ne(a,n,e.originalEvent),a.cleanup(),a.destroy()}for(var l in t.endpoints){var c=t.endpoints[l];u.unregisterEndpoint(c),c.cleanup(),c.destroy()}return t},this.draggable=function(e,t){var n,r,s;if("object"==typeof e&&e.length)for(n=0,r=e.length;r>n;n++)s=i(e[n]),s&&V(s,!0,t);else if(e._nodes)for(n=0,r=e._nodes.length;r>n;n++)s=i(e._nodes[n]),s&&V(s,!0,t);else s=i(e),s&&V(s,!0,t);return u},this.extend=function(e,t){return _.CurrentLibrary.extend(e,t)};var ie=function(e,t,n,r){for(var i=0,s=e.length;s>i;i++)e[i][t].apply(e[i],n);return r(e)},se=function(e,t,n){for(var r=[],i=0,s=e.length;s>i;i++)r.push([e[i][t].apply(e[i],n),e[i]]);return r},oe=function(e,t,n){return function(){return ie(e,t,arguments,n)}},ae=function(e,t){return function(){return se(e,t,arguments)}},le=function(e,t){var n=[];if(e)if("string"==typeof e){if("*"===e)return e;n.push(e)}else if(e=r(e),t)n=e;else for(var i=0,s=e.length;s>i;i++)n.push(g(e[i]).id);return n},ue=function(e,t,n){return"*"===e?!0:e.length>0?-1!=jsPlumbUtil.indexOf(e,t):!n};this.getConnections=function(e,t){e?e.constructor==String&&(e={scope:e}):e={};for(var n=e.scope||u.getDefaultScope(),r=le(n,!0),i=le(e.source),s=le(e.target),o=!t&&r.length>1?{}:[],a=function(e,n){if(!t&&r.length>1){var i=o[e];null==i&&(i=o[e]=[]),i.push(n)}else o.push(n)},l=0,c=y.length;c>l;l++){var d=y[l];ue(r,d.scope)&&ue(i,d.sourceId)&&ue(s,d.targetId)&&a(d.scope,d)}return o};var ce=function(e,t){return function(n){for(var r=0,i=e.length;i>r;r++)n(e[r]);return t(e)}},de=function(e){return function(t){return e[t]}},he=function(e,t){var n,r,i={length:e.length,each:ce(e,t),get:de(e)},s=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],o=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(n=0,r=s.length;r>n;n++)i[s[n]]=oe(e,s[n],t);for(n=0,r=o.length;r>n;n++)i[o[n]]=ae(e,o[n]);return i},fe=function(e){var t=he(e,fe);return _.CurrentLibrary.extend(t,{setDetachable:oe(e,"setDetachable",fe),setReattach:oe(e,"setReattach",fe),setConnector:oe(e,"setConnector",fe),detach:function(){for(var t=0,n=e.length;n>t;t++)u.detach(e[t])},isDetachable:ae(e,"isDetachable"),isReattach:ae(e,"isReattach")})},pe=function(e){var t=he(e,pe);return _.CurrentLibrary.extend(t,{setEnabled:oe(e,"setEnabled",pe),setAnchor:oe(e,"setAnchor",pe),isEnabled:ae(e,"isEnabled"),detachAll:function(){for(var t=0,n=e.length;n>t;t++)e[t].detachAll()},remove:function(){for(var t=0,n=e.length;n>t;t++)u.deleteObject({endpoint:e[t]})}})};this.select=function(e){return e=e||{},e.scope=e.scope||"*",fe(e.connections||u.getConnections(e,!0))},this.selectEndpoints=function(e){e=e||{},e.scope=e.scope||"*";var t=!e.element&&!e.source&&!e.target,n=t?"*":le(e.element),r=t?"*":le(e.source),i=t?"*":le(e.target),s=le(e.scope,!0),o=[];for(var a in P){var l=ue(n,a,!0),u=ue(r,a,!0),c="*"!=r,d=ue(i,a,!0),h="*"!=i;if(l||u||d)e:for(var f=0,p=P[a].length;p>f;f++){var g=P[a][f];if(ue(s,g.scope,!0)){var v=c&&r.length>0&&!g.isSource,m=h&&i.length>0&&!g.isTarget;if(v||m)continue e;o.push(g)}}}return pe(o)},this.getAllConnections=function(){return y},this.getDefaultScope=function(){return T},this.getEndpoint=N,this.getEndpoints=function(e){return P[g(e).id]},this.getDefaultEndpointType=function(){return _.Endpoint},this.getDefaultConnectionType=function(){return _.Connection},this.getId=te,this.getOffset=function(e){E[e];return $({elId:e})},this.getSelector=function(){return _.CurrentLibrary.getSelector.apply(null,arguments)},this.getSize=function(e){var t=w[e];return t||$({elId:e}),w[e]},this.appendElement=U;var ge=!1;this.isHoverSuspended=function(){return ge},this.setHoverSuspended=function(e){ge=e};var ve=function(e){return function(){return jsPlumbAdapter.isRenderModeAvailable(e)}};this.isCanvasAvailable=ve("canvas"),this.isSVGAvailable=ve("svg"),this.isVMLAvailable=ve("vml"),this.hide=function(e,t){return J(e,"none",t),u},this.idstamp=M,this.connectorsInitialized=!1;var me=[],be=["canvas","svg","vml"];this.registerConnectorType=function(e,t){me.push([e,t])},this.init=function(){var e=function(e,t,n){_.Connectors[e][t]=function(){n.apply(this,arguments),_.ConnectorRenderers[e].apply(this,arguments)},jsPlumbUtil.extend(_.Connectors[e][t],[n,_.ConnectorRenderers[e]])};if(!_.connectorsInitialized){for(var t=0;t<me.length;t++)for(var n=0;n<be.length;n++)e(be[n],me[t][1],me[t][0]);_.connectorsInitialized=!0}b||(u.anchorManager=new _.AnchorManager({jsPlumbInstance:u}),u.setRenderMode(u.Defaults.RenderMode),b=!0,u.fire("ready",u))}.bind(this),this.log=m,this.jsPlumbUIComponent=p,this.makeAnchor=function(){var t,n=function(e,t){if(_.Anchors[e])return new _.Anchors[e](t);if(!u.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+e+"'"}};if(0===arguments.length)return null;var r=arguments[0],i=arguments[1],s=arguments[2],o=null;if(r.compute&&r.getOrientation)return r;if("string"==typeof r)o=n(arguments[0],{elementId:i,jsPlumbInstance:u});else if(e.isArray(r))if(e.isArray(r[0])||e.isString(r[0]))2==r.length&&e.isObject(r[1])?e.isString(r[0])?(t=_.extend({elementId:i,jsPlumbInstance:u},r[1]),o=n(r[0],t)):(t=_.extend({elementId:i,jsPlumbInstance:u,anchors:r[0]},r[1]),o=new _.DynamicAnchor(t)):o=new _.DynamicAnchor({anchors:r,selector:null,elementId:i,jsPlumbInstance:s});else{var a={x:r[0],y:r[1],orientation:r.length>=4?[r[2],r[3]]:[0,0],offsets:r.length>=6?[r[4],r[5]]:[0,0],elementId:i,jsPlumbInstance:s,cssClass:7==r.length?r[6]:null};o=new _.Anchor(a),o.clone=function(){return new _.Anchor(a)}}return o.id||(o.id="anchor_"+M()),o},this.makeAnchors=function(t,n,r){for(var i=[],s=0,o=t.length;o>s;s++)"string"==typeof t[s]?i.push(_.Anchors[t[s]]({elementId:n,jsPlumbInstance:r})):e.isArray(t[s])&&i.push(u.makeAnchor(t[s],n,r));return i},this.makeDynamicAnchor=function(e,t){return new _.DynamicAnchor({anchors:e,selector:t,elementId:null,jsPlumbInstance:u})};var ye={},Pe={},je={},De={},Ee=function(e,t){e.paintStyle=e.paintStyle||u.Defaults.EndpointStyles[t]||u.Defaults.EndpointStyle||_.Defaults.EndpointStyles[t]||_.Defaults.EndpointStyle,e.hoverPaintStyle=e.hoverPaintStyle||u.Defaults.EndpointHoverStyles[t]||u.Defaults.EndpointHoverStyle||_.Defaults.EndpointHoverStyles[t]||_.Defaults.EndpointHoverStyle,e.anchor=e.anchor||u.Defaults.Anchors[t]||u.Defaults.Anchor||_.Defaults.Anchors[t]||_.Defaults.Anchor,e.endpoint=e.endpoint||u.Defaults.Endpoints[t]||u.Defaults.Endpoint||_.Defaults.Endpoints[t]||_.Defaults.Endpoint},_e={},Ce={},Se={},Ae={},Ie={},we={},Oe={},Le=function(e,t,n){for(var r=e.target||e.srcElement,i=!1,s=u.getSelector(t,n),o=0;o<s.length;o++)if(s[o]==r){i=!0;break}return i};this.makeTarget=function(t,n,i){var a=_.extend({_jsPlumb:u},i);_.extend(a,n),Ee(a,1);var l=_.CurrentLibrary,c=a.scope||u.Defaults.Scope,d=!(a.deleteEndpointsOnDetach===!1),h=a.maxConnections||-1,f=a.onMaxConnections,v=function(t){var n=g(t),i=n.id,v=new p(a),m=_.extend({},a.dropOptions||{});ye[i]=a,je[i]=a.uniqueEndpoint,De[i]=h,Oe[i]=!0;var b=function(){u.currentlyDragging=!1;var e=_.CurrentLibrary.getDropEvent(arguments),t=u.select({target:i}).length,c=r(l.getDragObject(arguments)),h=u.getAttribute(c,"dragId"),p=u.getAttribute(c,"originalScope"),g=S[h],m=g.endpoints[0].isFloating()?0:1,b=g.endpoints[0];a.endpoint?_.extend({},a.endpoint):{};if(!Oe[i]||De[i]>0&&t>=De[i])return f&&f({element:n.el,connection:g},e),!1;if(b.anchor.locked=!1,p&&l.setDragScope(c,p),null==g.suspendedEndpoint&&!g.pending)return!1;var y=v.isDropAllowed(0===m?i:g.sourceId,0===m?g.targetId:i,g.scope,g,null);if(g.suspendedEndpoint&&(g[m?"targetId":"sourceId"]=g.suspendedEndpoint.elementId,g[m?"target":"source"]=g.suspendedEndpoint.element,g.endpoints[m]=g.suspendedEndpoint),y){var P=l.getElementObject(n.el),j=Pe[i];if((null==j||null==j._jsPlumb)&&(j=u.addEndpoint(P,a)),
a.uniqueEndpoint&&(Pe[i]=j),j._doNotDeleteOnDetach=!1,j._deleteOnDetach=!0,null!=j.anchor.positionFinder){var D=l.getUIPosition(arguments,u.getZoom()),E=s(P,u),C=o(P),A=j.anchor.positionFinder(D,E,C,j.anchor.constructorParams);j.anchor.x=A[0],j.anchor.y=A[1]}g[m?"target":"source"]=j.element,g[m?"targetId":"sourceId"]=j.elementId,g.endpoints[m].detachFromConnection(g),g.endpoints[m]._deleteOnDetach&&(g.endpoints[m].deleteAfterDragStop=!0),j.addConnection(g),g.endpoints[m]=j,g.deleteEndpointsOnDetach=d,1==m?u.anchorManager.updateOtherEndpoint(g.sourceId,g.suspendedElementId,g.targetId,g):u.anchorManager.sourceChanged(g.suspendedEndpoint.elementId,g.sourceId,g),z(g,null,e),g.pending=!1}else g.suspendedEndpoint&&(g.isReattach()?(g.setHover(!1),g.floatingAnchorIndex=null,g.suspendedEndpoint.addConnection(g),u.repaint(b.elementId)):b.detach(g,!1,!0,!0,e))},y=l.dragEvents.drop;m.scope=m.scope||c,m[y]=e.wrap(m[y],b),l.initDroppable(r(n.el),m,!0)};t=H(t);for(var m=t.length&&t.constructor!=String?t:[t],b=0,y=m.length;y>b;b++)v(m[b]);return u},this.unmakeTarget=function(e,t){var n=g(e);return _.CurrentLibrary.destroyDroppable(n.el),t||(delete ye[n.id],delete je[n.id],delete De[n.id],delete Oe[n.id]),u},this.makeSource=function(t,n,a){var l=_.extend({},a);_.extend(l,n),Ee(l,0);var c=_.CurrentLibrary,d=l.maxConnections||-1,h=l.onMaxConnections,f=function(t){var n=t.id,a=r(t.el),f=function(){return null==l.parent?null:"parent"===l.parent?t.el.parentNode:i(l.parent)},p=null!=l.parent?u.getId(f()):n;_e[p]=l,Se[p]=l.uniqueEndpoint,Ae[p]=!0;var g=c.dragEvents.stop,v=c.dragEvents.drag,m=_.extend({},l.dragOptions||{}),b=m.drag,y=m.stop,P=null,j=!1;we[p]=d,m.scope=m.scope||l.scope,m[v]=e.wrap(m[v],function(){b&&b.apply(this,arguments),j=!1}),m[g]=e.wrap(m[g],function(){if(y&&y.apply(this,arguments),u.currentlyDragging=!1,null!=P._jsPlumb){c.unbind(P.canvas,"mousedown");var e=l.anchor||u.Defaults.Anchor,t=P.anchor,r=P.connections[0],i=u.makeAnchor(e,n,u),a=P.element;if(null!=i.positionFinder){var d=s(a,u),h=o(a),p={left:d.left+t.x*h[0],top:d.top+t.y*h[1]},g=i.positionFinder(p,d,h,i.constructorParams);i.x=g[0],i.y=g[1]}if(P.setAnchor(i,!0),l.parent){var v=f();if(v){var m=l.container||u.Defaults.Container||_.Defaults.Container;P.setElement(v,m)}}P.repaint(),u.repaint(P.elementId),u.repaint(r.targetId)}});var D=function(e){if(Ae[p]){if(l.filter){var t=c.getOriginalEvent(e),r=jsPlumbUtil.isString(l.filter)?Le(t,a,l.filter):l.filter(t,a);if(r===!1)return}var i=u.select({source:p}).length;if(we[p]>=0&&i>=we[p])return h&&h({element:a,maxConnections:d},e),!1;var s=$({elId:n}).o,o=u.getZoom(),g=((e.pageX||e.page.x)/o-s.left)/s.width,v=((e.pageY||e.page.y)/o-s.top)/s.height,b=g,y=v;if(l.parent){var D=f(),E=te(D);s=$({elId:E}).o,b=((e.pageX||e.page.x)-s.left)/s.width,y=((e.pageY||e.page.y)-s.top)/s.height}var C={};if(_.extend(C,l),C.isSource=!0,C.anchor=[g,v,0,0],C.parentAnchor=[b,y,0,0],C.dragOptions=m,l.parent){var S=C.container||u.Defaults.Container||_.Defaults.Container;S?C.container=S:C.container=_.CurrentLibrary.getParent(f())}P=u.addEndpoint(n,C),j=!0,P.endpointWillMoveAfterConnection=null!=l.parent,P.endpointWillMoveTo=l.parent?f():null,P._doNotDeleteOnDetach=!1,P._deleteOnDetach=!0;var A=function(){j&&(j=!1,u.deleteEndpoint(P))};u.registerListener(P.canvas,"mouseup",A),u.registerListener(a,"mouseup",A),c.trigger(P.canvas,"mousedown",e)}};u.registerListener(a,"mousedown",D),Ie[n]=D,l.filter&&jsPlumbUtil.isString(l.filter)&&c.setDragFilter(a,l.filter)};t=H(t);for(var p=t.length&&t.constructor!=String?t:[t],v=0,m=p.length;m>v;v++)f(g(p[v]));return u},this.unmakeSource=function(e,t){var n=g(e),r=Ie[n.id];return r&&u.unregisterListener(n.el,"mousedown",r),t||(delete _e[n.id],delete Se[n.id],delete Ae[n.id],delete Ie[n.id],delete we[n.id]),u},this.unmakeEverySource=function(){for(var e in Ae)u.unmakeSource(e,!0);_e={},Se={},Ae={},Ie={}},this.unmakeEveryTarget=function(){for(var e in Oe)u.unmakeTarget(e,!0);return ye={},je={},De={},Oe={},u};var Te=function(t,n,r,i){var s="source"==t?Ae:Oe;if(n=H(n),e.isString(n))s[n]=i?!s[n]:r;else if(n.length)for(var o=0,a=n.length;a>o;o++){var l=g(n[o]);s[l.id]=i?!s[l.id]:r}return u};this.toggleSourceEnabled=function(e){return Te("source",e,null,!0),u.isSourceEnabled(e)},this.setSourceEnabled=function(e,t){return Te("source",e,t)},this.isSource=function(e){return null!=Ae[g(e).id]},this.isSourceEnabled=function(e){return Ae[g(e).id]===!0},this.toggleTargetEnabled=function(e){return Te("target",e,null,!0),u.isTargetEnabled(e)},this.isTarget=function(e){return null!=Oe[g(e).id]},this.isTargetEnabled=function(e){return Oe[g(e).id]===!0},this.setTargetEnabled=function(e,t){return Te("target",e,t)},this.ready=function(e){u.bind("ready",e)},this.repaint=function(e,t,n){if("object"==typeof e&&e.length)for(var r=0,i=e.length;i>r;r++)F(e[r],t,n);else F(e,t,n);return u},this.repaintEverything=function(e){var t=a();for(var n in P)F(n,null,t,e);return u},this.removeAllEndpoints=function(e,t){var n=function(e){var r,i,s=g(e),o=P[s.id];if(o)for(r=0,i=o.length;i>r;r++)u.deleteEndpoint(o[r]);if(delete P[s.id],t&&s.el&&3!=s.el.nodeType&&8!=s.el.nodeType)for(r=0,i=s.el.childNodes.length;i>r;r++)n(s.el.childNodes[r])};return n(e),u},this.remove=function(e,t){var n=g(e);u.doWhileSuspended(function(){u.removeAllEndpoints(n.id,!0),u.dragManager.elementRemoved(n.id),delete S[n.id],u.anchorManager.clearFor(n.id),u.anchorManager.removeFloatingConnection(n.id)},t===!1),n.el&&_.CurrentLibrary.removeElement(n.el)};var xe={},ke=function(){for(var e in xe)for(var t=0,n=xe[e].length;n>t;t++){var r=xe[e][t];_.CurrentLibrary.unbind(r.el,r.event,r.listener)}xe={}};this.registerListener=function(e,t,n){_.CurrentLibrary.bind(e,t,n),jsPlumbUtil.addToList(xe,t,{el:e,event:t,listener:n})},this.unregisterListener=function(e,t,n){_.CurrentLibrary.unbind(e,t,n),jsPlumbUtil.removeWithFunction(xe,function(e){return e.type==t&&e.listener==n})},this.reset=function(){u.deleteEveryEndpoint(),u.unbind(),ye={},Pe={},je={},De={},_e={},Ce={},Se={},we={},y.splice(0),ke(),u.anchorManager.reset(),jsPlumbAdapter.headless||u.dragManager.reset()},this.setDefaultScope=function(e){return T=e,u},this.setDraggable=Y,this.setId=function(e,t,n){var r;jsPlumbUtil.isString(e)?r=e:(e=i(e),r=u.getId(e));var s=u.getConnections({source:r,scope:"*"},!0),o=u.getConnections({target:r,scope:"*"},!0);t=""+t,n?e=i(t):(e=i(r),jsPlumbAdapter.setAttribute(e,"id",t)),P[t]=P[r]||[];for(var a=0,l=P[t].length;l>a;a++)P[t][a].setElementId(t),P[t][a].setReferenceElement(e);delete P[r],u.anchorManager.changeId(r,t),jsPlumbAdapter.headless||u.dragManager.changeId(r,t);var c=function(n,r,i){for(var s=0,o=n.length;o>s;s++)n[s].endpoints[r].setElementId(t),n[s].endpoints[r].setReferenceElement(e),n[s][i+"Id"]=t,n[s][i]=e};c(s,0,"source"),c(o,1,"target"),u.repaint(t)},this.setDebugLog=function(e){m=e},this.setSuspendDrawing=function(e,t){var n=O;return O=e,L=e?(new Date).getTime():null,t&&u.repaintEverything(),n},this.isSuspendDrawing=function(){return O},this.getSuspendedAt=function(){return L},this.doWhileSuspended=function(t,n){var r=u.isSuspendDrawing();r||u.setSuspendDrawing(!0);try{t()}catch(i){e.log("Function run while suspended failed",i)}r||u.setSuspendDrawing(!1,!n)},this.updateOffset=$,this.getOffset=function(e){return E[e]},this.getSize=function(e){return w[e]},this.getCachedData=ee,this.timestamp=a,this.setRenderMode=function(e){x=jsPlumbAdapter.setRenderMode(e);var t,n;if(x==_.CANVAS){var r=function(e){_.CurrentLibrary.bind(document,e,function(r){if(!u.currentlyDragging&&x==_.CANVAS){for(t=0,n=y.length;n>t;t++){var i=y[t].getConnector()[e](r);if(i)return}for(var s in P){var o=P[s];for(t=0,n=o.length;n>t;t++)if(o[t].endpoint[e]&&o[t].endpoint[e](r))return}}})};r("click"),r("dblclick"),r("mousemove"),r("mousedown"),r("mouseup"),r("contextmenu")}return x},this.getRenderMode=function(){return x},this.show=function(e,t){return J(e,"block",t),u},this.getTestHarness=function(){return{endpointsByElement:P,endpointCount:function(e){var t=P[e];return t?t.length:0},connectionCount:function(e){e=e||T;var t=u.getConnections({scope:e});return t?t.length:0},getId:te,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}},this.toggleVisible=Q,this.toggleDraggable=K,this.addListener=this.bind,this.adjustForParentOffsetAndScroll=function(e,t){var n=null,r=e;if("svg"===t.tagName.toLowerCase()&&t.parentNode?n=t.parentNode:t.offsetParent&&(n=t.offsetParent),null!=n){var i="body"===n.tagName.toLowerCase()?{left:0,top:0}:s(n,u),o="body"===n.tagName.toLowerCase()?{left:0,top:0}:{left:n.scrollLeft,top:n.scrollTop};r[0]=e[0]-i.left+o.left,r[1]=e[1]-i.top+o.top}return r},jsPlumbAdapter.headless||(u.dragManager=jsPlumbAdapter.getDragManager(u),u.recalculateOffsets=u.dragManager.updateOffsets)};jsPlumbUtil.extend(E,jsPlumbUtil.EventGenerator,{setAttribute:function(e,t,n){jsPlumbAdapter.setAttribute(e,t,n)},getAttribute:function(e,t){return jsPlumbAdapter.getAttribute(_.CurrentLibrary.getDOMElement(e),t)},registerConnectionType:function(e,t){this._connectionTypes[e]=_.extend({},t)},registerConnectionTypes:function(e){for(var t in e)this._connectionTypes[t]=_.extend({},e[t])},registerEndpointType:function(e,t){this._endpointTypes[e]=_.extend({},t)},registerEndpointTypes:function(e){for(var t in e)this._endpointTypes[t]=_.extend({},e[t])},getType:function(e,t){return"connection"===t?this._connectionTypes[e]:this._endpointTypes[e]},setIdChanged:function(e,t){this.setId(e,t,!0)},setParent:function(e,t){var n=_.CurrentLibrary,r=n.getElementObject(e),i=n.getDOMElement(r),s=this.getId(i),o=n.getElementObject(t),a=n.getDOMElement(o),l=this.getId(a);i.parentNode.removeChild(i),a.appendChild(i),this.dragManager.setParent(r,s,o,l)}});var _=new E;"undefined"!=typeof window&&(window.jsPlumb=_),_.getInstance=function(e){var t=new E(e);return t.init(),t},"function"==typeof define&&(define("jsplumb",[],function(){return _}),define("jsplumbinstance",[],function(){return _.getInstance()})),"undefined"!=typeof exports&&(exports.jsPlumb=_)}();

/*endpoint*/
!function(){var n=function(n,t){var e=!1;return{drag:function(){if(e)return e=!1,!0;var s=jsPlumb.CurrentLibrary.getUIPosition(arguments,t.getZoom());n.element&&(jsPlumb.CurrentLibrary.setOffset(n.element,s),t.repaint(n.element,s))},stopDrag:function(){e=!0}}},t=function(n,t,e){var s=document.createElement("div");s.style.position="absolute";jsPlumb.CurrentLibrary.getElementObject(s);jsPlumb.CurrentLibrary.appendElement(s,t);var i=e.getId(s);e.updateOffset({elId:i}),n.id=i,n.element=s},e=function(n,t,e,s,i,o,r){var a=new jsPlumb.FloatingAnchor({reference:t,referenceCanvas:s,jsPlumbInstance:o});return r({paintStyle:n,endpoint:e,anchor:a,source:i,scope:"__floating"})},s=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],i=function(n,t){var e=0;if(null!=t)for(var s=0;s<n.connections.length;s++)if(n.connections[s].sourceId==t||n.connections[s].targetId==t){e=s;break}return n.connections[e]},o=function(n,t){return jsPlumbUtil.findWithFunction(t.connections,function(t){return t.id==n.id})};jsPlumb.Endpoint=function(r){var a=r._jsPlumb,l=jsPlumb.CurrentLibrary,c=(jsPlumbAdapter.getAttribute,l.getElementObject),d=l.getDOMElement,h=jsPlumbUtil,u=r.newConnection,p=r.newEndpoint,m=r.finaliseConnection,g=(r.fireDetachEvent,r.fireMoveEvent),f=r.floatingConnections;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],this.parent=r.parent,OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:this._jsPlumb.instance.Defaults.MaxConnections,paintStyle:this._jsPlumb.instance.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:this._jsPlumb.instance.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:this._jsPlumb.instance.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:this._jsPlumb.instance.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:r.connectorStyle,connectorHoverStyle:r.connectorHoverStyle,connectorClass:r.connectorClass,connectorHoverClass:r.connectorHoverClass,connectorOverlays:r.connectorOverlays,connector:r.connector,connectorTooltip:r.connectorTooltip}},this._jsPlumb.enabled=!(r.enabled===!1),this._jsPlumb.visible=!0,this.element=d(r.source),this._jsPlumb.uuid=r.uuid,this._jsPlumb.floatingEndpoint=null;var b=null;this._jsPlumb.uuid&&(r.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=r.elementId,this._jsPlumb.connectionCost=r.connectionCost,this._jsPlumb.connectionsDirected=r.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var v=function(){l.removeClass(this.element,a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.removeClass(a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this._jsPlumb.currentAnchorClass=this.anchor.getCssClass(),this.addClass(a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),l.addClass(this.element,a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass)}.bind(this);this.setAnchor=function(n,t){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=this._jsPlumb.instance.makeAnchor(n,this.elementId,a),v(),this.anchor.bind("anchorChanged",function(n){this.fire("anchorChanged",{endpoint:this,anchor:n}),v()}.bind(this)),t||this._jsPlumb.instance.repaint(this.elementId),this};var C=r.anchor?r.anchor:r.anchors?r.anchors:a.Defaults.Anchor||"Top";this.setAnchor(C,!0);var P=function(n){this.connections.length>0?this.connections[0].setHover(n,!1):this.setHover(n)}.bind(this);r._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.setEndpoint=function(n){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy());var t=function(n,t){var e=a.getRenderMode();if(jsPlumb.Endpoints[e][n])return new jsPlumb.Endpoints[e][n](t);if(!a.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+n+"'"}},e={_jsPlumb:this._jsPlumb.instance,cssClass:r.cssClass,parent:r.parent,container:r.container,tooltip:r.tooltip,connectorTooltip:r.connectorTooltip,endpoint:this};h.isString(n)?this.endpoint=t(n,e):h.isArray(n)?(e=h.merge(n[1],e),this.endpoint=t(n[0],e)):this.endpoint=n.clone();jsPlumb.extend({},e);this.endpoint.clone=function(){return h.isString(n)?t(n,e):h.isArray(n)?(e=h.merge(n[1],e),t(n[0],e)):void 0}.bind(this),this.type=this.endpoint.type,this.bindListeners(this.endpoint,this,P)},this.setEndpoint(r.endpoint||a.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot"),this.setPaintStyle(r.paintStyle||r.style||a.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(r.hoverPaintStyle||a.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),h.copyValues(s,r,this),this.isSource=r.isSource||!1,this.isTarget=r.isTarget||!1,this._jsPlumb.maxConnections=r.maxConnections||a.Defaults.MaxConnections,this.canvas=this.endpoint.canvas,this.addClass(a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),l.addClass(this.element,a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.connections=r.connections||[],this.connectorPointerEvents=r["connector-pointer-events"],this.scope=r.scope||a.getDefaultScope(),this.timestamp=null,this.reattachConnections=r.reattach||a.Defaults.ReattachConnections,this.connectionsDetachable=a.Defaults.ConnectionsDetachable,(r.connectionsDetachable===!1||r.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=r.dragAllowedWhenFull||!0,r.onMaxConnections&&this.bind("maxConnections",r.onMaxConnections),this.addConnection=function(n){this.connections.push(n),this[(this.connections.length>0?"add":"remove")+"Class"](a.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](a.endpointFullClass)},this.detachFromConnection=function(n,t){t=null==t?o(n,this):t,t>=0&&(this.connections.splice(t,1),this[(this.connections.length>0?"add":"remove")+"Class"](a.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](a.endpointFullClass))},this.detach=function(n,t,e,s,i,r,l){var c=null==l?o(n,this):l,d=!1;return s=s!==!1,c>=0&&(e||n._forceDetach||n.isDetachable()&&n.isDetachAllowed(n)&&this.isDetachAllowed(n))&&(a.deleteObject({connection:n,fireEvent:!t&&s,originalEvent:i}),d=!0),d},this.detachAll=function(n,t){for(;this.connections.length>0;)this.detach(this.connections[0],!1,!0,n!==!1,t,this,0);return this},this.detachFrom=function(n,t,e){for(var s=[],i=0;i<this.connections.length;i++)(this.connections[i].endpoints[1]==n||this.connections[i].endpoints[0]==n)&&s.push(this.connections[i]);for(var o=0;o<s.length;o++)this.detach(s[o],!1,!0,t,e);return this},this.getElement=function(){return this.element},this.setElement=function(n){var t=this._jsPlumb.instance.getId(n),e=this.elementId;return h.removeWithFunction(r.endpointsByElement[this.elementId],function(n){return n.id==this.id}.bind(this)),this.element=d(n),this.elementId=a.getId(this.element),a.anchorManager.rehomeEndpoint(this,e,this.element),a.dragManager.endpointAdded(this.element),h.addToList(r.endpointsByElement,t,this),this},this.makeInPlaceCopy=function(){var n=this.anchor.getCurrentLocation({element:this}),t=this.anchor.getOrientation(this),e=this.anchor.getCssClass(),s={bind:function(){},compute:function(){return[n[0],n[1]]},getCurrentLocation:function(){return[n[0],n[1]]},getOrientation:function(){return t},getCssClass:function(){return e}};return p({anchor:s,source:this.element,paintStyle:this.getPaintStyle(),endpoint:r.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope})},this.isFloating=function(){return null!=this.anchor&&this.anchor.isFloating},this.connectorSelector=function(){var n=this.connections[0];return this.isTarget&&n?n:this.connections.length<this._jsPlumb.maxConnections||-1==this._jsPlumb.maxConnections?null:n},this.setStyle=this.setPaintStyle,this.paint=function(n){n=n||{};var t=n.timestamp,e=!(n.recalc===!1);if(!t||this.timestamp!==t){var s=a.updateOffset({elId:this.elementId,timestamp:t}),o=n.offset?n.offset.o:s.o;if(null!=o){var r=n.anchorPoint,l=n.connectorPaintStyle;if(null==r){var c=n.dimensions||s.s,d={xy:[o.left,o.top],wh:c,element:this,timestamp:t};if(e&&this.anchor.isDynamic&&this.connections.length>0){var h=i(this,n.elementWithPrecedence),u=h.endpoints[0]==this?1:0,p=0===u?h.sourceId:h.targetId,m=a.getCachedData(p),g=m.o,f=m.s;d.txy=[g.left,g.top],d.twh=f,d.tElement=h.endpoints[u]}r=this.anchor.compute(d)}this.endpoint.compute(r,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,l||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=t;for(var b=0;b<this._jsPlumb.overlays.length;b++){var v=this._jsPlumb.overlays[b];v.isVisible()&&(this._jsPlumb.overlayPlacements[b]=v.draw(this.endpoint,this._jsPlumb.paintStyleInUse),v.paint(this._jsPlumb.overlayPlacements[b]))}}}},this.repaint=this.paint;var E=!1;this.initDraggable=function(){if(!E&&l.isDragSupported(this.element)){var s={id:null,element:null},i=null,o=!1,d=null,m=n(s,a),g=function(){i=this.connectorSelector();var n=!0;if(this.isEnabled()||(n=!1),null!=i||this.isSource||(n=!1),this.isSource&&this.isFull()&&!this.dragAllowedWhenFull&&(n=!1),null==i||i.isDetachable()||(n=!1),n===!1)return l.stopDrag&&l.stopDrag(),m.stopDrag(),!1;for(var g=0;g<this.connections.length;g++)this.connections[g].setHover(!1);this.addClass("endpointDrag"),a.setConnectionBeingDragged(!0),i&&!this.isFull()&&this.isSource&&(i=null),a.updateOffset({elId:this.elementId}),b=this.makeInPlaceCopy(),b.referenceEndpoint=this,b.paint(),t(s,this.parent,a);var v=c(b.canvas),C=jsPlumb.CurrentLibrary.getOffset(v,a),P=a.adjustForParentOffsetAndScroll([C.left,C.top],b.canvas),E=c(this.canvas);if(l.setOffset(s.element,{left:P[0],top:P[1]}),this.parentAnchor&&(this.anchor=a.makeAnchor(this.parentAnchor,this.elementId,a)),a.setAttribute(this.canvas,"dragId",s.id),a.setAttribute(this.canvas,"elId",this.elementId),this._jsPlumb.floatingEndpoint=e(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,s.element,a,p),this.canvas.style.visibility="hidden",null==i)this.anchor.locked=!0,this.setHover(!1,!1),i=u({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:s.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:r.connectorStyle,hoverPaintStyle:r.connectorHoverStyle,connector:r.connector,overlays:r.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass}),i.pending=!0,i.addClass(a.draggingClass),this._jsPlumb.floatingEndpoint.addClass(a.draggingClass),a.fire("connectionDrag",i);else{o=!0,i.setHover(!1),j(v,!1,!0);var y=i.endpoints[0].id==this.id?0:1;i.floatingAnchorIndex=y,this.detachFromConnection(i);var D=jsPlumb.CurrentLibrary.getDragScope(E);a.setAttribute(this.canvas,"originalScope",D);var I=l.getDropScope(E);l.setDragScope(E,I),a.fire("connectionDrag",i),0===y?(d=[i.source,i.sourceId,E,D],i.source=s.element,i.sourceId=s.id):(d=[i.target,i.targetId,E,D],i.target=s.element,i.targetId=s.id),i.endpoints[0===y?1:0].anchor.locked=!0,i.suspendedEndpoint=i.endpoints[y],i.suspendedElement=i.endpoints[y].getElement(),i.suspendedElementId=i.endpoints[y].elementId,i.suspendedElementType=0===y?"source":"target",i.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=i.suspendedEndpoint,i.endpoints[y]=this._jsPlumb.floatingEndpoint,i.addClass(a.draggingClass),this._jsPlumb.floatingEndpoint.addClass(a.draggingClass)}f[s.id]=i,a.anchorManager.addFloatingConnection(s.id,i),h.addToList(r.endpointsByElement,s.id,this._jsPlumb.floatingEndpoint),a.currentlyDragging=!0}.bind(this),v=r.dragOptions||{},C=jsPlumb.extend({},l.defaultDragOptions),P=l.dragEvents.start,y=l.dragEvents.stop,D=l.dragEvents.drag;v=jsPlumb.extend(C,v),v.scope=v.scope||this.scope,v[P]=h.wrap(v[P],g,!1),v[D]=h.wrap(v[D],m.drag),v[y]=h.wrap(v[y],function(){if(a.setConnectionBeingDragged(!1),null!=i.endpoints){var n=l.getDropEvent(arguments),t=null==i.floatingAnchorIndex?1:i.floatingAnchorIndex;i.endpoints[0===t?1:0].anchor.locked=!1,i.removeClass(a.draggingClass),i.endpoints[t]==this._jsPlumb.floatingEndpoint&&o&&i.suspendedEndpoint&&(0===t?(i.source=d[0],i.sourceId=d[1]):(i.target=d[0],i.targetId=d[1]),l.setDragScope(d[2],d[3]),i.endpoints[t]=i.suspendedEndpoint,(i.isReattach()||i._forceReattach||i._forceDetach||!i.endpoints[0===t?1:0].detach(i,!1,!1,!0,n))&&(i.setHover(!1),i.floatingAnchorIndex=null,i._forceDetach=null,i._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(i),i.suspendedEndpoint.addConnection(i),a.repaint(d[1])))}a.remove(s.element,!1),a.remove(b.canvas,!1),this.deleteAfterDragStop?a.deleteObject({endpoint:this}):this._jsPlumb&&(this._jsPlumb.floatingEndpoint=null,this.canvas.style.visibility="visible",this.anchor.locked=!1,this.paint({recalc:!1})),a.fire("connectionDragStop",i,n),a.currentlyDragging=!1,i=null}.bind(this));var I=c(this.canvas);l.initDraggable(I,v,!0,a),E=!0}},(this.isSource||this.isTarget)&&this.initDraggable();var j=function(n,t,e,s){if((this.isTarget||t)&&l.isDropSupported(this.element)){var i=r.dropOptions||a.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;i=jsPlumb.extend({},i),i.scope=i.scope||this.scope;var o=l.dragEvents.drop,d=l.dragEvents.over,u=l.dragEvents.out,p=function(){this.removeClass(a.endpointDropAllowedClass),this.removeClass(a.endpointDropForbiddenClass);var n=l.getDropEvent(arguments),t=c(l.getDragObject(arguments)),e=a.getAttribute(t,"dragId"),i=(a.getAttribute(t,"elId"),a.getAttribute(t,"originalScope")),o=f[e],r=o.suspendedEndpoint&&(o.suspendedEndpoint.id==this.id||this.referenceEndpoint&&o.suspendedEndpoint.id==this.referenceEndpoint.id);if(r)return void(o._forceReattach=!0);if(null!=o){var d=null==o.floatingAnchorIndex?1:o.floatingAnchorIndex;i&&jsPlumb.CurrentLibrary.setDragScope(t,i);var h=null!=s?s.isEnabled():!0;if(this.isFull()&&this.fire("maxConnections",{endpoint:this,connection:o,maxConnections:this._jsPlumb.maxConnections},n),!this.isFull()&&(0!==d||this.isSource)&&(1!=d||this.isTarget)&&h){var u=!0;o.suspendedEndpoint&&o.suspendedEndpoint.id!=this.id&&(0===d?(o.source=o.suspendedEndpoint.element,o.sourceId=o.suspendedEndpoint.elementId):(o.target=o.suspendedEndpoint.element,o.targetId=o.suspendedEndpoint.elementId),o.isDetachAllowed(o)&&o.endpoints[d].isDetachAllowed(o)&&o.suspendedEndpoint.isDetachAllowed(o)&&a.checkCondition("beforeDetach",o)||(u=!1)),0===d?(o.source=this.element,o.sourceId=this.elementId):(o.target=this.element,o.targetId=this.elementId);var p=function(){o.floatingAnchorIndex=null},b=function(){o.pending=!1,o.endpoints[d].detachFromConnection(o),o.suspendedEndpoint&&o.suspendedEndpoint.detachFromConnection(o),o.endpoints[d]=this,this.addConnection(o);var t=this.getParameters();for(var e in t)o.setParameter(e,t[e]);if(o.suspendedEndpoint){var s=(o.suspendedEndpoint.getElement(),o.suspendedEndpoint.elementId);g({index:d,originalSourceId:0===d?s:o.sourceId,newSourceId:0===d?this.elementId:o.sourceId,originalTargetId:1==d?s:o.targetId,newTargetId:1==d?this.elementId:o.targetId,originalSourceEndpoint:0===d?o.suspendedEndpoint:o.endpoints[0],newSourceEndpoint:0===d?this:o.endpoints[0],originalTargetEndpoint:1==d?o.suspendedEndpoint:o.endpoints[1],newTargetEndpoint:1==d?this:o.endpoints[1],connection:o},n)}else t.draggable&&jsPlumb.CurrentLibrary.initDraggable(this.element,dragOptions,!0,a);1==d?a.anchorManager.updateOtherEndpoint(o.sourceId,o.suspendedElementId,o.targetId,o):a.anchorManager.sourceChanged(o.suspendedEndpoint.elementId,o.sourceId,o),m(o,null,n),p()}.bind(this),v=function(){o.suspendedEndpoint&&(o.endpoints[d]=o.suspendedEndpoint,o.setHover(!1),o._forceDetach=!0,0===d?(o.source=o.suspendedEndpoint.element,o.sourceId=o.suspendedEndpoint.elementId):(o.target=o.suspendedEndpoint.element,o.targetId=o.suspendedEndpoint.elementId),o.suspendedEndpoint.addConnection(o),o.endpoints[0].repaint(),o.repaint(),a.repaint(o.sourceId),o._forceDetach=!1),p()};u=u&&this.isDropAllowed(o.sourceId,o.targetId,o.scope,o,this),u?b():v()}a.currentlyDragging=!1}}.bind(this);i[o]=h.wrap(i[o],p),i[d]=h.wrap(i[d],function(){var n=l.getDragObject(arguments),t=a.getAttribute(n,"dragId"),e=f[t];if(null!=e){var s=null==e.floatingAnchorIndex?1:e.floatingAnchorIndex,i=this.isTarget&&0!==e.floatingAnchorIndex||e.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==e.suspendedEndpoint.id;if(i){var o=a.checkCondition("checkDropAllowed",{sourceEndpoint:e.endpoints[s],targetEndpoint:this,connection:e});this[(o?"add":"remove")+"Class"](a.endpointDropAllowedClass),this[(o?"remove":"add")+"Class"](a.endpointDropForbiddenClass),e.endpoints[s].anchor.over(this.anchor,this)}}}.bind(this)),i[u]=h.wrap(i[u],function(){var n=l.getDragObject(arguments),t=a.getAttribute(n,"dragId"),e=f[t];if(null!=e){var s=null==e.floatingAnchorIndex?1:e.floatingAnchorIndex,i=this.isTarget&&0!==e.floatingAnchorIndex||e.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==e.suspendedEndpoint.id;i&&(this.removeClass(a.endpointDropAllowedClass),this.removeClass(a.endpointDropForbiddenClass),e.endpoints[s].anchor.out())}}.bind(this)),l.initDroppable(n,i,!0,e)}}.bind(this);return j(c(this.canvas),!0,!(r._transient||this.anchor.isFloating),this),r.type&&this.addType(r.type,r.data,a.isSuspendDrawing()),this},jsPlumbUtil.extend(jsPlumb.Endpoint,OverlayCapableJsPlumbUIComponent,{getTypeDescriptor:function(){return"endpoint"},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n,t,e){if(this._jsPlumb.visible=n,this.canvas&&(this.canvas.style.display=n?"block":"none"),this[n?"showOverlays":"hideOverlays"](),!t)for(var s=0;s<this.connections.length;s++)if(this.connections[s].setVisible(n),!e){var i=this===this.connections[s].endpoints[0]?1:0;1==this.connections[s].endpoints[i].connections.length&&this.connections[s].endpoints[i].setVisible(n,!0,!0)}},getAttachedElements:function(){return this.connections},applyType:function(n,t){null!=n.maxConnections&&(this._jsPlumb.maxConnections=n.maxConnections),n.scope&&(this.scope=n.scope),jsPlumbUtil.copyValues(s,n,this),n.anchor&&(this.anchor=this._jsPlumb.instance.makeAnchor(n.anchor))},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(n){this._jsPlumb.enabled=n},cleanup:function(){jsPlumb.CurrentLibrary.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.anchor=null,this.endpoint.cleanup(),this.endpoint.destroy(),this.endpoint=null;var n=jsPlumb.CurrentLibrary.getElementObject(this.canvas);jsPlumb.CurrentLibrary.destroyDraggable(n),jsPlumb.CurrentLibrary.destroyDroppable(n)},setHover:function(n){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(n)},isFull:function(){return!(this.isFloating()||this._jsPlumb.maxConnections<1||this.connections.length<this._jsPlumb.maxConnections)},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(n){this._jsPlumb.connectionCost=n},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(n){this._jsPlumb.connectionsDirected=n},setElementId:function(n){this.elementId=n,this.anchor.elementId=n},setReferenceElement:function(n){this.element=jsPlumb.CurrentLibrary.getDOMElement(n)},setDragAllowedWhenFull:function(n){this.dragAllowedWhenFull=n},equals:function(n){return this.anchor.equals(n.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(n){return this.anchor.compute(n)}})}();
/*connection*/
!function(){var t=function(t,e,n,s){if(!t.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[e][n])throw{msg:"jsPlumb: unknown connector type '"+n+"'"};return new jsPlumb.Connectors[e][n](s)},e=function(t,e,n){return t?n.makeAnchor(t,e,n):null},n=function(t,n,s,i,o,a,l,r,c,h){var u;if(i)s.endpoints[o]=i,i.addConnection(s);else{a.endpoints||(a.endpoints=[null,null]);var d=a.endpoints[o]||a.endpoint||t.Defaults.Endpoints[o]||jsPlumb.Defaults.Endpoints[o]||t.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;a.endpointStyles||(a.endpointStyles=[null,null]),a.endpointHoverStyles||(a.endpointHoverStyles=[null,null]);var m=a.endpointStyles[o]||a.endpointStyle||t.Defaults.EndpointStyles[o]||jsPlumb.Defaults.EndpointStyles[o]||t.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;null==m.fillStyle&&null!=c&&(m.fillStyle=c.strokeStyle),null==m.outlineColor&&null!=c&&(m.outlineColor=c.outlineColor),null==m.outlineWidth&&null!=c&&(m.outlineWidth=c.outlineWidth);var p=a.endpointHoverStyles[o]||a.endpointHoverStyle||t.Defaults.EndpointHoverStyles[o]||jsPlumb.Defaults.EndpointHoverStyles[o]||t.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;null!=h&&(null==p&&(p={}),null==p.fillStyle&&(p.fillStyle=h.strokeStyle));var b=a.anchors?a.anchors[o]:a.anchor?a.anchor:e(t.Defaults.Anchors[o],r,t)||e(jsPlumb.Defaults.Anchors[o],r,t)||e(t.Defaults.Anchor,r,t)||e(jsPlumb.Defaults.Anchor,r,t),P=a.uuids?a.uuids[o]:null;u=n({paintStyle:m,hoverPaintStyle:p,endpoint:d,connections:[s],uuid:P,anchor:b,source:l,scope:a.scope,container:a.container,reattach:a.reattach||t.Defaults.ReattachConnections,detachable:a.detachable||t.Defaults.ConnectionsDetachable}),s.endpoints[o]=u,a.drawEndpoints===!1&&u.setVisible(!1,!0,!0)}return u};jsPlumb.Connection=function(t){var e=(t.newConnection,t.newEndpoint),s=jsPlumb.CurrentLibrary,i=(s.getAttribute,s.getElementObject,s.getDOMElement),o=jsPlumbUtil;s.getOffset;this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.parent=t.parent,this.previousConnection=t.previousConnection,this.source=i(t.source),this.target=i(t.target),t.sourceEndpoint&&(this.source=t.sourceEndpoint.endpointWillMoveTo||t.sourceEndpoint.getElement()),t.targetEndpoint&&(this.target=t.targetEndpoint.getElement()),OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=t.scope,this.endpoints=[],this.endpointStyles=[];var a=this._jsPlumb.instance;this._jsPlumb.visible=!0,this._jsPlumb.editable=t.editable===!0,this._jsPlumb.params={parent:t.parent,cssClass:t.cssClass,container:t.container,"pointer-events":t["pointer-events"],editorParams:t.editorParams},this._jsPlumb.lastPaintedAt=null,this.getDefaultType=function(){return{parameters:{},scope:null,detachable:this._jsPlumb.instance.Defaults.ConnectionsDetachable,rettach:this._jsPlumb.instance.Defaults.ReattachConnections,paintStyle:this._jsPlumb.instance.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:this._jsPlumb.instance.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:this._jsPlumb.instance.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:this._jsPlumb.instance.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}};var l=n(a,e,this,t.sourceEndpoint,0,t,this.source,this.sourceId,t.paintStyle,t.hoverPaintStyle);l&&o.addToList(t.endpointsByElement,this.sourceId,l);var r=n(a,e,this,t.targetEndpoint,1,t,this.target,this.targetId,t.paintStyle,t.hoverPaintStyle);r&&o.addToList(t.endpointsByElement,this.targetId,r),this.scope||(this.scope=this.endpoints[0].scope),null!=t.deleteEndpointsOnDetach?(this.endpoints[0]._deleteOnDetach=t.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=t.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0)),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||a.Defaults.Connector||jsPlumb.Defaults.Connector,!0),t.path&&this.connector.setPath(t.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||a.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||a.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle();var c=a.getSuspendedAt();if(a.updateOffset({elId:this.sourceId,timestamp:c}),a.updateOffset({elId:this.targetId,timestamp:c}),!a.isSuspendDrawing()){var h=a.getCachedData(this.sourceId),u=h.o,d=h.s,m=a.getCachedData(this.targetId),p=m.o,b=m.s,P=c||a.timestamp(),j=this.endpoints[0].anchor.compute({xy:[u.left,u.top],wh:d,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[p.left,p.top],twh:b,tElement:this.endpoints[1],timestamp:P});this.endpoints[0].paint({anchorLoc:j,timestamp:P}),j=this.endpoints[1].anchor.compute({xy:[p.left,p.top],wh:b,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[u.left,u.top],twh:d,tElement:this.endpoints[0],timestamp:P}),this.endpoints[1].paint({anchorLoc:j,timestamp:P})}this._jsPlumb.detachable=a.Defaults.ConnectionsDetachable,t.detachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[0].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[1].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this._jsPlumb.reattach=t.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||a.Defaults.ReattachConnections,this._jsPlumb.cost=t.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=t.directed,null==t.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var v=jsPlumb.extend({},this.endpoints[1].getParameters());jsPlumb.extend(v,this.endpoints[0].getParameters()),jsPlumb.extend(v,this.getParameters()),this.setParameters(v);var y=[t.type,this.endpoints[0].connectionType,this.endpoints[1].connectionType].join(" ");/[a-zA-Z]/.test(y)&&this.addType(y,t.data,!0)},jsPlumbUtil.extend(jsPlumb.Connection,OverlayCapableJsPlumbUIComponent,{applyType:function(t,e){null!=t.detachable&&this.setDetachable(t.detachable),null!=t.reattach&&this.setReattach(t.reattach),t.scope&&(this.scope=t.scope),this.setConnector(t.connector,e)},getTypeDescriptor:function(){return"connection"},getAttachedElements:function(){return this.endpoints},addClass:function(t,e){e&&(this.endpoints[0].addClass(t),this.endpoints[1].addClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(t)),this.connector&&this.connector.addClass(t)},removeClass:function(t,e){e&&(this.endpoints[0].removeClass(t),this.endpoints[1].removeClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(t)),this.connector&&this.connector.removeClass(t)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(t){this._jsPlumb.visible=t,this.connector&&this.connector.setVisible(t),this.repaint()},cleanup:function(){this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(),this.connector.destroy()),this.connector=null},isDetachable:function(){return this._jsPlumb.detachable===!0},setDetachable:function(t){this._jsPlumb.detachable=t===!0},isReattach:function(){return this._jsPlumb.reattach===!0},setReattach:function(t){this._jsPlumb.reattach=t===!0},setHover:function(t){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(t),jsPlumb.CurrentLibrary[t?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),jsPlumb.CurrentLibrary[t?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getCost:function(){return this._jsPlumb.cost},setCost:function(t){this._jsPlumb.cost=t},isDirected:function(){return this._jsPlumb.directed===!0},moveParent:function(t){var e=jsPlumb.CurrentLibrary;e.getParent(this.connector.canvas);this.connector.bgCanvas&&(e.removeElement(this.connector.bgCanvas),e.appendElement(this.connector.bgCanvas,t)),e.removeElement(this.connector.canvas),e.appendElement(this.connector.canvas,t);for(var n=0;n<this._jsPlumb.overlays.length;n++)this._jsPlumb.overlays[n].isAppendedAtTopLevel&&(e.removeElement(this._jsPlumb.overlays[n].canvas),e.appendElement(this._jsPlumb.overlays[n].canvas,t),this._jsPlumb.overlays[n].reattachListeners&&this._jsPlumb.overlays[n].reattachListeners(this.connector));this.connector.reattachListeners&&this.connector.reattachListeners()},getConnector:function(){return this.connector},setConnector:function(e,n){var s=jsPlumbUtil;null!=this.connector&&(this.connector.cleanup(),this.connector.destroy());var i={_jsPlumb:this._jsPlumb.instance,parent:this._jsPlumb.params.parent,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},o=this._jsPlumb.instance.getRenderMode();s.isString(e)?this.connector=t(this._jsPlumb.instance,o,e,i):s.isArray(e)&&(1==e.length?this.connector=t(this._jsPlumb.instance,o,e[0],i):this.connector=t(this._jsPlumb.instance,o,e[0],s.merge(e[1],i))),this.bindListeners(this.connector,this,function(t){this.setHover(t,!1)}.bind(this)),this.canvas=this.connector.canvas,this._jsPlumb.editable&&null!=jsPlumb.ConnectorEditors&&jsPlumb.ConnectorEditors[this.connector.type]&&this.connector.isEditable()?new jsPlumb.ConnectorEditors[this.connector.type]({connector:this.connector,connection:this,params:this._jsPlumb.params.editorParams||{}}):this._jsPlumb.editable=!1,n||this.repaint()},paint:function(t){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){t=t||{};var e=(t.elId,t.ui),n=t.recalc,s=t.timestamp,i=!1,o=i?this.sourceId:this.targetId,a=i?this.targetId:this.sourceId,l=i?0:1,r=i?1:0;if(null==s||s!=this._jsPlumb.lastPaintedAt){var c=this._jsPlumb.instance.updateOffset({elId:a,offset:e,recalc:n,timestamp:s}).o,h=this._jsPlumb.instance.updateOffset({elId:o,timestamp:s}).o,u=this.endpoints[r],d=this.endpoints[l];t.clearEdits&&(this._jsPlumb.overlayPositions=null,u.anchor.clearUserDefinedLocation(),d.anchor.clearUserDefinedLocation(),this.connector.setEdited(!1));var m=u.anchor.getCurrentLocation({xy:[c.left,c.top],wh:[c.width,c.height],element:u,timestamp:s}),p=d.anchor.getCurrentLocation({xy:[h.left,h.top],wh:[h.width,h.height],element:d,timestamp:s});this.connector.resetBounds(),this.connector.compute({sourcePos:m,targetPos:p,sourceEndpoint:this.endpoints[r],targetEndpoint:this.endpoints[l],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:c,targetInfo:h,clearEdits:t.clearEdits===!0});for(var b={minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)},P=0;P<this._jsPlumb.overlays.length;P++){var j=this._jsPlumb.overlays[P];j.isVisible()&&(this._jsPlumb.overlayPlacements[P]=j.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(j)),b.minX=Math.min(b.minX,this._jsPlumb.overlayPlacements[P].minX),b.maxX=Math.max(b.maxX,this._jsPlumb.overlayPlacements[P].maxX),b.minY=Math.min(b.minY,this._jsPlumb.overlayPlacements[P].minY),b.maxY=Math.max(b.maxY,this._jsPlumb.overlayPlacements[P].maxY))}var v=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,y=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),f={xmin:Math.min(this.connector.bounds.minX-(v+y),b.minX),ymin:Math.min(this.connector.bounds.minY-(v+y),b.minY),xmax:Math.max(this.connector.bounds.maxX+(v+y),b.maxX),ymax:Math.max(this.connector.bounds.maxY+(v+y),b.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,f);for(var _=0;_<this._jsPlumb.overlays.length;_++){var C=this._jsPlumb.overlays[_];C.isVisible()&&C.paint(this._jsPlumb.overlayPlacements[_],f)}}this._jsPlumb.lastPaintedAt=s}},repaint:function(t){t=t||{},this.paint({elId:this.sourceId,recalc:!(t.recalc===!1),timestamp:t.timestamp,clearEdits:t.clearEdits})}})}();
/*anchors*/
!function(){jsPlumb.AnchorManager=function(t){var n={},e={},o={},i={},r={},s={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},u={},c=this,a={},l=t.jsPlumbInstance,h=jsPlumb.CurrentLibrary,f={},d=function(t,n,e,o,i,r){if(t===n)return{orientation:s.IDENTITY,a:["top","top"]};var u=Math.atan2(o.centery-e.centery,o.centerx-e.centerx),c=Math.atan2(e.centery-o.centery,e.centerx-o.centerx),a=e.left<=o.left&&e.right>=o.left||e.left<=o.right&&e.right>=o.right||e.left<=o.left&&e.right>=o.right||o.left<=e.left&&o.right>=e.right,l=e.top<=o.top&&e.bottom>=o.top||e.top<=o.bottom&&e.bottom>=o.bottom||e.top<=o.top&&e.bottom>=o.bottom||o.top<=e.top&&o.bottom>=e.bottom,h=function(t){return[i.isContinuous?i.verifyEdge(t[0]):t[0],r.isContinuous?r.verifyEdge(t[1]):t[1]]},f={orientation:s.DIAGONAL,theta:u,theta2:c};return a||l?a?(f.orientation=s.HORIZONTAL,f.a=e.top<o.top?["bottom","top"]:["top","bottom"]):(f.orientation=s.VERTICAL,f.a=e.left<o.left?["right","left"]:["left","right"]):o.left>e.left&&o.top>e.top?f.a=["right","top"]:o.left>e.left&&e.top>o.top?f.a=["top","left"]:o.left<e.left&&o.top<e.top?f.a=["top","right"]:o.left<e.left&&o.top>e.top&&(f.a=["left","top"]),f.a=h(f.a),f},m=function(t,n,e,o,i,r,s){for(var u=[],c=n[i?0:1]/(o.length+1),a=0;a<o.length;a++){var l=(a+1)*c,h=r*n[i?1:0];s&&(l=n[i?0:1]-l);var f=i?l:h,d=e[0]+f,m=f/n[0],p=i?h:l,g=e[1]+p,b=p/n[1];u.push([d,g,m,b,o[a][1],o[a][2]])}return u},p=function(t){return function(n,e){var o=!0;return o=t?n[0][0]<e[0][0]:n[0][0]>e[0][0],o===!1?-1:1}},g=function(t,n){var e=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0],o=n[0][0]<0?-Math.PI-n[0][0]:Math.PI-n[0][0];return e>o?1:t[0][1]>n[0][1]?1:-1},b={top:function(t,n){return t[0]>n[0]?1:-1},right:p(!0),bottom:p(!0),left:g},P=function(t,n){return t.sort(n)},v=function(t,n){var e=l.getCachedData(t),i=e.s,s=e.o,u=function(n,e,i,s,u,c,a){if(s.length>0)for(var h=P(s,b[n]),f="right"===n||"top"===n,d=m(n,e,i,h,u,c,f),p=function(t,n){var e=l.adjustForParentOffsetAndScroll([n[0],n[1]],t.canvas);o[t.id]=[e[0],e[1],n[2],n[3]],r[t.id]=a},g=0;g<d.length;g++){var v=d[g][4],j=v.endpoints[0].elementId===t,I=v.endpoints[1].elementId===t;j?p(v.endpoints[0],d[g]):I&&p(v.endpoints[1],d[g])}};u("bottom",i,[s.left,s.top],n.bottom,!0,1,[0,1]),u("top",i,[s.left,s.top],n.top,!0,0,[0,-1]),u("left",i,[s.left,s.top],n.left,!1,0,[-1,0]),u("right",i,[s.left,s.top],n.right,!1,1,[1,0])};this.reset=function(){n={},u={},a={}},this.addFloatingConnection=function(t,n){f[t]=n},this.removeFloatingConnection=function(t){delete f[t]},this.newConnection=function(t){var n=t.sourceId,e=t.targetId,o=t.endpoints,i=!0,r=function(t,r,s,c,a){n==e&&s.isContinuous&&(h.removeElement(o[1].canvas),i=!1),jsPlumbUtil.addToList(u,c,[a,r,s.constructor==jsPlumb.DynamicAnchor])};r(0,o[0],o[0].anchor,e,t),i&&r(1,o[1],o[1].anchor,n,t)};var j=function(t){!function(t,n){if(t){var e=function(t){return t[4]==n};jsPlumbUtil.removeWithFunction(t.top,e),jsPlumbUtil.removeWithFunction(t.left,e),jsPlumbUtil.removeWithFunction(t.bottom,e),jsPlumbUtil.removeWithFunction(t.right,e)}}(a[t.elementId],t.id)};this.connectionDetached=function(t){var n=t.connection||t,e=t.sourceId,o=t.targetId,i=n.endpoints,r=function(t,n,e,o,i){null!=e&&e.constructor==jsPlumb.FloatingAnchor||jsPlumbUtil.removeWithFunction(u[o],function(t){return t[0].id==i.id})};r(1,i[1],i[1].anchor,e,n),r(0,i[0],i[0].anchor,o,n),j(n.endpoints[0]),j(n.endpoints[1]),c.redraw(n.sourceId),c.redraw(n.targetId)},this.add=function(t,e){jsPlumbUtil.addToList(n,e,t)},this.changeId=function(t,e){u[e]=u[t],n[e]=n[t],delete u[t],delete n[t]},this.getConnectionsFor=function(t){return u[t]||[]},this.getEndpointsFor=function(t){return n[t]||[]},this.deleteEndpoint=function(t){jsPlumbUtil.removeWithFunction(n[t.elementId],function(n){return n.id==t.id}),j(t)},this.clearFor=function(t){delete n[t],n[t]=[]};var I=function(n,e,o,i,r,s,u,c,a,l,h,f){var d=-1,m=-1,p=i.endpoints[u],g=p.id,b=[1,0][u],P=[[e,o],i,r,s,g],v=n[a],j=p._continuousAnchorEdge?n[p._continuousAnchorEdge]:null;if(j){var I=jsPlumbUtil.findWithFunction(j,function(t){return t[4]==g});if(-1!=I){j.splice(I,1);for(var A=0;A<j.length;A++)jsPlumbUtil.addWithFunction(h,j[A][1],function(t){return t.id==j[A][1].id}),jsPlumbUtil.addWithFunction(f,j[A][1].endpoints[u],function(t){return t.id==j[A][1].endpoints[u].id}),jsPlumbUtil.addWithFunction(f,j[A][1].endpoints[b],function(t){return t.id==j[A][1].endpoints[b].id})}}for(A=0;A<v.length;A++)1==t.idx&&v[A][3]===s&&-1==m&&(m=A),jsPlumbUtil.addWithFunction(h,v[A][1],function(t){return t.id==v[A][1].id}),jsPlumbUtil.addWithFunction(f,v[A][1].endpoints[u],function(t){return t.id==v[A][1].endpoints[u].id}),jsPlumbUtil.addWithFunction(f,v[A][1].endpoints[b],function(t){return t.id==v[A][1].endpoints[b].id});if(-1!=d)v[d]=P;else{var C=c?-1!=m?m:0:v.length;v.splice(C,0,P)}p._continuousAnchorEdge=a};this.updateOtherEndpoint=function(t,n,e,o){var i=jsPlumbUtil.findWithFunction(u[t],function(t){return t[0].id===o.id}),r=jsPlumbUtil.findWithFunction(u[n],function(t){return t[0].id===o.id});-1!=i&&(u[t][i][0]=o,u[t][i][1]=o.endpoints[1],u[t][i][2]=o.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor),r>-1&&(u[n].splice(r,1),jsPlumbUtil.addToList(u,e,[o,o.endpoints[0],o.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor]))},this.sourceChanged=function(t,n,e){jsPlumbUtil.removeWithFunction(u[t],function(t){return t[0].id===e.id});var o=jsPlumbUtil.findWithFunction(u[e.targetId],function(t){return t[0].id===e.id});o>-1&&(u[e.targetId][o][0]=e,u[e.targetId][o][1]=e.endpoints[0],u[e.targetId][o][2]=e.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor),jsPlumbUtil.addToList(u,n,[e,e.endpoints[1],e.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor])},this.rehomeEndpoint=function(t,e,o){var i=n[e]||[],r=l.getId(o);if(r!==e){var s=jsPlumbUtil.indexOf(i,t);if(s>-1){var u=i.splice(s,1)[0];c.add(u,r)}}for(var a=0;a<t.connections.length;a++)t.connections[a].sourceId==e?(t.connections[a].sourceId=t.elementId,t.connections[a].source=t.element,c.sourceChanged(e,t.elementId,t.connections[a])):t.connections[a].targetId==e&&(t.connections[a].targetId=t.elementId,t.connections[a].target=t.element,c.updateOtherEndpoint(t.connections[a].sourceId,e,t.elementId,t.connections[a]))},this.redraw=function(t,e,o,i,r,s){if(!l.isSuspendDrawing()){var c=n[t]||[],h=u[t]||[],m=[],p=[],g=[];o=o||l.timestamp(),i=i||{left:0,top:0},e&&(e={left:e.left+i.left,top:e.top+i.top});for(var b=l.updateOffset({elId:t,offset:e,recalc:!1,timestamp:o}),P={},j=0;j<h.length;j++){var A=h[j][0],C=A.sourceId,y=A.targetId,D=A.endpoints[0].anchor.isContinuous,U=A.endpoints[1].anchor.isContinuous;if(D||U){var F=C+"_"+y,L=P[F],M=A.sourceId==t?1:0;D&&!a[C]&&(a[C]={top:[],right:[],bottom:[],left:[]}),U&&!a[y]&&(a[y]={top:[],right:[],bottom:[],left:[]}),t!=y&&l.updateOffset({elId:y,timestamp:o}),t!=C&&l.updateOffset({elId:C,timestamp:o});var W=l.getCachedData(y),O=l.getCachedData(C);y==C&&(D||U)?I(a[C],-Math.PI/2,0,A,!1,y,0,!1,"top",C,m,p):(L||(L=d(C,y,O.o,W.o,A.endpoints[0].anchor,A.endpoints[1].anchor),P[F]=L),D&&I(a[C],L.theta,0,A,!1,y,0,!1,L.a[0],C,m,p),U&&I(a[y],L.theta2,-1,A,!0,C,1,!0,L.a[1],y,m,p)),D&&jsPlumbUtil.addWithFunction(g,C,function(t){return t===C}),U&&jsPlumbUtil.addWithFunction(g,y,function(t){return t===y}),jsPlumbUtil.addWithFunction(m,A,function(t){return t.id==A.id}),(D&&0===M||U&&1===M)&&jsPlumbUtil.addWithFunction(p,A.endpoints[M],function(t){return t.id==A.endpoints[M].id})}}for(j=0;j<c.length;j++)0===c[j].connections.length&&c[j].anchor.isContinuous&&(a[t]||(a[t]={top:[],right:[],bottom:[],left:[]}),I(a[t],-Math.PI/2,0,{endpoints:[c[j],c[j]],paint:function(){}},!1,t,0,!1,"top",t,m,p),jsPlumbUtil.addWithFunction(g,t,function(n){return n===t}));for(j=0;j<g.length;j++)v(g[j],a[g[j]]);for(j=0;j<c.length;j++)c[j].paint({timestamp:o,offset:b,dimensions:b.s,recalc:s!==!0});for(j=0;j<p.length;j++){var x=l.getCachedData(p[j].elementId);p[j].paint({timestamp:o,offset:x,dimensions:x.s})}for(j=0;j<h.length;j++){var E=h[j][1];if(E.anchor.constructor==jsPlumb.DynamicAnchor){E.paint({elementWithPrecedence:t,timestamp:o}),jsPlumbUtil.addWithFunction(m,h[j][0],function(t){return t.id==h[j][0].id});for(var w=0;w<E.connections.length;w++)E.connections[w]!==h[j][0]&&jsPlumbUtil.addWithFunction(m,E.connections[w],function(t){return t.id==E.connections[w].id})}else E.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(m,h[j][0],function(t){return t.id==h[j][0].id})}var R=f[t];for(R&&R.paint({timestamp:o,recalc:!1,elId:t}),j=0;j<m.length;j++){var T=o;m[j].paint({elId:t,timestamp:T,recalc:!1,clearEdits:r})}}};var A=function(t){jsPlumbUtil.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var n=t.faces||["top","right","bottom","left"],e=!(t.clockwise===!1),s={},u={top:"bottom",right:"left",left:"right",bottom:"top"},c={top:"right",right:"bottom",left:"top",bottom:"left"},a={top:"left",right:"top",left:"bottom",bottom:"right"},l=e?c:a,h=e?a:c,f=t.cssClass||"",d=0;d<n.length;d++)s[n[d]]=!0;this.verifyEdge=function(t){return s[t]?t:s[u[t]]?u[t]:s[l[t]]?l[t]:s[h[t]]?h[t]:t},this.compute=function(t){return i[t.element.id]||o[t.element.id]||[0,0]},this.getCurrentLocation=function(t){return i[t.element.id]||o[t.element.id]||[0,0]},this.getOrientation=function(t){return r[t.id]||[0,0]},this.clearUserDefinedLocation=function(){delete i[t.elementId]},this.setUserDefinedLocation=function(n){i[t.elementId]=n},this.getCssClass=function(){return f},this.setCssClass=function(t){f=t}};l.continuousAnchorFactory={get:function(t){var n=e[t.elementId];return n||(n=new A(t),e[t.elementId]=n),n},clear:function(t){delete e[t]}}},jsPlumb.Anchor=function(t){this.x=t.x||0,this.y=t.y||0,this.elementId=t.elementId,this.cssClass=t.cssClass||"",this.userDefinedLocation=null,this.orientation=t.orientation||[0,0],jsPlumbUtil.EventGenerator.apply(this);var n=t.jsPlumbInstance;this.lastReturnValue=null,this.offsets=t.offsets||[0,0],this.timestamp=null,this.compute=function(t){var e=t.xy,o=t.wh,i=t.element,r=t.timestamp;return t.clearUserDefinedLocation&&(this.userDefinedLocation=null),r&&r===self.timestamp?this.lastReturnValue:(null!=this.userDefinedLocation?this.lastReturnValue=this.userDefinedLocation:(this.lastReturnValue=[e[0]+this.x*o[0]+this.offsets[0],e[1]+this.y*o[1]+this.offsets[1]],this.lastReturnValue=n.adjustForParentOffsetAndScroll(this.lastReturnValue,i.canvas)),this.timestamp=r,this.lastReturnValue)},this.getCurrentLocation=function(t){return null==this.lastReturnValue||null!=t.timestamp&&this.timestamp!=t.timestamp?this.compute(t):this.lastReturnValue}},jsPlumbUtil.extend(jsPlumb.Anchor,jsPlumbUtil.EventGenerator,{equals:function(t){if(!t)return!1;var n=t.getOrientation(),e=this.getOrientation();return this.x==t.x&&this.y==t.y&&this.offsets[0]==t.offsets[0]&&this.offsets[1]==t.offsets[1]&&e[0]==n[0]&&e[1]==n[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(t){this.userDefinedLocation=t},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(t){return this.orientation},getCssClass:function(){return this.cssClass}}),jsPlumb.FloatingAnchor=function(t){jsPlumb.Anchor.apply(this,arguments);var n=t.reference,e=jsPlumb.CurrentLibrary,o=t.jsPlumbInstance,i=t.referenceCanvas,r=e.getSize(e.getElementObject(i)),s=0,u=0,c=null,a=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var n=t.xy,e=t.element,i=[n[0]+r[0]/2,n[1]+r[1]/2];return i=o.adjustForParentOffsetAndScroll(i,e.canvas),a=i,i},this.getOrientation=function(t){if(c)return c;var e=n.getOrientation(t);return[Math.abs(e[0])*s*-1,Math.abs(e[1])*u*-1]},this.over=function(t,n){c=t.getOrientation(n)},this.out=function(){c=null},this.getCurrentLocation=function(t){return null==a?this.compute(t):a}},jsPlumbUtil.extend(jsPlumb.FloatingAnchor,jsPlumb.Anchor);var t=function(t,n,e){return t.constructor==jsPlumb.Anchor?t:n.makeAnchor(t,e,n)};jsPlumb.DynamicAnchor=function(n){jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0,this.anchors=[],this.elementId=n.elementId,this.jsPlumbInstance=n.jsPlumbInstance;for(var e=0;e<n.anchors.length;e++)this.anchors[e]=t(n.anchors[e],this.jsPlumbInstance,this.elementId);this.addAnchor=function(n){this.anchors.push(t(n,this.jsPlumbInstance,this.elementId))},this.getAnchors=function(){return this.anchors},this.locked=!1;var o=this.anchors.length>0?this.anchors[0]:null,i=(this.anchors.length>0?0:-1,o),r=this,s=function(t,n,e,o,i){var r=o[0]+t.x*i[0],s=o[1]+t.y*i[1],u=o[0]+i[0]/2,c=o[1]+i[1]/2;return Math.sqrt(Math.pow(n-r,2)+Math.pow(e-s,2))+Math.sqrt(Math.pow(u-r,2)+Math.pow(c-s,2))},u=n.selector||function(t,n,e,o,i){for(var r=e[0]+o[0]/2,u=e[1]+o[1]/2,c=-1,a=1/0,l=0;l<i.length;l++){var h=s(i[l],r,u,t,n);a>h&&(c=l+0,a=h)}return i[c]};this.compute=function(t){var n=t.xy,e=t.wh,s=t.timestamp,c=t.txy,a=t.twh;t.clearUserDefinedLocation&&(userDefinedLocation=null),this.timestamp=s;var l=r.getUserDefinedLocation();return null!=l?l:this.locked||null==c||null==a?o.compute(t):(t.timestamp=null,o=u(n,e,c,a,this.anchors),this.x=o.x,this.y=o.y,o!=i&&this.fire("anchorChanged",o),i=o,o.compute(t))},this.getCurrentLocation=function(t){return this.getUserDefinedLocation()||(null!=o?o.getCurrentLocation(t):null)},this.getOrientation=function(t){return null!=o?o.getOrientation(t):[0,0]},this.over=function(t,n){null!=o&&o.over(t,n)},this.out=function(){null!=o&&o.out()},this.getCssClass=function(){return o&&o.getCssClass()||""}},jsPlumbUtil.extend(jsPlumb.DynamicAnchor,jsPlumb.Anchor);var n=function(t,n,e,o,i,r){jsPlumb.Anchors[i]=function(s){var u=s.jsPlumbInstance.makeAnchor([t,n,e,o,0,0],s.elementId,s.jsPlumbInstance);return u.type=i,r&&r(u,s),u}};n(.5,0,0,-1,"TopCenter"),n(.5,1,0,1,"BottomCenter"),n(0,.5,-1,0,"LeftMiddle"),n(1,.5,1,0,"RightMiddle"),n(.5,0,0,-1,"Top"),n(.5,1,0,1,"Bottom"),n(0,.5,-1,0,"Left"),n(1,.5,1,0,"Right"),n(.5,.5,0,0,"Center"),n(1,0,0,-1,"TopRight"),n(1,1,0,1,"BottomRight"),n(0,0,0,-1,"TopLeft"),n(0,1,0,1,"BottomLeft"),jsPlumb.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},jsPlumb.Anchors.AutoDefault=function(t){var n=t.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(t));return n.type="AutoDefault",n};var e=function(t,n){jsPlumb.Anchors[t]=function(e){var o=e.jsPlumbInstance.makeAnchor(["Continuous",{faces:n}],e.elementId,e.jsPlumbInstance);return o.type=t,o}};jsPlumb.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},e("ContinuousLeft",["left"]),e("ContinuousTop",["top"]),e("ContinuousBottom",["bottom"]),e("ContinuousRight",["right"]),n(0,0,0,0,"Assign",function(t,n){var e=n.position||"Fixed";t.positionFinder=e.constructor==String?n.jsPlumbInstance.AnchorPositionFinders[e]:e,t.constructorParams=n}),jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(t,n,e,o){return[(t.left-n.left)/e[0],(t.top-n.top)/e[1]]},Grid:function(t,n,e,o){var i=t.left-n.left,r=t.top-n.top,s=e[0]/o.grid[0],u=e[1]/o.grid[1],c=Math.floor(i/s),a=Math.floor(r/u);return[(c*s+s/2)/e[0],(a*u+u/2)/e[1]]}},jsPlumb.Anchors.Perimeter=function(t){t=t||{};var n=t.anchorCount||60,e=t.shape;if(!e)throw new Error("no shape supplied to Perimeter Anchor type");var o=function(){for(var t=.5,e=2*Math.PI/n,o=0,i=[],r=0;n>r;r++){var s=t+t*Math.sin(o),u=t+t*Math.cos(o);i.push([s,u,0,0]),o+=e}return i},i=function(t){for(var e=n/t.length,o=[],i=function(t,i,r,s,u){e=n*u;for(var c=(r-t)/e,a=(s-i)/e,l=0;e>l;l++)o.push([t+c*l,i+a*l,0,0])},r=0;r<t.length;r++)i.apply(null,t[r]);return o},r=function(t){for(var n=[],e=0;e<t.length;e++)n.push([t[e][0],t[e][1],t[e][2],t[e][3],1/t.length]);return i(n)},s=function(){return r([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},u={Circle:o,Ellipse:o,Diamond:function(){return r([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:s,Square:s,Triangle:function(){return r([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){for(var n=t.points,e=[],o=0,r=0;r<n.length-1;r++){var s=Math.sqrt(Math.pow(n[r][2]-n[r][0])+Math.pow(n[r][3]-n[r][1]));o+=s,e.push([n[r][0],n[r][1],n[r+1][0],n[r+1][1],s])}for(var u=0;u<e.length;u++)e[u][4]=e[u][4]/o;return i(e)}},c=function(t,n){for(var e=[],o=n/180*Math.PI,i=0;i<t.length;i++){var r=t[i][0]-.5,s=t[i][1]-.5;e.push([.5+(r*Math.cos(o)-s*Math.sin(o)),.5+(r*Math.sin(o)+s*Math.cos(o)),t[i][2],t[i][3]])}return e};if(!u[e])throw new Error("Shape ["+e+"] is unknown by Perimeter Anchor type");var a=u[e](t);t.rotation&&(a=c(a,t.rotation));var l=t.jsPlumbInstance.makeDynamicAnchor(a);return l.type="Perimeter",l}}();
/*defaults.js*/
!function(){jsPlumb.DOMElementComponent=jsPlumbUtil.extend(jsPlumb.jsPlumbUIComponent,function(t){this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(t){}}),jsPlumb.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(t,s){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}}},Straight:function(t){var s,n,i,e,l,a,h,o=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(){s=Math.sqrt(Math.pow(l-e,2)+Math.pow(h-a,2)),n=jsPlumbGeom.gradient({x:e,y:a},{x:l,y:h}),i=-1/n});this.type="Straight",this.getLength=function(){return s},this.getGradient=function(){return n},this.getCoordinates=function(){return{x1:e,y1:a,x2:l,y2:h}},this.setCoordinates=function(t){e=t.x1,a=t.y1,l=t.x2,h=t.y2,o()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(e,l),minY:Math.min(a,h),maxX:Math.max(e,l),maxY:Math.max(a,h)}},this.pointOnPath=function(t,n){if(0!==t||n){if(1!=t||n){var i=n?t>0?t:s+t:t*s;return jsPlumbGeom.pointOnLine({x:e,y:a},{x:l,y:h},i)}return{x:l,y:h}}return{x:e,y:a}},this.gradientAtPoint=function(t){return n},this.pointAlongPathFrom=function(t,s,n){var i=this.pointOnPath(t,n),o=0>=s?{x:e,y:a}:{x:l,y:h};return 0>=s&&Math.abs(s)>1&&(s*=-1),jsPlumbGeom.pointOnLine(i,o,s)};var r=function(t,s,n){return n>=Math.min(t,s)&&n<=Math.max(t,s)},u=function(t,s,n){return Math.abs(n-t)<Math.abs(n-s)?t:s};this.findClosestPointOnPath=function(t,o){var m={d:1/0,x:null,y:null,l:null,x1:e,x2:l,y1:a,y2:h};if(0===n)m.y=a,m.x=r(e,l,t)?t:u(e,l,t);else if(n==1/0||n==-(1/0))m.x=e,m.y=r(a,h,o)?o:u(a,h,o);else{var c=a-n*e,p=o-i*t,d=(p-c)/(n-i),b=n*d+c;m.x=r(e,l,d)?d:u(e,l,d),m.y=r(a,h,b)?b:u(a,h,b)}var g=jsPlumbGeom.lineLength([m.x,m.y],[e,a]);return m.d=jsPlumbGeom.lineLength([t,o],[m.x,m.y]),m.l=g/s,m}},Arc:function(t){var s=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(s,n){return jsPlumbGeom.theta([t.cx,t.cy],[s,n])}),n=function(t,s){if(t.anticlockwise){var n=t.startAngle<t.endAngle?t.startAngle+i:t.startAngle,e=Math.abs(n-t.endAngle);return n-e*s}var l=t.endAngle<t.startAngle?t.endAngle+i:t.endAngle,a=Math.abs(l-t.startAngle);return t.startAngle+a*s},i=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=s(t.x1,t.y1),this.endAngle=s(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=i),this.startAngle<0&&(this.startAngle+=i),this.segment=jsPlumbGeom.quadrant([this.x1,this.y1],[this.x2,this.y2]);var e=this.endAngle<this.startAngle?this.endAngle+i:this.endAngle;this.sweep=Math.abs(e-this.startAngle),this.anticlockwise&&(this.sweep=i-this.sweep);var l=2*Math.PI*this.radius,a=this.sweep/i,h=l*a;this.getLength=function(){return h},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var o=1e-10,r=function(t){var s=Math.floor(t),n=Math.ceil(t);return o>t-s?s:o>n-t?n:t};this.pointOnPath=function(s,i){if(0===s)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1==s)return{x:this.x2,y:this.y2,theta:this.endAngle};i&&(s/=h);var e=n(this,s),l=t.cx+t.r*Math.cos(e),a=t.cy+t.r*Math.sin(e);return{x:r(l),y:r(a),theta:e}},this.gradientAtPoint=function(s,n){var i=this.pointOnPath(s,n),e=jsPlumbGeom.normal([t.cx,t.cy],[i.x,i.y]);return this.anticlockwise||e!=1/0&&e!=-(1/0)||(e*=-1),e},this.pointAlongPathFrom=function(s,n,i){var e=this.pointOnPath(s,i),a=n/l*2*Math.PI,h=this.anticlockwise?-1:1,o=e.theta+h*a,r=t.cx+this.radius*Math.cos(o),u=t.cy+this.radius*Math.sin(o);return{x:r,y:u}}},Bezier:function(t){var s=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}]),n={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)};this.type="Bezier";var i=function(t,s,n){return n&&(s=jsBezier.locationAlongCurveFrom(t,s>0?0:1,s)),s};this.pointOnPath=function(t,n){return t=i(s,t,n),jsBezier.pointOnCurve(s,t)},this.gradientAtPoint=function(t,n){return t=i(s,t,n),jsBezier.gradientAtPoint(s,t)},this.pointAlongPathFrom=function(t,n,e){return t=i(s,t,e),jsBezier.pointAlongCurveFrom(s,t,n)},this.getLength=function(){return jsBezier.getLength(s)},this.getBounds=function(){return n}}};var t=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)}},this.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(s){t.apply(this,arguments);var n=[],i=0,e=[],l=[],a=s.stub||0,h=jsPlumbUtil.isArray(a)?a[0]:a,o=jsPlumbUtil.isArray(a)?a[1]:a,r=s.gap||0,u=jsPlumbUtil.isArray(r)?r[0]:r,m=jsPlumbUtil.isArray(r)?r[1]:r,c=null,p=!1,d=null;this.isEditable=function(){return!1},this.setEdited=function(t){p=t},this.getPath=function(){},this.setPath=function(t){},this.findSegmentForPoint=function(t,s){for(var i={d:1/0,s:null,x:null,y:null,l:null},e=0;e<n.length;e++){var l=n[e].findClosestPointOnPath(t,s);l.d<i.d&&(i.d=l.d,i.l=l.l,i.x=l.x,i.y=l.y,i.s=n[e],i.x1=l.x1,i.x2=l.x2,i.y1=l.y1,i.y2=l.y2,i.index=e)}return i};var b=function(){for(var t=0,s=0;s<n.length;s++){var a=n[s].getLength();l[s]=a/i,e[s]=[t,t+=a/i]}},g=function(t,s){s&&(t=t>0?t/i:(i+t)/i);for(var a=e.length-1,h=1,o=0;o<e.length;o++)if(e[o][1]>=t){a=o,h=1==t?1:0===t?0:(t-e[o][0])/l[o];break}return{segment:n[a],proportion:h,index:a}},y=function(t,s,e){if(e.x1!=e.x2||e.y1!=e.y2){var l=new jsPlumb.Segments[s](e);n.push(l),i+=l.getLength(),t.updateBounds(l)}},P=function(){i=0,n.splice(0,n.length),e.splice(0,e.length),l.splice(0,l.length)};this.setSegments=function(t){c=[],i=0;for(var s=0;s<t.length;s++)c.push(t[s]),i+=t[s].getLength()};var x=function(t){this.lineWidth=t.lineWidth;var s=jsPlumbGeom.quadrant(t.sourcePos,t.targetPos),n=t.targetPos[0]<t.sourcePos[0],i=t.targetPos[1]<t.sourcePos[1],e=t.lineWidth||1,l=t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),a=t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),r=n?t.targetPos[0]:t.sourcePos[0],c=i?t.targetPos[1]:t.sourcePos[1],p=Math.abs(t.targetPos[0]-t.sourcePos[0]),d=Math.abs(t.targetPos[1]-t.sourcePos[1]);if(0===l[0]&&0===l[1]||0===a[0]&&0===a[1]){var b=p>d?0:1,g=[1,0][b];l=[],a=[],l[b]=t.sourcePos[b]>t.targetPos[b]?-1:1,a[b]=t.sourcePos[b]>t.targetPos[b]?1:-1,l[g]=0,a[g]=0}var y=n?p+u*l[0]:u*l[0],P=i?d+u*l[1]:u*l[1],x=n?m*a[0]:p+m*a[0],j=i?m*a[1]:d+m*a[1],f=l[0]*a[0]+l[1]*a[1],v={sx:y,sy:P,tx:x,ty:j,lw:e,xSpan:Math.abs(x-y),ySpan:Math.abs(j-P),mx:(y+x)/2,my:(P+j)/2,so:l,to:a,x:r,y:c,w:p,h:d,segment:s,startStubX:y+l[0]*h,startStubY:P+l[1]*h,endStubX:x+a[0]*o,endStubY:j+a[1]*o,isXGreaterThanStubTimes2:Math.abs(y-x)>h+o,isYGreaterThanStubTimes2:Math.abs(P-j)>h+o,opposite:-1==f,perpendicular:0===f,orthogonal:1==f,sourceAxis:0===l[0]?"y":"x",points:[r,c,p,d,y,P,x,j]};return v.anchorOrientation=v.opposite?"opposite":v.orthogonal?"orthogonal":"perpendicular",v};this.getSegments=function(){return n},this.updateBounds=function(t){var s=t.getBounds();this.bounds.minX=Math.min(this.bounds.minX,s.minX),this.bounds.maxX=Math.max(this.bounds.maxX,s.maxX),this.bounds.minY=Math.min(this.bounds.minY,s.minY),this.bounds.maxY=Math.max(this.bounds.maxY,s.maxY)};return this.pointOnPath=function(t,s){var n=g(t,s);return n.segment&&n.segment.pointOnPath(n.proportion,s)||[0,0]},this.gradientAtPoint=function(t){var s=g(t,absolute);return s.segment&&s.segment.gradientAtPoint(s.proportion,absolute)||0},this.pointAlongPathFrom=function(t,s,n){var i=g(t,n);return i.segment&&i.segment.pointAlongPathFrom(i.proportion,s,!1)||[0,0]},this.compute=function(t){p||(d=x.call(this,t)),P(),this._compute(d,t),this.x=d.points[0],this.y=d.points[1],this.w=d.points[2],this.h=d.points[3],this.segment=d.segment,b()},{addSegment:y,prepareCompute:x,sourceStub:h,targetStub:o,maxStub:Math.max(h,o),sourceGap:u,targetGap:m,maxGap:Math.max(u,m)}},jsPlumbUtil.extend(jsPlumb.Connectors.AbstractConnector,t);var s=jsPlumb.Connectors.Straight=function(){this.type="Straight";var t=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(s,n){t.addSegment(this,"Straight",{x1:s.sx,y1:s.sy,x2:s.startStubX,y2:s.startStubY}),t.addSegment(this,"Straight",{x1:s.startStubX,y1:s.startStubY,x2:s.endStubX,y2:s.endStubY}),t.addSegment(this,"Straight",{x1:s.endStubX,y1:s.endStubY,x2:s.tx,y2:s.ty})}};jsPlumbUtil.extend(jsPlumb.Connectors.Straight,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(s,"Straight");var n=function(t){t=t||{};var s=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),n=(t.stub||50,t.curviness||150),i=10;this.type="Bezier",this.getCurviness=function(){return n},this._findControlPoint=function(t,s,e,l,a){var h=l.anchor.getOrientation(l),o=a.anchor.getOrientation(a),r=h[0]!=o[0]||h[1]==o[1],u=[];return r?(0===o[0]?u.push(e[0]<s[0]?t[0]+i:t[0]-i):u.push(t[0]+n*o[0]),0===o[1]?u.push(e[1]<s[1]?t[1]+i:t[1]-i):u.push(t[1]+n*h[1])):(0===h[0]?u.push(s[0]<e[0]?t[0]+i:t[0]-i):u.push(t[0]-n*h[0]),0===h[1]?u.push(s[1]<e[1]?t[1]+i:t[1]-i):u.push(t[1]+n*o[1])),u},this._compute=function(t,n){var i=n.sourcePos,e=n.targetPos,l=Math.abs(i[0]-e[0]),a=Math.abs(i[1]-e[1]),h=i[0]<e[0]?l:0,o=i[1]<e[1]?a:0,r=i[0]<e[0]?0:l,u=i[1]<e[1]?0:a,m=this._findControlPoint([h,o],i,e,n.sourceEndpoint,n.targetEndpoint),c=this._findControlPoint([r,u],e,i,n.targetEndpoint,n.sourceEndpoint);s.addSegment(this,"Bezier",{x1:h,y1:o,x2:r,y2:u,cp1x:m[0],cp1y:m[1],cp2x:c[0],cp2y:c[1]})}};jsPlumbUtil.extend(n,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(n,"Bezier"),jsPlumb.Endpoints.AbstractEndpoint=function(s){t.apply(this,arguments);var n=this.compute=function(t,s,n,i){var e=this._compute.apply(this,arguments);return this.x=e[0],this.y=e[1],this.w=e[2],this.h=e[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,e};return{compute:n,cssClass:s.cssClass}},jsPlumbUtil.extend(jsPlumb.Endpoints.AbstractEndpoint,t),jsPlumb.Endpoints.Dot=function(t){this.type="Dot";jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(t,s,n,i){this.radius=n.radius||this.radius;var e=t[0]-this.radius,l=t[1]-this.radius,a=2*this.radius,h=2*this.radius;if(n.strokeStyle){var o=n.lineWidth||1;e-=o,l-=o,a+=2*o,h+=2*o}return[e,l,a,h,this.radius]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Dot,jsPlumb.Endpoints.AbstractEndpoint),jsPlumb.Endpoints.Rectangle=function(t){this.type="Rectangle";jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(t,s,n,i){var e=n.width||this.width,l=n.height||this.height,a=t[0]-e/2,h=t[1]-l/2;return[a,h,e,l]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Rectangle,jsPlumb.Endpoints.AbstractEndpoint);var i=function(t){jsPlumb.DOMElementComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};jsPlumbUtil.extend(i,jsPlumb.DOMElementComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),jsPlumb.Endpoints.Image=function(t){this.type="Image",i.apply(this,arguments),jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);var s=t.onload,n=t.src||t.url,e=t.parent,l=t.cssClass?" "+t.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=t.width,this._jsPlumb.heightToUse=t.height,this._jsPlumb.endpoint=t.endpoint,this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,s&&s(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(t,n){var i=t.constructor==String?t:t.src;s=n,this._jsPlumb.img.src=i,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(n,s),this._compute=function(t,s,n,i){return this.anchorPoint=t,this._jsPlumb.ready?[t[0]-this._jsPlumb.widthToUse/2,t[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=document.createElement("img"),this.canvas.style.margin=0,this.canvas.style.padding=0,this.canvas.style.outline=0,this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.instance.endpointClass+l,this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas,e),this.attachListeners(this.canvas,this),this.actuallyPaint=function(t,s,n){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var i=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,e=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;jsPlumbUtil.sizeElement(this.canvas,i,e,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(t,s){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(t,s):window.setTimeout(function(){this.paint(t,s)}.bind(this),200))}},jsPlumbUtil.extend(jsPlumb.Endpoints.Image,[i,jsPlumb.Endpoints.AbstractEndpoint],{cleanup:function(){this._jsPlumb.deleted=!0,jsPlumbUtil.removeElement(this.canvas),this.canvas=null}}),jsPlumb.Endpoints.Blank=function(t){jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank",i.apply(this,arguments),this._compute=function(t,s,n,i){return[t[0],t[1],10,0]},this.canvas=document.createElement("div"),this.canvas.style.display="block",this.canvas.style.width="1px",this.canvas.style.height="1px",this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.endpointClass,jsPlumb.appendElement(this.canvas,t.parent),this.paint=function(t,s){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.Blank,[jsPlumb.Endpoints.AbstractEndpoint,i],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),jsPlumb.Endpoints.Triangle=function(t){this.type="Triangle";jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},t.width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(t,s,n,i){var e=n.width||self.width,l=n.height||self.height,a=t[0]-e/2,h=t[1]-l/2;return[a,h,e,l]}};var e=jsPlumb.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation};e.prototype={cleanup:function(){this.component=null,this.canvas=null,this.endpointLoc=null},setVisible:function(t){this.visible=t},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc}},jsPlumb.Overlays.Arrow=function(t){this.type="Arrow",e.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};var s=jsPlumbUtil,n=jsPlumbGeom;this.length=t.length||20,this.width=t.width||20,this.id=t.id;var i=(t.direction||1)<0?-1:1,l=t.paintStyle||{lineWidth:1},a=t.foldback||.623;this.computeMaxSize=function(){return 1.5*self.width},this.draw=function(t,e){var h,o,r,u,m;if(t.pointAlongPathFrom){if(s.isString(this.loc)||this.loc>1||this.loc<0){var c=parseInt(this.loc,10),p=this.loc<0?1:0;h=t.pointAlongPathFrom(p,c,!1),o=t.pointAlongPathFrom(p,c-i*this.length/2,!1),r=n.pointOnLine(h,o,this.length)}else if(1==this.loc){if(h=t.pointOnPath(this.loc),o=t.pointAlongPathFrom(this.loc,-this.length),r=n.pointOnLine(h,o,this.length),-1==i){var d=r;r=h,h=d}}else if(0===this.loc){if(r=t.pointOnPath(this.loc),o=t.pointAlongPathFrom(this.loc,this.length),h=n.pointOnLine(r,o,this.length),-1==i){var b=r;r=h,h=b}}else h=t.pointAlongPathFrom(this.loc,i*this.length/2),o=t.pointOnPath(this.loc),r=n.pointOnLine(h,o,this.length);u=n.perpendicularLineTo(h,r,this.width),m=n.pointOnLine(h,r,a*this.length);var g={hxy:h,tail:u,cxy:m},y=l.strokeStyle||e.strokeStyle,P=l.fillStyle||e.strokeStyle,x=l.lineWidth||e.lineWidth,j={component:t,d:g,lineWidth:x,strokeStyle:y,fillStyle:P,minX:Math.min(h.x,u[0].x,u[1].x),maxX:Math.max(h.x,u[0].x,u[1].x),minY:Math.min(h.y,u[0].y,u[1].y),maxY:Math.max(h.y,u[0].y,u[1].y)};return j}return{component:t,minX:0,maxX:0,minY:0,maxY:0}}},jsPlumbUtil.extend(jsPlumb.Overlays.Arrow,e),jsPlumb.Overlays.PlainArrow=function(t){t=t||{};var s=jsPlumb.extend(t,{foldback:1});jsPlumb.Overlays.Arrow.call(this,s),this.type="PlainArrow"},jsPlumbUtil.extend(jsPlumb.Overlays.PlainArrow,jsPlumb.Overlays.Arrow),jsPlumb.Overlays.Diamond=function(t){t=t||{};var s=t.length||40,n=jsPlumb.extend(t,{length:s/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,n),this.type="Diamond"},jsPlumbUtil.extend(jsPlumb.Overlays.Diamond,jsPlumb.Overlays.Arrow);var l=function(t){return null==t._jsPlumb.cachedDimensions&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},a=function(t){jsPlumb.DOMElementComponent.apply(this,arguments),e.apply(this,arguments);var s=jsPlumb.CurrentLibrary;this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this.getElement=function(){if(null==this._jsPlumb.div){var n=this._jsPlumb.div=s.getDOMElement(this._jsPlumb.create(this._jsPlumb.component));n.style.position="absolute";var i=t._jsPlumb.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"");n.className=i,this._jsPlumb.instance.appendElement(n,this._jsPlumb.component.parent),this._jsPlumb.instance.getId(n),this.attachListeners(n,this),this.canvas=n}return this._jsPlumb.div},this.draw=function(t,s,n){var i=l(this);if(null!=i&&2==i.length){var e={x:0,y:0};if(n)e={x:n[0],y:n[1]};else if(t.pointOnPath){var a=this.loc,h=!1;(jsPlumbUtil.isString(this.loc)||this.loc<0||this.loc>1)&&(a=parseInt(this.loc,10),h=!0),e=t.pointOnPath(a,h)}else{var o=this.loc.constructor==Array?this.loc:this.endpointLoc;e={x:o[0]*t.w,y:o[1]*t.h}}var r=e.x-i[0]/2,u=e.y-i[1]/2;return{component:t,d:{minx:r,miny:u,td:i,cxy:e},minX:r,maxX:r+i[0],minY:u,maxY:u+i[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(a,[jsPlumb.DOMElementComponent,e],{getDimensions:function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(this.getElement()))},setVisible:function(t){this._jsPlumb.div.style.display=t?"block":"none"},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(){null!=this._jsPlumb.div&&jsPlumb.CurrentLibrary.removeElement(this._jsPlumb.div)},computeMaxSize:function(){var t=l(this);return Math.max(t[0],t[1])},reattachListeners:function(t){this._jsPlumb.div&&this.reattachListenersForElement(this._jsPlumb.div,this,t)},paint:function(t,s){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this.attachListeners(this._jsPlumb.div,t.component),this._jsPlumb.initialised=!0),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),jsPlumb.Overlays.Custom=function(t){this.type="Custom",a.apply(this,arguments)},jsPlumbUtil.extend(jsPlumb.Overlays.Custom,a),jsPlumb.Overlays.GuideLines=function(){var t=this;t.length=50,t.lineWidth=5,this.type="GuideLines",e.apply(this,arguments),jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.draw=function(s,n){var i=s.pointAlongPathFrom(t.loc,t.length/2),e=s.pointOnPath(t.loc),l=jsPlumbGeom.pointOnLine(i,e,t.length),a=jsPlumbGeom.perpendicularLineTo(i,l,40),h=jsPlumbGeom.perpendicularLineTo(l,i,20);return{connector:s,head:i,tail:l,headLine:h,tailLine:a,minX:Math.min(i.x,l.x,h[0].x,h[1].x),minY:Math.min(i.y,l.y,h[0].y,h[1].y),maxX:Math.max(i.x,l.x,h[0].x,h[1].x),maxY:Math.max(i.y,l.y,h[0].y,h[1].y)}}},jsPlumb.Overlays.Label=function(t){this.labelStyle=t.labelStyle;this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var s=jsPlumb.extend({create:function(){return document.createElement("div")}},t);if(jsPlumb.Overlays.Custom.call(this,s),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){var n=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",n.style.font=this.labelStyle.font,n.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(n.style.background=this.labelStyle.fillStyle),this.labelStyle.borderWidth>0){var i=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";n.style.border=this.labelStyle.borderWidth+"px solid "+i}this.labelStyle.padding&&(n.style.padding=this.labelStyle.padding)}},jsPlumbUtil.extend(jsPlumb.Overlays.Label,jsPlumb.Overlays.Custom,{cleanup:function(){this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),a.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))}})}();
/*connectors-bezier.js*/
!function(){var t=function(t){t=t||{};var n=this,o=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),r=(t.stub||50,t.curviness||150),s=10;this.type="Bezier",this.getCurviness=function(){return r},this._findControlPoint=function(t,n,o,e,i){var u=e.anchor.getOrientation(e),p=i.anchor.getOrientation(i),c=u[0]!=p[0]||u[1]==p[1],a=[];return c?(0===p[0]?a.push(o[0]<n[0]?t[0]+s:t[0]-s):a.push(t[0]+r*p[0]),0===p[1]?a.push(o[1]<n[1]?t[1]+s:t[1]-s):a.push(t[1]+r*u[1])):(0===u[0]?a.push(n[0]<o[0]?t[0]+s:t[0]-s):a.push(t[0]-r*u[0]),0===u[1]?a.push(n[1]<o[1]?t[1]+s:t[1]-s):a.push(t[1]+r*p[1])),a},this._compute=function(t,r){var s=r.sourcePos,e=r.targetPos,i=Math.abs(s[0]-e[0]),u=Math.abs(s[1]-e[1]),p=s[0]<e[0]?i:0,c=s[1]<e[1]?u:0,a=s[0]<e[0]?0:i,h=s[1]<e[1]?0:u,d=n._findControlPoint([p,c],s,e,r.sourceEndpoint,r.targetEndpoint),g=n._findControlPoint([a,h],e,s,r.targetEndpoint,r.sourceEndpoint);o.addSegment(this,"Bezier",{x1:p,y1:c,x2:a,y2:h,cp1x:d[0],cp1y:d[1],cp2x:g[0],cp2y:g[1]})}};jsPlumb.registerConnectorType(t,"Bezier")}();
/*connectors-statemachine.js*/
!function(){var t=function(t,o,s,e){return s>=t&&o>=e?1:s>=t&&e>=o?2:t>=s&&e>=o?3:4},o=function(t,o,s,e,r,a,n,c,i){return i>=c?[t,o]:1===s?e[3]<=0&&r[3]>=1?[t+(e[2]<.5?-1*a:a),o]:e[2]>=1&&r[2]<=0?[t,o+(e[3]<.5?-1*n:n)]:[t+-1*a,o+-1*n]:2===s?e[3]>=1&&r[3]<=0?[t+(e[2]<.5?-1*a:a),o]:e[2]>=1&&r[2]<=0?[t,o+(e[3]<.5?-1*n:n)]:[t+1*a,o+-1*n]:3===s?e[3]>=1&&r[3]<=0?[t+(e[2]<.5?-1*a:a),o]:e[2]<=0&&r[2]>=1?[t,o+(e[3]<.5?-1*n:n)]:[t+-1*a,o+-1*n]:4===s?e[3]<=0&&r[3]>=1?[t+(e[2]<.5?-1*a:a),o]:e[2]<=0&&r[2]>=1?[t,o+(e[3]<.5?-1*n:n)]:[t+1*a,o+-1*n]:void 0},s=function(s){s=s||{},this.type="StateMachine";var e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),r=s.curviness||10,a=s.margin||5,n=s.proximityLimit||80,c=s.orientation&&"clockwise"===s.orientation,i=s.loopbackRadius||25,P=s.showLoopback!==!1;this._compute=function(s,u){var g=Math.abs(u.sourcePos[0]-u.targetPos[0]),h=Math.abs(u.sourcePos[1]-u.targetPos[1]);Math.min(u.sourcePos[0],u.targetPos[0]),Math.min(u.sourcePos[1],u.targetPos[1]);if(P&&u.sourceEndpoint.elementId===u.targetEndpoint.elementId){var p=u.sourcePos[0],M=(u.sourcePos[0],u.sourcePos[1]-a),m=(u.sourcePos[1]-a,p),d=M-i,l=2*i,y=2*i,b=m-i,v=d-i;s.points[0]=b,s.points[1]=v,s.points[2]=l,s.points[3]=y,e.addSegment(this,"Arc",{loopback:!0,x1:p-b+4,y1:M-v,startAngle:0,endAngle:2*Math.PI,r:i,ac:!c,x2:p-b-4,y2:M-v,cx:m-b,cy:d-v})}else{var x=u.sourcePos[0]<u.targetPos[0]?0:g,f=u.sourcePos[1]<u.targetPos[1]?0:h,k=u.sourcePos[0]<u.targetPos[0]?g:0,w=u.sourcePos[1]<u.targetPos[1]?h:0;0===u.sourcePos[2]&&(x-=a),1===u.sourcePos[2]&&(x+=a),0===u.sourcePos[3]&&(f-=a),1===u.sourcePos[3]&&(f+=a),0===u.targetPos[2]&&(k-=a),1===u.targetPos[2]&&(k+=a),0===u.targetPos[3]&&(w-=a),1===u.targetPos[3]&&(w+=a);var A=(x+k)/2,S=(f+w)/2,C=-1*A/S,I=Math.atan(C),j=(C==1/0||C==-(1/0)?0:Math.abs(r/2*Math.sin(I)),C==1/0||C==-(1/0)?0:Math.abs(r/2*Math.cos(I)),t(x,f,k,w)),E=Math.sqrt(Math.pow(k-x,2)+Math.pow(w-f,2)),L=o(A,S,j,u.sourcePos,u.targetPos,r,r,E,n);e.addSegment(this,"Bezier",{x1:k,y1:w,x2:x,y2:f,cp1x:L[0],cp1y:L[1],cp2x:L[0],cp2y:L[1]})}}};jsPlumb.registerConnectorType(s,"StateMachine")}();
/*connectors-flowchart.js*/
!function(){var t=function(t){this.type="Flowchart",t=t||{},t.stub=null==t.stub?30:t.stub;var n,u=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),e=null==t.midpoint?.5:t.midpoint,r=[],s=(t.grid,t.alwaysRespectStubs),a=null,o=null,b=null,S=null!=t.cornerRadius?t.cornerRadius:0,i=function(t){return 0>t?-1:0===t?0:1},l=function(t,n,u,e){if(o!=n||b!=u){var r=null==o?e.sx:o,s=null==b?e.sy:b,a=r==n?"v":"h",S=i(n-r),l=i(u-s);o=n,b=u,t.push([r,s,n,u,a,S,l])}},d=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},x=function(t){var n=[];return n.push.apply(n,t),n},c=function(t,n,e){for(var r,s,a=0;a<n.length-1;a++){if(r=r||x(n[a]),s=x(n[a+1]),S>0&&r[4]!=s[4]){var o=Math.min(S,d(r),d(s));r[2]-=r[5]*o,r[3]-=r[6]*o,s[0]+=s[5]*o,s[1]+=s[6]*o;var b=r[6]==s[5]&&1==s[5]||r[6]==s[5]&&0===s[5]&&r[5]!=s[6]||r[6]==s[5]&&-1==s[5],i=s[1]>r[3]?1:-1,l=s[0]>r[2]?1:-1,c=i==l,y=c&&b||!c&&!b?s[0]:r[2],h=c&&b||!c&&!b?r[3]:s[1];u.addSegment(t,"Straight",{x1:r[0],y1:r[1],x2:r[2],y2:r[3]}),u.addSegment(t,"Arc",{r:o,x1:r[2],y1:r[3],x2:s[0],y2:s[1],cx:y,cy:h,ac:b})}else{var X=r[2]==r[0]?0:r[2]>r[0]?e.lw/2:-(e.lw/2),Y=r[3]==r[1]?0:r[3]>r[1]?e.lw/2:-(e.lw/2);u.addSegment(t,"Straight",{x1:r[0]-X,y1:r[1]-Y,x2:r[2]+X,y2:r[3]+Y})}r=s}u.addSegment(t,"Straight",{x1:s[0],y1:s[1],x2:s[2],y2:s[3]})};this.setSegments=function(t){a=t},this.isEditable=function(){return!0},this.getOriginalSegments=function(){return a||r},this._compute=function(t,S){if(S.clearEdits&&(a=null),null!=a)return void c(this,a,t);r=[],o=null,b=null,n=null;var i=t.startStubX+(t.endStubX-t.startStubX)*e,d=t.startStubY+(t.endStubY-t.startStubY)*e,x={x:[0,1],y:[1,0]},y=function(n){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},h={perpendicular:y,orthogonal:y,opposite:function(n){var u=t,e="x"==n?0:1,r={x:function(){return 1==u.so[e]&&(u.startStubX>u.endStubX&&u.tx>u.startStubX||u.sx>u.endStubX&&u.tx>u.sx)||-1==u.so[e]&&(u.startStubX<u.endStubX&&u.tx<u.startStubX||u.sx<u.endStubX&&u.tx<u.sx)},y:function(){return 1==u.so[e]&&(u.startStubY>u.endStubY&&u.ty>u.startStubY||u.sy>u.endStubY&&u.ty>u.sy)||-1==u.so[e]&&(u.startStubY<u.endStubY&&u.ty<u.startStubY||u.sy<u.endStubY&&u.ty<u.sy)}};return!s&&r[n]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[n]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}},X={perpendicular:function(n,u,e,r,s){var a=t,o={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},b={x:[[a.startStubX,a.endStubX],null,[a.endStubX,a.startStubX]],y:[[a.startStubY,a.endStubY],null,[a.endStubY,a.startStubY]]},S={x:[[i,a.startStubY],[i,a.endStubY]],y:[[a.startStubX,d],[a.endStubX,d]]},l={x:[[a.endStubX,a.startStubY]],y:[[a.startStubX,a.endStubY]]},c={x:[[a.startStubX,a.endStubY],[a.endStubX,a.endStubY]],y:[[a.endStubX,a.startStubY],[a.endStubX,a.endStubY]]},y={x:[[a.startStubX,d],[a.endStubX,d],[a.endStubX,a.endStubY]],y:[[i,a.startStubY],[i,a.endStubY],[a.endStubX,a.endStubY]]},h={x:[a.startStubY,a.endStubY],y:[a.startStubX,a.endStubX]},X=x[n][0],Y=x[n][1],f=a.so[X]+1,g=a.to[Y]+1,m=-1==a.to[Y]&&h[n][1]<h[n][0]||1==a.to[Y]&&h[n][1]>h[n][0],p=b[n][f][0],v=b[n][f][1],w=o[n][f][g];return a.segment==w[3]||a.segment==w[2]&&m?S[n]:a.segment==w[2]&&p>v?l[n]:a.segment==w[2]&&v>=p||a.segment==w[1]&&!m?y[n]:a.segment==w[0]||a.segment==w[1]&&m?c[n]:void 0},orthogonal:function(n,u,e,r,s){var a=t,o={x:-1==a.so[0]?Math.min(u,r):Math.max(u,r),y:-1==a.so[1]?Math.min(u,r):Math.max(u,r)}[n];return{x:[[o,e],[o,s],[r,s]],y:[[e,o],[s,o],[s,r]]}[n]},opposite:function(n,e,r,s,a){var o=t,b={x:"y",y:"x"}[n],l={x:"height",y:"width"}[n],x=o["is"+n.toUpperCase()+"GreaterThanStubTimes2"];if(S.sourceEndpoint.elementId==S.targetEndpoint.elementId){var c=r+(1-S.sourceEndpoint.anchor[b])*S.sourceInfo[l]+u.maxStub;return{x:[[e,c],[s,c]],y:[[c,e],[c,s]]}[n]}return!x||1==o.so[f]&&e>s||-1==o.so[f]&&s>e?{x:[[e,d],[s,d]],y:[[i,e],[i,s]]}[n]:1==o.so[f]&&s>e||-1==o.so[f]&&e>s?{x:[[i,o.sy],[i,o.ty]],y:[[o.sx,d],[o.tx,d]]}[n]:void 0}},Y=h[t.anchorOrientation](t.sourceAxis),f="x"==t.sourceAxis?0:1,g="x"==t.sourceAxis?1:0,m=Y[f],p=Y[g],v=Y[f+2],w=Y[g+2];l(r,Y[0],Y[1],t);var M=X[t.anchorOrientation](t.sourceAxis,m,p,v,w);if(M)for(var A=0;A<M.length;A++)l(r,M[A][0],M[A][1],t);l(r,Y[2],Y[3],t),l(r,t.tx,t.ty,t),c(this,r,t)},this.getPath=function(){for(var t=null,n=null,u=[],e=a||r,s=0;s<e.length;s++){var o=e[s],b=o[4],S="v"==b?3:2;null!=t&&n===b?t[S]=o[S]:(o[0]!=o[2]||o[1]!=o[3])&&(u.push({start:[o[0],o[1]],end:[o[2],o[3]]}),t=o,n=o[4])}return u},this.setPath=function(t){a=[];for(var n=0;n<t.length;n++){var u=t[n].start[0],e=t[n].start[1],r=t[n].end[0],s=t[n].end[1],o=u==r?"v":"h",b=i(r-u),S=i(s-e);a.push([u,e,r,s,o,b,S])}}};jsPlumbUtil.extend(t,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(t,"Flowchart")}();
/*connector-editors.js*/
!function(){var n=function(n){},e="ontouchstart"in document.documentElement,t=e?"touchstart":"mousedown",o=e?"touchend":"mouseup",s=e?"touchmove":"mousemove",i=function(n,e,t,o,s){var i=n[0]==n[2]?1/0:0,c=-1/i,r={s:n,m:i,i:o,x:-1,y:-1,d:1/0};if(0==i)(n[0]<=e&&e<=n[2]||n[2]<=e&&e<=n[0])&&(r.x=e,r.y=n[1],r.d=Math.abs(t-n[1]));else if(i==1/0||i==-(1/0))(n[1]<=t&&t<=n[3]||n[3]<=t&&t<=n[1])&&(r.x=n[0],r.y=t,r.d=Math.abs(e-n[0]));else{var l=n[1]-i*n[0],u=t-c*e,a=(u-l)/(i-c),d=i*a+l,p=jsPlumbGeom.lineLength([e,t],[a,d]),m=jsPlumbGeom.lineLength([a,d],[n[0],n[1]]);r.d=p,r.x=a,r.y=d,r.l=m/length}return r};jsPlumb.ConnectorEditors={Flowchart:function(e){n.apply(this,arguments);var c=jsPlumb.CurrentLibrary,r=function(n){c.removeClass(document.body,e.connection._jsPlumb.instance.dragSelectClass),e.connection._jsPlumb.instance.setConnectionBeingDragged(!1),n.stopPropagation(),n.preventDefault(),c.unbind(document,o,r),c.unbind(document,s,f),l=null,u=null,a=null,d=null,e.connection.setHover(!1),e.connector.setSuspendEvents(!1),e.connection.endpoints[0].setSuspendEvents(!1),e.connection.endpoints[1].setSuspendEvents(!1),e.connection.editCompleted(),e.connector.justEdited=p,p=!1},l=null,u=null,a=null,d=null,p=!1,m=e.params.anchorsMoveable,h=function(){for(var n=null,e=null,t=[],o=0;o<u.length;o++){var s=u[o],i=s[4],c="v"==i?3:2;null!=n&&e===i?n[c]=s[c]:(t.push(s),n=s,e=s[4])}u=t},g=function(n,t,o){var s=c.getSize(n.element),i=s[t?1:0],r=c.getElementObject(n.element),l=c.getOffset(r),u=c.getElementObject(e.connector.canvas.parentNode),a=c.getOffset(u),d=l[t?"top":"left"]-a[t?"top":"left"],p=n.anchor.getCurrentLocation({element:n}),h=t?e.connector.y+o:e.connector.x+o;if(m){if(h>d&&d+i>h){[p[0],p[1]];return p[t?1:0]=h,n.anchor.setUserDefinedLocation(p),o}var g=d>h?d:d+i;return g-(t?e.connector.y:e.connector.x)}return p[t?1:0]-e.connector[t?"y":"x"]},b=function(n){n[0]!=n[2]&&(n[5]=n[0]<n[2]?1:-1),n[1]!=n[3]&&(n[6]=n[1]<n[3]?1:-1)},f=function(n){if(null!=a){p||(e.connection.setHover(!0),e.connector.setSuspendEvents(!0),e.connection.endpoints[0].setSuspendEvents(!0),e.connection.endpoints[1].setSuspendEvents(!0)),p=!0;var t=a.m,o=a.s,s=n.pageX||n.page.x,i=n.pageY||n.page.y,c=0==t?0:s-l[0],r=0==t?i-l[1]:0,m=d[0]+c,h=d[1]+r,f=d[2]+c,v=d[3]+r,j="h"==o[4];if(0==a.i){var P=g(e.connection.endpoints[0],j,j?h:m);j?h=v=P:m=f=P,u[1][0]=f,u[1][1]=v,b(u[1])}else if(a.i==u.length-1){var P=g(e.connection.endpoints[1],j,j?h:m);j?h=v=P:m=f=P,u[u.length-2][2]=m,u[u.length-2][3]=h,b(u[u.length-2])}else j?(u[a.i-1][3]=h,u[a.i+1][1]=v):(u[a.i-1][2]=m,u[a.i+1][0]=f),b(u[a.i+1]),b(u[a.i-1]);o[0]=m,o[1]=h,o[2]=f,o[3]=v,e.connector.setSegments(u),e.connection.repaint(),e.connection.endpoints[0].repaint(),e.connection.endpoints[1].repaint(),e.connector.setEdited(!0)}else p=!1};e.connector.bind(t,function(n,t){var p=t.pageX||t.page.x,m=t.pageY||t.page.y,g=c.getElementObject(e.connection.getConnector().canvas),b=c.getOffset(g),v=1/0,j=e.connector.findSegmentForPoint(p-b.left,m-b.top);console.log(j),u=e.connector.getOriginalSegments(),h();for(var P=0;P<u.length;P++){var C=i(u[P],p-b.left,m-b.top,P,e.connector.bounds);C.d<v&&(a=C,d=[C.s[0],C.s[1],C.s[2],C.s[3]],v=C.d)}return l=[p,m],null!=a?(c.bind(document,o,r),c.bind(document,s,f),c.addClass(document.body,e.connection._jsPlumb.instance.dragSelectClass),e.connection._jsPlumb.instance.setConnectionBeingDragged(!0),e.connection.editStarted(),!1):void 0},!0)}},jsPlumb.Connectors.AbstractConnector.prototype.shouldFireEvent=function(n,e,t){var o=!this.justEdited;return"click"==n&&(this.justEdited=!1),o};var c="editStarted",r="editCompleted",l="editCanceled";jsPlumb.Connection.prototype.setEditable=function(n){return this.connector&&this.connector.isEditable()&&(this._jsPlumb.editable=n),this._jsPlumb.editable},jsPlumb.Connection.prototype.isEditable=function(){return this._jsPlumb.editable},jsPlumb.Connection.prototype.editStarted=function(){this.setSuspendEvents(!0),this.fire(c,{path:this.connector.getPath()}),this._jsPlumb.instance.setHoverSuspended(!0)},jsPlumb.Connection.prototype.editCompleted=function(){this.fire(r,{path:this.connector.getPath()}),this.setSuspendEvents(!1),this._jsPlumb.instance.setHoverSuspended(!1),this.setHover(!1)},jsPlumb.Connection.prototype.editCanceled=function(){this.fire(l,{path:this.connector.getPath()}),this._jsPlumb.instance.setHoverSuspended(!1),this.setHover(!1)}}();
/*renderers-svg.js*/
!function(){var t={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},s="stroke-dasharray",e="dashstyle",n="linearGradient",i="radialGradient",l="fill",a="stop",r="stroke",o="stroke-width",h="style",u="none",p="jsplumb_gradient_",m="lineWidth",c={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},d=function(t,s){for(var e in s)t.setAttribute(e,""+s[e])},v=function(t,s){var e=document.createElementNS(c.svg,t);return s=s||{},s.version="1.1",s.xmlns=c.xhtml,d(e,s),e},g=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},b=function(t){for(var s=0;s<t.childNodes.length;s++)(t.childNodes[s].tagName==n||t.childNodes[s].tagName==i)&&t.removeChild(t.childNodes[s])},y=function(t,s,e,o,u){var m=p+u._jsPlumb.instance.idstamp();b(t);var c;c=e.gradient.offset?v(i,{id:m}):v(n,{id:m,gradientUnits:"userSpaceOnUse"}),t.appendChild(c);for(var d=0;d<e.gradient.stops.length;d++){var g=1==u.segment||2==u.segment?d:e.gradient.stops.length-1-d,y=jsPlumbUtil.convertStyle(e.gradient.stops[g][1],!0),P=v(a,{offset:Math.floor(100*e.gradient.stops[d][0])+"%","stop-color":y});c.appendChild(P)}var f=e.strokeStyle?r:l;s.setAttribute(h,f+":url("+document.location.toString()+"#"+m+")")},P=function(n,i,a,p,c){if(a.gradient?y(n,i,a,p,c):(b(n),i.setAttribute(h,"")),i.setAttribute(l,a.fillStyle?jsPlumbUtil.convertStyle(a.fillStyle,!0):u),i.setAttribute(r,a.strokeStyle?jsPlumbUtil.convertStyle(a.strokeStyle,!0):u),a.lineWidth&&i.setAttribute(o,a.lineWidth),a[e]&&a[m]&&!a[s]){var d=-1==a[e].indexOf(",")?" ":",",v=a[e].split(d),g="";v.forEach(function(t){g+=Math.floor(t*a.lineWidth)+d}),i.setAttribute(s,g)}else a[s]&&i.setAttribute(s,a[s]);for(var P in t)a[P]&&i.setAttribute(t[P],a[P])},f=function(t,s,e){for(var n=e.split(" "),i=t.className,l=i.baseVal.split(" "),a=0;a<n.length;a++)if(s)-1==l.indexOf(n[a])&&l.push(n[a]);else{var r=l.indexOf(n[a]);-1!=r&&l.splice(r,1)}t.className.baseVal=l.join(" ")},j=function(t,s){f(t,!0,s)},x=function(t,s){f(t,!1,s)},C=function(t,s,e){t.childNodes.length>e?t.insertBefore(s,t.childNodes[e]):t.appendChild(s)};jsPlumbUtil.svg={addClass:j,removeClass:x,node:v,attr:d,pos:g};var L=function(t){var s=t.pointerEventsSpec||"all",e={};jsPlumb.jsPlumbUIComponent.apply(this,t.originalArgs),this.canvas=null,this.path=null,this.svg=null;var n=t.cssClass+" "+(t.originalArgs[0].cssClass||""),i={style:"",width:0,height:0,"pointer-events":s,position:"absolute"};this.svg=v("svg",i),t.useDivWrapper?(this.canvas=document.createElement("div"),this.canvas.style.position="absolute",jsPlumbUtil.sizeElement(this.canvas,0,0,1,1),this.canvas.className=n):(d(this.svg,{"class":n}),this.canvas=this.svg),t._jsPlumb.appendElement(this.canvas,t.originalArgs[0].parent),t.useDivWrapper&&this.canvas.appendChild(this.svg);var l=[this.canvas];return this.getDisplayElements=function(){return l},this.appendDisplayElement=function(t){l.push(t)},this.paint=function(s,n,i){if(null!=s){var l,a=[this.x,this.y],r=[this.w,this.h];null!=i&&(i.xmin<0&&(a[0]+=i.xmin),i.ymin<0&&(a[1]+=i.ymin),r[0]=i.xmax+(i.xmin<0?-i.xmin:0),r[1]=i.ymax+(i.ymin<0?-i.ymin:0)),t.useDivWrapper?(jsPlumbUtil.sizeElement(this.canvas,a[0],a[1],r[0],r[1]),a[0]=0,a[1]=0,l=g([0,0])):l=g([a[0],a[1]]),e.paint.apply(this,arguments),d(this.svg,{style:l,width:r[0],height:r[1]})}},{renderer:e}};jsPlumbUtil.extend(L,jsPlumb.jsPlumbUIComponent,{cleanup:function(){jsPlumbUtil.removeElement(this.canvas),this.svg=null,this.canvas=null,this.path=null},setVisible:function(t){this.canvas&&(this.canvas.style.display=t?"block":"none"),this.bgCanvas&&(this.bgCanvas.style.display=t?"block":"none")}});jsPlumb.ConnectorRenderers.svg=function(t){var s=this,e=L.apply(this,[{cssClass:t._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:t._jsPlumb}]);e.renderer.paint=function(e,n,i){var l=s.getSegments(),a="",r=[0,0];i.xmin<0&&(r[0]=-i.xmin),i.ymin<0&&(r[1]=-i.ymin);for(var o=0;o<l.length;o++)a+=jsPlumb.Segments.svg.SegmentRenderer.getPath(l[o]),a+=" ";var h={d:a,transform:"translate("+r[0]+","+r[1]+")","pointer-events":t["pointer-events"]||"visibleStroke"},u=null,p=[s.x,s.y,s.w,s.h];if(e.outlineColor){var m=e.outlineWidth||1,c=e.lineWidth+2*m;u=jsPlumb.CurrentLibrary.extend({},e),u.strokeStyle=jsPlumbUtil.convertStyle(e.outlineColor),u.lineWidth=c,null==s.bgPath?(s.bgPath=v("path",h),C(s.svg,s.bgPath,0),s.attachListeners(s.bgPath,s)):d(s.bgPath,h),P(s.svg,s.bgPath,u,p,s)}null==s.path?(s.path=v("path",h),C(s.svg,s.path,e.outlineColor?1:0),s.attachListeners(s.path,s)):d(s.path,h),P(s.svg,s.path,e,p,s)},this.reattachListeners=function(){this.bgPath&&this.reattachListenersForElement(this.bgPath,this),this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(jsPlumb.ConnectorRenderers.svg,L),jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(t){return{Straight:function(){var s=t.getCoordinates();return"M "+s.x1+" "+s.y1+" L "+s.x2+" "+s.y2},Bezier:function(){var s=t.params;return"M "+s.x1+" "+s.y1+" C "+s.cp1x+" "+s.cp1y+" "+s.cp2x+" "+s.cp2y+" "+s.x2+" "+s.y2},Arc:function(){var s=t.params,e=t.sweep>Math.PI?1:0,n=t.anticlockwise?0:1;return"M"+t.x1+" "+t.y1+" A "+t.radius+" "+s.r+" 0 "+e+","+n+" "+t.x2+" "+t.y2}}[t.type]()}}};var k=window.SvgEndpoint=function(t){var s=L.apply(this,[{cssClass:t._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:t._jsPlumb}]);s.renderer.paint=function(t){var s=jsPlumb.extend({},t);s.outlineColor&&(s.strokeWidth=s.outlineWidth,s.strokeStyle=jsPlumbUtil.convertStyle(s.outlineColor,!0)),null==this.node?(this.node=this.makeNode(s),this.svg.appendChild(this.node),this.attachListeners(this.node,this)):null!=this.updateNode&&this.updateNode(this.node),P(this.svg,this.node,s,[this.x,this.y,this.w,this.h],this),g(this.node,[this.x,this.y])}.bind(this)};jsPlumbUtil.extend(k,L,{reattachListeners:function(){this.node&&this.reattachListenersForElement(this.node,this)}}),jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),k.apply(this,arguments),this.makeNode=function(t){return v("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(t){d(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Dot,[jsPlumb.Endpoints.Dot,k]),jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),k.apply(this,arguments),this.makeNode=function(t){return v("rect",{width:this.w,height:this.h})},this.updateNode=function(t){d(t,{width:this.w,height:this.h})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Rectangle,[jsPlumb.Endpoints.Rectangle,k]),jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var w=function(t,s){t.apply(this,s),jsPlumb.jsPlumbUIComponent.apply(this,s),this.isAppendedAtTopLevel=!1;this.path=null,this.paint=function(t,n){if(t.component.svg&&n){null==this.path&&(this.path=v("path",{"pointer-events":"all"}),t.component.svg.appendChild(this.path),this.attachListeners(this.path,t.component),this.attachListeners(this.path,this));var i=s&&1==s.length?s[0].cssClass||"":"",l=[0,0];n.xmin<0&&(l[0]=-n.xmin),n.ymin<0&&(l[1]=-n.ymin),d(this.path,{d:e(t.d),"class":i,stroke:t.strokeStyle?t.strokeStyle:null,fill:t.fillStyle?t.fillStyle:null,transform:"translate("+l[0]+","+l[1]+")"})}};var e=function(t){return"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.reattachListeners=function(){this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(w,[jsPlumb.jsPlumbUIComponent,jsPlumb.Overlays.AbstractOverlay],{cleanup:function(){null!=this.path&&jsPlumb.CurrentLibrary.removeElement(this.path)},setVisible:function(t){null!=this.path&&(this.path.style.display=t?"block":"none")}}),jsPlumb.Overlays.svg.Arrow=function(){w.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Arrow,[jsPlumb.Overlays.Arrow,w]),jsPlumb.Overlays.svg.PlainArrow=function(){w.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.PlainArrow,[jsPlumb.Overlays.PlainArrow,w]),jsPlumb.Overlays.svg.Diamond=function(){w.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Diamond,[jsPlumb.Overlays.Diamond,w]),jsPlumb.Overlays.svg.GuideLines=function(){var t,s,e=null,n=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(l,a){null==e&&(e=v("path"),l.connector.svg.appendChild(e),n.attachListeners(e,l.connector),n.attachListeners(e,n),t=v("path"),l.connector.svg.appendChild(t),n.attachListeners(t,l.connector),n.attachListeners(t,n),s=v("path"),l.connector.svg.appendChild(s),n.attachListeners(s,l.connector),n.attachListeners(s,n));var r=[0,0];a.xmin<0&&(r[0]=-a.xmin),a.ymin<0&&(r[1]=-a.ymin),d(e,{d:i(l.head,l.tail),stroke:"red",fill:null,transform:"translate("+r[0]+","+r[1]+")"}),d(t,{d:i(l.tailLine[0],l.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+r[0]+","+r[1]+")"}),d(s,{d:i(l.headLine[0],l.headLine[1]),stroke:"green",fill:null,transform:"translate("+r[0]+","+r[1]+")"})};var i=function(t,s){return"M "+t.x+","+t.y+" L"+s.x+","+s.y}},jsPlumbUtil.extend(jsPlumb.Overlays.svg.GuideLines,jsPlumb.Overlays.GuideLines)}();
/*renderers-canvas.js*/
!function(){var t=null,n=function(t,n){return jsPlumb.CurrentLibrary.hasClass(e(t),n)},e=function(t){return jsPlumb.CurrentLibrary.getElementObject(t)},s=function(t){return jsPlumb.CurrentLibrary.getOffset(e(t))},a=function(t){return jsPlumb.CurrentLibrary.getPageXY(t)},i=function(t){return jsPlumb.CurrentLibrary.getClientXY(t)},l=window.CanvasMouseAdapter=function(){var l=this;this.overlayPlacements=[],jsPlumb.jsPlumbUIComponent.apply(this,arguments),jsPlumbUtil.EventGenerator.apply(this,arguments),this._over=function(t){var n=s(e(l.canvas)),i=a(t),r=i[0]-n.left,o=i[1]-n.top;if(r>0&&o>0&&r<l.canvas.width&&o<l.canvas.height){for(var u=0;u<l.overlayPlacements.length;u++){var m=l.overlayPlacements[u];if(m&&m[0]<=r&&m[1]>=r&&m[2]<=o&&m[3]>=o)return!0}var c=l.canvas.getContext("2d").getImageData(parseInt(r,10),parseInt(o,10),1,1);return 0!==c.data[0]||0!==c.data[1]||0!==c.data[2]||0!==c.data[3]}return!1};var r=!1,o=!1,u=null,m=!1,c=function(t,e){return null!==t&&n(t,e)};this.mousemove=function(n){var e=(a(n),i(n)),s=document.elementFromPoint(e[0],e[1]),o=c(s,"_jsPlumb_overlay"),u=null===t&&(c(s,"_jsPlumb_endpoint")||c(s,"_jsPlumb_connector"));return!r&&u&&l._over(n)?(r=!0,l.fire("mouseenter",l,n),!0):(!r||l._over(n)&&u||o||(r=!1,l.fire("mouseexit",l,n)),void l.fire("mousemove",l,n))},this.click=function(t){r&&l._over(t)&&!m&&l.fire("click",l,t),m=!1},this.dblclick=function(t){r&&l._over(t)&&!m&&l.fire("dblclick",l,t),m=!1},this.mousedown=function(t){l._over(t)&&!o&&(o=!0,u=s(e(l.canvas)),l.fire("mousedown",l,t))},this.mouseup=function(t){o=!1,l.fire("mouseup",l,t)},this.contextmenu=function(t){r&&l._over(t)&&!m&&l.fire("contextmenu",l,t),m=!1}};jsPlumbUtil.extend(l,[jsPlumb.jsPlumbUIComponent,jsPlumbUtil.EventGenerator]);var r=function(t){var n=document.createElement("canvas");return t._jsPlumb.instance.appendElement(n,t.parent),n.style.position="absolute",t["class"]&&(n.className=t["class"]),t._jsPlumb.instance.getId(n,t.uuid),t.tooltip&&n.setAttribute("title",t.tooltip),n},o=window.CanvasComponent=function(t){l.apply(this,arguments);var n=[];this.getDisplayElements=function(){return n},this.appendDisplayElement=function(t){n.push(t)}};jsPlumbUtil.extend(o,l,{setVisible:function(t){this.canvas.style.display=t?"block":"none"}});var u=[null,[1,-1],[1,1],[-1,1],[-1,-1]],m=function(t,n,e){if(n.gradient){for(var s=e(),a=0;a<n.gradient.stops.length;a++)s.addColorStop(n.gradient.stops[a][0],n.gradient.stops[a][1]);t.strokeStyle=s}},c=function(t,n,e,s,a){({Straight:function(t,n,e,s,a){var i=t.params;if(n.save(),m(n,e,function(){return n.createLinearGradient(i.x1,i.y1,i.x2,i.y2)}),n.beginPath(),n.translate(s,a),e.dashstyle&&2===e.dashstyle.split(" ").length){var l=e.dashstyle.split(" ");2!==l.length&&(l=[2,2]);for(var r=[l[0]*e.lineWidth,l[1]*e.lineWidth],o=(i.x2-i.x1)/(i.y2-i.y1),c=jsPlumbUtil.segment([i.x1,i.y1],[i.x2,i.y2]),h=u[c],p=Math.atan(o),d=Math.sqrt(Math.pow(i.x2-i.x1,2)+Math.pow(i.y2-i.y1,2)),v=Math.floor(d/(r[0]+r[1])),y=[i.x1,i.y1],b=0;v>b;b++){n.moveTo(y[0],y[1]);var f=y[0]+Math.abs(Math.sin(p)*r[0])*h[0],P=y[1]+Math.abs(Math.cos(p)*r[0])*h[1],g=y[0]+Math.abs(Math.sin(p)*(r[0]+r[1]))*h[0],j=y[1]+Math.abs(Math.cos(p)*(r[0]+r[1]))*h[1];n.lineTo(f,P),y=[g,j]}n.moveTo(y[0],y[1]),n.lineTo(i.x2,i.y2)}else n.moveTo(i.x1,i.y1),n.lineTo(i.x2,i.y2);n.stroke(),n.restore()},Bezier:function(t,n,e,s,a){var i=t.params;n.save(),m(n,e,function(){return n.createLinearGradient(i.x2+s,i.y2+a,i.x1+s,i.y1+a)}),n.beginPath(),n.translate(s,a),n.moveTo(i.x1,i.y1),n.bezierCurveTo(i.cp1x,i.cp1y,i.cp2x,i.cp2y,i.x2,i.y2),n.stroke(),n.restore()},Arc:function(t,n,e,s,a){var i=t.params;n.save(),n.beginPath(),n.translate(s,a),n.arc(i.cx,i.cy,i.r,t.startAngle,t.endAngle,i.ac),n.stroke(),n.restore()}})[t.type](t,n,e,s,a)},h=jsPlumb.ConnectorRenderers.canvas=function(t){o.apply(this,arguments);var n=function(t,n,e){this.ctx.save(),jsPlumb.extend(this.ctx,t);for(var s=this.getSegments(),a=0;a<s.length;a++)c(s[a],this.ctx,t,n,e);this.ctx.restore()}.bind(this),e=this._jsPlumb.instance.connectorClass+" "+(t.cssClass||"");this.canvas=r({"class":e,_jsPlumb:this._jsPlumb,parent:t.parent}),this.ctx=this.canvas.getContext("2d"),this.appendDisplayElement(this.canvas),this.paint=function(t,e,s){if(null!=t){var a=[this.x,this.y],i=[this.w,this.h],l=0,r=0;if(null!=s&&(s.xmin<0&&(a[0]+=s.xmin,l=-s.xmin),s.ymin<0&&(a[1]+=s.ymin,r=-s.ymin),i[0]=s.xmax+(s.xmin<0?-s.xmin:0),i[1]=s.ymax+(s.ymin<0?-s.ymin:0)),this.translateX=l,this.translateY=r,jsPlumbUtil.sizeElement(this.canvas,a[0],a[1],i[0],i[1]),null!=t.outlineColor){var o=t.outlineWidth||1,u=t.lineWidth+2*o,m={strokeStyle:t.outlineColor,lineWidth:u};n(m,l,r)}n(t,l,r)}}};jsPlumbUtil.extend(h,o);var p=function(t){o.apply(this,arguments);var n=this._jsPlumb.instance.endpointClass+" "+(t.cssClass||""),e={"class":n,_jsPlumb:this._jsPlumb,parent:t.parent,tooltip:self.tooltip};this.canvas=r(e),this.ctx=this.canvas.getContext("2d"),this.appendDisplayElement(this.canvas),this.paint=function(t,n,e){if(jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h),null!=t.outlineColor){var s=t.outlineWidth||1,a=t.lineWidth+2*s;({strokeStyle:t.outlineColor,lineWidth:a})}this._paint.apply(this,arguments)}};jsPlumbUtil.extend(p,o),jsPlumb.Endpoints.canvas.Dot=function(t){jsPlumb.Endpoints.Dot.apply(this,arguments),p.apply(this,arguments);var n=this,e=function(t){try{return parseInt(t,10)}catch(n){if("%"==t.substring(t.length-1))return parseInt(t.substring(0,t-1),10)}},s=function(t){var s=n.defaultOffset,a=n.defaultInnerRadius;return t.offset&&(s=e(t.offset)),t.innerRadius&&(a=e(t.innerRadius)),[s,a]};this._paint=function(e){if(null!=e){var a=n.canvas.getContext("2d"),i=t.endpoint.anchor.getOrientation(t.endpoint);if(jsPlumb.extend(a,e),e.gradient){for(var l=s(e.gradient),r=1==i[1]?-1*l[0]:l[0],o=1==i[0]?-1*l[0]:l[0],u=a.createRadialGradient(n.radius,n.radius,n.radius,n.radius+o,n.radius+r,l[1]),m=0;m<e.gradient.stops.length;m++)u.addColorStop(e.gradient.stops[m][0],e.gradient.stops[m][1]);a.fillStyle=u}a.beginPath(),a.arc(n.radius,n.radius,n.radius,0,2*Math.PI,!0),a.closePath(),(e.fillStyle||e.gradient)&&a.fill(),e.strokeStyle&&a.stroke()}}},jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Dot,[jsPlumb.Endpoints.Dot,p]),jsPlumb.Endpoints.canvas.Rectangle=function(t){var n=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments),p.apply(this,arguments),this._paint=function(e){var s=n.canvas.getContext("2d"),a=t.endpoint.anchor.getOrientation(t.endpoint);if(jsPlumb.extend(s,e),e.gradient){for(var i=1==a[1]?n.h:0===a[1]?n.h/2:0,l=-1==a[1]?n.h:0===a[1]?n.h/2:0,r=1==a[0]?n.w:0===a[0]?n.w/2:0,o=-1==a[0]?n.w:0===a[0]?n.w/2:0,u=s.createLinearGradient(r,i,o,l),m=0;m<e.gradient.stops.length;m++)u.addColorStop(e.gradient.stops[m][0],e.gradient.stops[m][1]);s.fillStyle=u}s.beginPath(),s.rect(0,0,n.w,n.h),s.closePath(),(e.fillStyle||e.gradient)&&s.fill(),e.strokeStyle&&s.stroke()}},jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Rectangle,[jsPlumb.Endpoints.Rectangle,p]),jsPlumb.Endpoints.canvas.Triangle=function(t){var n=this;jsPlumb.Endpoints.Triangle.apply(this,arguments),p.apply(this,arguments),this._paint=function(e){var s=n.canvas.getContext("2d"),a=0,i=0,l=0,r=t.endpoint.anchor.getOrientation(t.endpoint);1==r[0]&&(a=n.width,i=n.height,l=180),-1==r[1]&&(a=n.width,l=90),1==r[1]&&(i=n.height,l=-90),s.fillStyle=e.fillStyle,s.translate(a,i),s.rotate(l*Math.PI/180),s.beginPath(),s.moveTo(0,0),s.lineTo(n.width/2,n.height/2),s.lineTo(0,n.height),s.closePath(),(e.fillStyle||e.gradient)&&s.fill(),e.strokeStyle&&s.stroke()}},jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Triangle,[jsPlumb.Endpoints.Triangle,p]),jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;var d=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)};jsPlumbUtil.extend(d,jsPlumb.jsPlumbUIComponent,{setVisible:function(t){this.visible=t,this.component.repaint()}});var v=function(t,n){t.apply(this,n),d.apply(this,n),this.paint=function(t,n){var e=t.component.ctx,s=t.d;s&&(e.save(),e.lineWidth=t.lineWidth,e.beginPath(),e.translate(t.component.translateX,t.component.translateY),e.moveTo(s.hxy.x,s.hxy.y),e.lineTo(s.tail[0].x,s.tail[0].y),e.lineTo(s.cxy.x,s.cxy.y),e.lineTo(s.tail[1].x,s.tail[1].y),e.lineTo(s.hxy.x,s.hxy.y),e.closePath(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.stroke()),t.fillStyle&&(e.fillStyle=t.fillStyle,e.fill()),e.restore())}};jsPlumb.Overlays.canvas.Arrow=function(){v.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.canvas.Arrow,[jsPlumb.Overlays.Arrow,d]),jsPlumb.Overlays.canvas.PlainArrow=function(){v.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.canvas.PlainArrow,[jsPlumb.Overlays.PlainArrow,d]),jsPlumb.Overlays.canvas.Diamond=function(){v.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.canvas.Diamond,[jsPlumb.Overlays.Diamond,d])}();
/*renderers-vml.js*/
!function(){var t={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},s=null;if(document.createStyleSheet&&document.namespaces){var e=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],n="behavior:url(#default#VML);position:absolute;";s=document.createStyleSheet();for(var l=0;l<e.length;l++)s.addRule(e[l],n);document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var a=1e3,i=function(t,s){for(var e in s)t[e]=s[e]},r=function(t,s,e,n,l,a){e=e||{};var r=document.createElement("jsplumb:"+t);return a?l.appendElement(r,n):jsPlumb.CurrentLibrary.appendElement(r,n),r.className=(e["class"]?e["class"]+" ":"")+"jsplumb_vml",o(r,s),i(r,e),r},o=function(t,s,e){t.style.left=s[0]+"px",t.style.top=s[1]+"px",t.style.width=s[2]+"px",t.style.height=s[3]+"px",t.style.position="absolute",e&&(t.style.zIndex=e)},u=jsPlumb.vml.convertValue=function(t){return Math.floor(t*a)},m=function(t,s,e,n){"transparent"===s?n.setOpacity(e,"0.0"):n.setOpacity(e,"1.0")},h=function(t,s,e,n){var l={};if(s.strokeStyle){l.stroked="true";var a=jsPlumbUtil.convertStyle(s.strokeStyle,!0);l.strokecolor=a,m(l,a,"stroke",e),l.strokeweight=s.lineWidth+"px"}else l.stroked="false";if(s.fillStyle){l.filled="true";var o=jsPlumbUtil.convertStyle(s.fillStyle,!0);l.fillcolor=o,m(l,o,"fill",e)}else l.filled="false";if(s.dashstyle)null==e.strokeNode?e.strokeNode=r("stroke",[0,0,0,0],{dashstyle:s.dashstyle},t,n):e.strokeNode.dashstyle=s.dashstyle;else if(s["stroke-dasharray"]&&s.lineWidth){for(var u=-1==s["stroke-dasharray"].indexOf(",")?" ":",",h=s["stroke-dasharray"].split(u),c="",p=0;p<h.length;p++)c+=Math.floor(h[p]/s.lineWidth)+u;null==e.strokeNode?e.strokeNode=r("stroke",[0,0,0,0],{dashstyle:c},t,n):e.strokeNode.dashstyle=c}i(t,l)},c=function(){var t=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(s){t.opacityNodes.stroke=r("stroke",[0,0,1,1],{opacity:"0.0"},s,t._jsPlumb.instance),t.opacityNodes.fill=r("fill",[0,0,1,1],{opacity:"0.0"},s,t._jsPlumb.instance)},this.setOpacity=function(s,e){var n=t.opacityNodes[s];n&&(n.opacity=""+e)};var s=[];this.getDisplayElements=function(){return s},this.appendDisplayElement=function(e,n){n||t.canvas.parentNode.appendChild(e),s.push(e)}};jsPlumbUtil.extend(c,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&jsPlumbUtil.removeElement(this.bgCanvas),jsPlumbUtil.removeElement(this.canvas)}});var p=jsPlumb.ConnectorRenderers.vml=function(s){this.strokeNode=null,this.canvas=null,c.apply(this,arguments);var e=this._jsPlumb.instance.connectorClass+(s.cssClass?" "+s.cssClass:"");this.paint=function(n){if(null!==n){this.w=Math.max(this.w,1),this.h=Math.max(this.h,1);for(var l=this.getSegments(),u={path:""},m=[this.x,this.y,this.w,this.h],c=0;c<l.length;c++)u.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(l[c]),u.path+=" ";if(n.outlineColor){var p=n.outlineWidth||1,v=n.lineWidth+2*p,y={strokeStyle:jsPlumbUtil.convertStyle(n.outlineColor),lineWidth:v};for(var b in t)y[b]=n[b];null==this.bgCanvas?(u["class"]=e,u.coordsize=m[2]*a+","+m[3]*a,this.bgCanvas=r("shape",m,u,s.parent,this._jsPlumb.instance,!0),o(this.bgCanvas,m),this.appendDisplayElement(this.bgCanvas,!0),this.attachListeners(this.bgCanvas,this),this.initOpacityNodes(this.bgCanvas,["stroke"])):(u.coordsize=m[2]*a+","+m[3]*a,o(this.bgCanvas,m),i(this.bgCanvas,u)),h(this.bgCanvas,y,this)}null==this.canvas?(u["class"]=e,u.coordsize=m[2]*a+","+m[3]*a,this.canvas=r("shape",m,u,s.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.attachListeners(this.canvas,this),this.initOpacityNodes(this.canvas,["stroke"])):(u.coordsize=m[2]*a+","+m[3]*a,o(this.canvas,m),i(this.canvas,u)),h(this.canvas,n,this,this._jsPlumb.instance)}}};jsPlumbUtil.extend(p,c,{reattachListeners:function(){this.canvas&&this.reattachListenersForElement(this.canvas,this)},setVisible:function(t){this.canvas&&(this.canvas.style.display=t?"block":"none"),this.bgCanvas&&(this.bgCanvas.style.display=t?"block":"none")}});var v=window.VmlEndpoint=function(t){c.apply(this,arguments),this._jsPlumb.vml=null,this.canvas=document.createElement("div"),this.canvas.style.position="absolute",this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(t.cssClass?" "+t.cssClass:""),t._jsPlumb.appendElement(this.canvas,t.parent),this.paint=function(t,s){var e={},n=this._jsPlumb.vml;jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h),null==this._jsPlumb.vml?(e["class"]=this._jsPlumb.clazz,n=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],e,s,this.canvas,this._jsPlumb.instance),this.attachListeners(n,this),this.appendDisplayElement(n,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(n,["fill"])):(o(n,[0,0,this.w,this.h]),i(n,e)),h(n,t,this)}};jsPlumbUtil.extend(v,c,{reattachListeners:function(){this._jsPlumb.vml&&this.reattachListenersForElement(this._jsPlumb.vml,this)}}),jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(t){return{Straight:function(t){var s=t.params;return"m"+u(s.x1)+","+u(s.y1)+" l"+u(s.x2)+","+u(s.y2)+" e"},Bezier:function(t){var s=t.params;return"m"+u(s.x1)+","+u(s.y1)+" c"+u(s.cp1x)+","+u(s.cp1y)+","+u(s.cp2x)+","+u(s.cp2y)+","+u(s.x2)+","+u(s.y2)+" e"},Arc:function(t){var s=t.params,e=Math.min(s.x1,s.x2),n=(Math.max(s.x1,s.x2),Math.min(s.y1,s.y2)),l=(Math.max(s.y1,s.y2),t.anticlockwise?1:0),a=t.anticlockwise?"at ":"wa ",i=function(){if(s.loopback)return"0,0,"+u(2*s.r)+","+u(2*s.r);var a=[null,[function(){return[e,n]},function(){return[e-s.r,n-s.r]}],[function(){return[e-s.r,n]},function(){return[e,n-s.r]}],[function(){return[e-s.r,n-s.r]},function(){return[e,n]}],[function(){return[e,n-s.r]},function(){return[e-s.r,n]}]][t.segment][l]();return u(a[0])+","+u(a[1])+","+u(a[0]+2*s.r)+","+u(a[1]+2*s.r)};return a+" "+i()+","+u(s.x1)+","+u(s.y1)+","+u(s.x2)+","+u(s.y2)+" e"}}[t.type](t)}}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),v.apply(this,arguments),this.getVml=function(t,s,e,n,l){return r("oval",t,s,n,l)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Dot,v),jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),v.apply(this,arguments),this.getVml=function(t,s,e,n,l){return r("rect",t,s,n,l)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Rectangle,v),jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var y=function(t,s){t.apply(this,s),c.apply(this,s);var e=this;e.canvas=null,e.isAppendedAtTopLevel=!0;var n=function(t){return"m "+u(t.hxy.x)+","+u(t.hxy.y)+" l "+u(t.tail[0].x)+","+u(t.tail[0].y)+" "+u(t.cxy.x)+","+u(t.cxy.y)+" "+u(t.tail[1].x)+","+u(t.tail[1].y)+" x e"};this.paint=function(t,l){if(t.component.canvas&&l){var u={},m=t.d,h=t.component;t.strokeStyle&&(u.stroked="true",u.strokecolor=jsPlumbUtil.convertStyle(t.strokeStyle,!0)),t.lineWidth&&(u.strokeweight=t.lineWidth+"px"),t.fillStyle&&(u.filled="true",u.fillcolor=t.fillStyle);var c=Math.min(m.hxy.x,m.tail[0].x,m.tail[1].x,m.cxy.x),p=Math.min(m.hxy.y,m.tail[0].y,m.tail[1].y,m.cxy.y),v=Math.max(m.hxy.x,m.tail[0].x,m.tail[1].x,m.cxy.x),y=Math.max(m.hxy.y,m.tail[0].y,m.tail[1].y,m.cxy.y),b=Math.abs(v-c),d=Math.abs(y-p),j=[c,p,b,d];if(u.path=n(m),u.coordsize=h.w*a+","+h.h*a,j[0]=h.x,j[1]=h.y,j[2]=h.w,j[3]=h.h,null==e.canvas){var f=h._jsPlumb.overlayClass||"",P=s&&1==s.length?s[0].cssClass||"":"";u["class"]=P+" "+f,e.canvas=r("shape",j,u,h.canvas.parentNode,h._jsPlumb.instance,!0),h.appendDisplayElement(e.canvas,!0),e.attachListeners(e.canvas,h),e.attachListeners(e.canvas,e)}else o(e.canvas,j),i(e.canvas,u)}},this.reattachListeners=function(){e.canvas&&e.reattachListenersForElement(e.canvas,e)},this.cleanup=function(){null!=e.canvas&&jsPlumb.CurrentLibrary.removeElement(e.canvas)}};jsPlumbUtil.extend(y,[c,jsPlumb.Overlays.AbstractOverlay],{setVisible:function(t){this.canvas.style.display=t?"block":"none"}}),jsPlumb.Overlays.vml.Arrow=function(){y.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Arrow,[jsPlumb.Overlays.Arrow,y]),jsPlumb.Overlays.vml.PlainArrow=function(){y.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.PlainArrow,[jsPlumb.Overlays.PlainArrow,y]),jsPlumb.Overlays.vml.Diamond=function(){y.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Diamond,[jsPlumb.Overlays.Diamond,y])}();
/*jquery.jsPlumb.js*/
!function(t){var e=function(e){return t("string"==typeof e?"#"+e:e)};jsPlumb.CurrentLibrary={addClass:function(t,n){t=e(t);try{t[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.addClass(t[0],n)}catch(r){}try{t.addClass(n)}catch(r){}},animate:function(t,e,n){t.animate(e,n)},appendElement:function(t,n){e(n).append(t)},ajax:function(e){e=e||{},e.type=e.type||"get",t.ajax(e)},bind:function(t,n,r){t=e(t),t.bind(n,r)},destroyDraggable:function(e){t(e).data("draggable")&&t(e).draggable("destroy")},destroyDroppable:function(e){t(e).data("droppable")&&t(e).droppable("destroy")},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(e,n){return t.extend(e,n)},getClientXY:function(t){return[t.clientX,t.clientY]},getDragObject:function(t){return t[1].draggable||t[1].helper},getDragScope:function(e){return t(e).draggable("option","scope")},getDropEvent:function(t){return t[0]},getDropScope:function(e){return t(e).droppable("option","scope")},getDOMElement:function(t){return null==t?null:"string"==typeof t?document.getElementById(t):t.context||null!=t.length?t[0]:t},getElementObject:e,getOffset:function(t){return t.offset()},getOriginalEvent:function(t){return t.originalEvent},getPageXY:function(t){return[t.pageX,t.pageY]},getParent:function(t){return e(t).parent()},getScrollLeft:function(t){return t.scrollLeft()},getScrollTop:function(t){return t.scrollTop()},getSelector:function(n,r){return 2==arguments.length?e(n).find(r):t(n)},getSize:function(e){return e=t(e),[e.outerWidth(),e.outerHeight()]},getTagName:function(t){var n=e(t);return n.length>0?n[0].tagName:null},getUIPosition:function(t,e){if(e=e||1,1==t.length)ret={left:t[0].pageX,top:t[0].pageY};else{var n=t[1],r=n.offset;ret=r||n.absolutePosition,n.position.left/=e,n.position.top/=e}return{left:ret.left/e,top:ret.top/e}},hasClass:function(t,e){return t.hasClass(e)},initDraggable:function(e,n,r,o){n=n||{},e=t(e),n.start=jsPlumbUtil.wrap(n.start,function(){t("body").addClass(o.dragSelectClass)},!1),n.stop=jsPlumbUtil.wrap(n.stop,function(){t("body").removeClass(o.dragSelectClass)}),n.doNotRemoveHelper||(n.helper=null),r&&(n.scope=n.scope||jsPlumb.Defaults.Scope),e.draggable(n)},initDroppable:function(e,n){n.scope=n.scope||jsPlumb.Defaults.Scope,t(e).droppable(n)},isAlreadyDraggable:function(e){return t(e).hasClass("ui-draggable")},isDragSupported:function(e,n){return t(e).draggable},isDropSupported:function(e,n){return t(e).droppable},removeClass:function(t,n){t=e(t);try{if(t[0].className.constructor==SVGAnimatedString)return void jsPlumbUtil.svg.removeClass(t[0],n)}catch(r){}t.removeClass(n)},removeElement:function(t){e(t).remove()},setDragFilter:function(t,e){jsPlumb.CurrentLibrary.isAlreadyDraggable(t)&&t.draggable("option","cancel",e)},setDraggable:function(t,e){t.draggable("option","disabled",!e)},setDragScope:function(t,e){t.draggable("option","scope",e)},setOffset:function(t,n){e(t).offset(n)},trigger:function(t,n,r){var o=jQuery._data(e(t)[0],"handle");o(r)},unbind:function(t,n,r){t=e(t),t.unbind(n,r)}},t(document).ready(jsPlumb.init)}(jQuery);